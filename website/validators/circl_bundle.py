import json
import os
from referencing import Registry, Resource
from referencing.jsonschema import SchemaRegistry

from jsonschema import Draft202012Validator  # type: ignore[import-untyped]

from website import BASE_DIR

# #### CIRCL Security Advisory bundle format ####

path_schemas = os.path.join(
    BASE_DIR,
    "website",
    "web",
    "static",
    "schemas",
    "CIRCL",
)

schema_bundle = json.load(
    open(os.path.join(path_schemas, "Security_Advisory_Bundle.json"))
)

validator = Draft202012Validator(schema_bundle)
