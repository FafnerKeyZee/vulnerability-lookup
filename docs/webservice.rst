Webservice
==========

Permissions
-----------

- admin: full access to everything including update of other comments or bundles or vulnerabilities
- commenter: allow to create new comment or edit their own comments
- reporter: is also a commenter but can also submit vulnerabilities or their own vulnerabilities


Authentication
--------------

Sign-up
~~~~~~~

.. list-table:: Sign-up workflow
   :widths: 3 22 25 25 25
   :header-rows: 1

   * - Step
     - Endpoint
     - Methods
     - Rule
     - Comment

   * - 1
     - user_bp.signup
     - GET, POS
     - /user/signup
     - Sign-up with login and email. A confirmation email is sent to the user with a token in a URL.

   * - 2
     - user_bp.confirm_account
     - GET, POS
     - /user/confirm_account/<string:token>
     - token: from the received emal. The user can now chose a password.

   * - 3
     - user_bp.login
     - GET, POS
     - /user/login
     - Authentication with login and password

   * - 4
     - user_bp.setup_two_factor_auth
     - GET
     - /user/setup-2fa
     - Set-up TFA with QRCode or token

   * - 5
     - user_bp.verify_two_factor_auth
     - GET
     - GET, POST  /user/verify-2fa
     - Verify TFA with token



Login
~~~~~

.. list-table:: Login workflow
   :widths: 25 25 50
   :header-rows: 1

   * - Endpoint
     - Methods
     - Rule

   * - user_bp.login
     - GET, POS
     - /user/login

   * - user_bp.verify_two_factor_auth
     - GET
     - GET, POST  /user/verify-2fa
