{% extends "vulnogram/bundle.html" %}

{% block vulnogram %}

<div class="stk" id="vgHead">
<header class="ban pad shd hig"><div class="left"><a class="fbn sfe" href="{{ url_for('user_bp.vulnogram') }}">NEW</a><input class="hid" id="importJSON" type="file" accept="application/json" onchange="loadCVEFile(event,this);"><a class="fbn vgi-folder" type="file" onclick="importFile(event, this);">Open</a><a class="fbn vgi-download" type="button" oncontextmenu="downloadFile(event, this);" onclick="downloadFile(event, this);" value="Download">Download</a><button class="fbn sfe vgi-put" id="post1">Post to CVE.org</button></div><div class="right"><form class="indent out nobr" onsubmit="cveSelectLoad(event);return false;"><input class="txt lbl" id="cveEditable" type="search" name="id" list="editablelist" placeholder="CVE-yyyy-nnnn.." title="Load CVE for editing" required><datalist id="editablelist"></datalist><button class="btn vgi-in" type="submit">Load</button></form></div></header></div><script>var userUsername = ""
</script><div class="pad ban messagebar"><div class="left tred" id="errMsg"></div><div class="right" id="infoMsg"></div></div><div class="pad"><script>var iconMap = {"Platforms":"stack","References":"ext","Versions":"versions","Timeline":"time","Solution":"safe","ID":"tag","Tags":"tag","Advisory-ID":"tag","ASSIGNER":"user","ASSIGNER_SHORT_NAME":"user","DATE_PUBLIC":"cal","TITLE":"title","Published":"cal","product_name":"package","Found during":"info","CNA_private":"lock","TYPE":"bucket","unsure":"what","no-vuln":"safe","advisory":"alert","no-advisory":"no","doc":"text","misc":"misc","duplicate":"ext","CVE_data_meta":"info","STATE":"knob","new":"inbox","closed":"closed","open":"inbox1","draft":"text","review":"eye","waiting":"wait","pending":"cal","vectorString":"title","baseScore":"dial","baseSeverity":"knob","scenario":"text","source":"info","descriptions":"text","affected":"impact","Vendors":"factory","references":"ext","impacts":"impact","metrics":"dial","Configuration":"cog","Defect":"bug","INTERNAL":"hardhat","EXTERNAL":"hat","USER":"cap","UNKNOWN":"what"}</script><script>var currentYear = new Date().getFullYear();
const defaultTimeout = 1000 * 60 * 60; // one hour timeout

function hidepopups() {
    document.getElementById("userListPopup").open = false;
    document.getElementById("userStatsPopup").open = false;
}

function tweetJSON(event, link) {
    var j = mainTabGroup.getValue();
    if (!j) {
        event.preventDefault();
        return;
    }
    var id = j.cveMetadata.cveId;
    /* var cvelist = textUtil.deep_value(j, 'CNA_private.CVE_list');
     if (cvelist && cvelist.length > 0) {
         id = '';
     }*/
    var text = id + ' ' + getBestTitle(j.containers.cna);
    text = text.replace(/ +(?= )/g, '');
    link.href = 'https://twitter.com/intent/tweet?&text='
        + encodeURI(text)
        + '&url=' + encodeURI(textUtil.deep_value(j, 'containers.cna.references.0.url'));
    //    + '&hashtags=' + encodeURI(id)
    //via=vulnogram&hashtags=CVE
}

function loadCVE(value) {
    var realId = value.match(/(CVE-(\d{4})-(\d{1,12})(\d{3}))/);
    if (realId) {
        var id = realId[1];
        var year = realId[2];
        var bucket = realId[3];
        fetch('https://raw.githubusercontent.com/CVEProject/cvelistv5/master/review_set/' + year + '/' + bucket + 'xxx/' + id + '.json', {
            method: 'GET',
            credentials: 'omit',
            headers: {
                'Accept': 'application/json, text/plain, */*'
            },
            redirect: 'error'
        })
            .then(function (response) {
                if (!response.ok) {
                    errMsg.textContent = "Failed to load valid CVE JSON";
                    infoMsg.textContent = "";
                    throw Error(id + ' ' + response.statusText);
                }
                return response.json();
            })
            .then(function (res) {
                if (res.dataVersion && (res.dataVersion == '5.0' || res.dataVersion == '5.1')) {
                    if (res.containers.cna.x_legacyV4Record) {
                        delete res.containers.cna.x_legacyV4Record;
                    }
                    if (res.containers) {
                        res = cveFixForVulnogram(res);
                    }
                    var edOpts = (res.cveMetadata.state == 'REJECTED') ? rejectEditorOption : publicEditorOption;
                    mainTabGroup.change(0);
                    loadJSON(res, id, "Loaded " + id + " from GIT!", edOpts);
                } else {
                    errMsg.textContent = "Failed to load valid CVE JSON v 5.0 record";
                    infoMsg.textContent = "";
                }
            })
            .catch(function (error) {
                errMsg.textContent = error;
            })
    } else {
        errMsg.textContent = "CVE ID required";
    }
    return false;
}

async function rejectRecord() {
    var id = getDocID();
    if (window.confirm('Do you want to reject ' + id + '? All vulnerability details will be removed.')) {
        loadJSON({
            cveMetadata: {
                cveId: id,
                state: 'REJECTED'
            }
        }, id, 'Rejcting ' + id, rejectEditorOption);
        mainTabGroup.change(0);
    }
}

async function draftEmail(event, link, renderId) {
    var subject = ''
    if (typeof (mainTabGroup) !== 'undefined') {
        var j = mainTabGroup.getValue();
        if (!j) {
            event.preventDefault();
            return;
        }
        var id = textUtil.deep_value(j, 'cveMetadata.cveId');
        /* var cvelist = textUtil.deep_value(j, 'CNA_private.CVE_list');
         if (cvelist && cvelist.length > 0) {
             id = '';
         }*/
        subject = id + ' ' + getBestTitle(j.containers.cna);
    } else {
        var t = document.getElementById(renderId).getElementsByTagName('h2')[0];
        if (t) {
            subject = t.textContent;
        }
    }
    var emailBody = document.getElementById(renderId).innerText;
    link.href = "mailto:?subject=" + encodeURI(subject) + '&body=' + encodeURI(emailBody);
};

var additionalTabs = {
    advisoryTab: {
        title: 'Advisory',
        setValue: async function (j) {
            if (pugRender && document.getElementById("render")) {
                var cve_list = textUtil.deep_value(j, 'CNA_private.CVE_list');
                if (cve_list && cve_list.length > 0) {
                    var cSet = new Set();
                    var cMap = {};
                    for (var d of cve_list) {
                        if (d.CVE) {
                            for (var x of d.CVE.match(/CVE-\d{4}-[a-zA-Z\d\._-]{4,}/igm)) {
                                cSet.add(x);
                                cMap[x] = {
                                    impact: '',
                                    summary: d.summary
                                }
                            }
                        }
                    }
                    if (cSet.size > 0) {
                        var r = await textUtil.getDocuments('nvd', Array.from(cSet), ['cve.CVE_data_meta', 'cve.description', 'impact']);
                        for (var c of r) {
                            var cveid = textUtil.deep_value(c, 'cve.CVE_data_meta.ID');
                            if (textUtil.deep_value(c, 'impact.baseMetricV3.cvssV3')) {
                                cMap[cveid].impact = {
                                    cvss: c.impact.baseMetricV3.cvssV3
                                };
                            } else if (textUtil.deep_value(c, 'impact.baseMetricV2.cvssV2')) {
                                cMap[cveid].impact = {
                                    cvss: c.impact.baseMetricV2.cvssV2
                                };
                            }
                            if (!cMap[cveid].summary) {
                                var title = textUtil.deep_value(c, 'cve.CVE_data_meta.TITLE');
                                cMap[cveid].summary = title ? title : textUtil.deep_value(c, 'cve.description.description_data')[0].value;
                            }
                            cSet.delete(cveid);
                        }
                        if (cSet.size > 0) {
                            var nr = await textUtil.getDocuments('cve', Array.from(cSet), ['body.CVE_data_meta', 'body.impact', 'body.description']);
                            for (c of nr) {
                                var cveid = textUtil.deep_value(c, 'body.CVE_data_meta.ID');
                                if (textUtil.deep_value(c, 'body.impact.cvss')) {
                                    cMap[cveid].impact = c.body.impact;
                                }
                                if (!cMap[cveid].summary) {
                                    var desc = textUtil.deep_value(c, 'body.description.description_data')[0].value;
                                    cMap[cveid].summary = desc ? desc : textUtil.deep_value(c, 'body.CVE_data_meta.TITLE');
                                }
                            }
                        }
                        document.getElementById("render").innerHTML = pugRender({
                            renderTemplate: 'page',
                            doc: j,
                            cmap: cMap,
                        });
                    } else {
                        document.getElementById("render").innerHTML = pugRender({
                            renderTemplate: 'page',
                            doc: j
                        });
                    }
                } else {
                    document.getElementById("render").innerHTML = pugRender({
                        renderTemplate: 'page',
                        doc: j
                    });
                }
            }
        }
    },
    mitreTab: {
        title: 'MITRE-Preview',
        setValue: function (j) {
            document.getElementById("mitreweb").innerHTML = pugRender({
                renderTemplate: 'mitre',
                doc: j
            });
        }
    },
    cvePortalTab: {
        title: 'CVE Org',
        setValue: function () {

        }
    }
}

/* fullname = vendor . product . platforms . module .others . default status
/* table --> [ fullname ][version][affected|unaffected|unknown] = [ list of ranges ] */
function versionStatusTable5(affected) {
    var t = {}; // resulting table structure
    nameAndPlatforms = {};
    var showCols = {
        platforms: false,
        modules: false,
        affected: false,
        unaffected: false,
        unknown: false
    };
    for (var p of affected) {
        var pname = p.product ? p.product : p.packageName ? p.packageName : '';
        if (p.platforms)
            showCols.platforms = true;
        if (p.modules)
            showCols.modules = true;
        if (p.status)
            showCols[p.status] = true;
        var platforms =
            (p.platforms ? p.platforms.join(', ') : '');
        var others = {};
        if (p.collectionURL) {
            others.collectionURL = p.collectionURL;
        }
        if (p.repo) {
            others.repo = p.repo;
        }
        if (p.programFiles) {
            others.programFiles = p.programFiles;
        }
        if (p.programRoutines) {
            others.programRoutines = p.programRoutines;
        }
        var modules = p.modules ? p.modules.join(', ') : '';
        var pFullName = [
            (p.vendor ? p.vendor + ' ' : '') + pname + (major ? ' ' + major : ''),
            platforms,
            modules,
            others,
            p.defaultStatus
        ];
        nameAndPlatforms[pFullName] = pFullName;
        if (p.versions) {
            for (v of p.versions) {
                var rows = {
                    affected: [],
                    unaffected: [],
                    unknown: []
                };
                var major = undefined; //major ? major[1] : '';
                if (v.version) {
                    showCols[v.status] = true;
                    if (!v.changes) {  // simple range versions
                        var rangeStart = '';
                        if (v.version != 'unspecified' && v.version != 0)
                            rangeStart = 'from ' + v.version;
                        if (v.lessThan) {
                            var rangeEnd = ' before ' + v.lessThan;
                            if (v.lessThan == 'unspecified' || v.lessThan == '*')
                                rangeEnd = "";
                            rows[v.status].push(rangeStart + rangeEnd);
                        } else if (v.lessThanOrEqual) {
                            var rangeEnd = ' through ' + v.lessThanOrEqual;
                            if (v.lessThanOrEqual == 'unspecified' || v.lessThanOrEqual == '*')
                                rangeEnd = "";
                            rows[v.status].push(rangeStart + rangeEnd);
                        } else {
                            rows[v.status].push(v.version);
                        }
                    } else {
                        var ver = v.version;
                        showCols[v.status] = true;
                        var range = '';
                        if (ver != 'unspecified' && ver != 0)
                            range = 'from ' + ver;
                        if (v.lessThan) {
                            var rangeEnd = ' before ' + v.lessThan;
                            if (v.lessThan == 'unspecified' || v.lessThan == '*')
                                rangeEnd = "";
                            range = range + (v.lessThan != ver ? rangeEnd : '');
                        } else if (v.lessThanOrEqual) {
                            var rangeEnd = ' through ' + v.lessThanOrEqual;
                            if (v.lessThanOrEqual == 'unspecified' || v.lessThanOrEqual == '*')
                                rangeEnd = "";
                            range = range + (v.lessThanOrEqual != ver ? rangeEnd : '');
                        } else {
                            range = ver;
                        }
                        var changes = [];
                        for (c of v.changes) {
                            changes.push(c.status + ' from ' + c.at);
                        }
                        if (changes.length > 0) {
                            range = range + ' (' + changes.join(', ') + ')';
                        }
                        rows[v.status].push(range);
                    }
                }
                if (!t[pFullName]) t[pFullName] = [];
                t[pFullName].push(rows);
            }
        }
    }
    return ({ groups: nameAndPlatforms, vals: t, show: showCols });
}

function getProductAffected(cve) {
    var lines = [];
    for (var vendor of cve.affected.vendors) {
        var pstring = [];
        for (var product of vendor.products) {
            var versions = {};
            var includePlatforms = true;
            var platforms = {};
            for (var version of product.versions) {
                if (version.version_affected && version.version_affected.indexOf('!') < 0 && version.version_affected.indexOf('?') < 0) {
                    versions[version.version_name] = 1;
                    if (version.platform == "all" || version.platform == "") {
                        includePlatforms = false;
                    }
                    if (includePlatforms && version.platform) {
                        var ps = version.platform.split(',');
                        for (var p of ps) {
                            platforms[p.trim()] = true;
                        }
                    }
                }
            }
            pstring.push('This issue affects ' + product.product_name + ' ' +
                Object.keys(versions).sort().join(", ") + '.');
            if (includePlatforms && (Object.keys(platforms).length > 0)) {
                pstring.push('Affected platforms: ' + Object.keys(platforms).sort().join(', ') + '.');
            }
        }
        lines.push(pstring.join(" "));
    }
    return lines.join();
};

/* safely convert HTML in supportingMedia to text */
function domhtml(html) {
    text = htmltoText(html) || "";
    let doc = new DOMParser().parseFromString('<pre>' + text + '</pre>', 'text/html');
    var ret = doc.body.innerText || "";
    return ret.trim();
}

function htmltoText(html) {
    if (html) {
        let text = html;
        //text = text.replace(/\n/gi, "");
        text = text.replace(/<style([\s\S]*?)<\/style[^>]*?>/gi, "");
        text = text.replace(/<script([\s\S]*?)<\/script[^>]*?>/gi, "");
        text = text.replace(/<a.*?href="(.*?)[\?\"].*?>\1<\/a.*?>/gi, " $1 ");
        text = text.replace(/<a.*?href="(.*?)[\?\"].*?>(.*?)<\/a.*?>/gi, " $2 $1 ");
        text = text.replace(/<\/div[^>]*?>/gi, "\n\n");
        text = text.replace(/<\/li[^>]*?>/gi, "\n");
        text = text.replace(/<li.*?>/gi, "  *  ");
        text = text.replace(/<\/ul[^>]*?>/gi, "\n\n");
        text = text.replace(/<\/p[^>]*?>/gi, "\n\n");
        text = text.replace(/<br\s*[\/]?>/gi, "\n");
        text = text.replace(/<[^>]+>/gi, "");
        //text = text.replace(/^\s*/gim, "");
        //text = text.replace(/ ,/gi, ",");
        //text = text.replace(/ +/gi, " ");
        //text = text.replace(/\n\n/gi, "\n");
        text = text.replace(/^\s+/,"");
        text = text.replace(/\s+$/,"");
        return text;
    }
};
function getProblemTypeString(o) {
    var pts = [];
    for (var j = 0; j < o.problemTypes.length; j++) {
        for (var k = 0; k < o.problemTypes[j].descriptions.length; k++) {
            if (o.problemTypes[j].descriptions[k].lang == "en") {
                var pt = o.problemTypes[j].descriptions[k].description;
                if (pt) {
                    pts.push(pt.replace(/^CWE-[0-9 ]+/, ''));
                }
            }
        }
    }
    return pts.join(', ');
};
function getProductList(cna) {
    var lines = [];
    for (var p of cna.affected) {
        lines.push(p.product);
    }
    return lines.join("; ");
};
function getBestTitle(o) {
    var title = o.providerMetadata.title;
    if (!title) {
        title = getProblemTypeString(o) + ' vulnerability in ' + getProductList(o);
    }
    return title;
};

document.addEventListener("click", function (e) {
    var popup = document.querySelector(".popup");
    if (popup) {
        var insideTooltip = popup.contains(e.target);
        if (!insideTooltip) {
            popup.removeAttribute("open");
        }
    }
});

var autoTextRequired = [
    'root.containers.cna.affected',
    'root.containers.cna.problemTypes',
    'root.containers.cna.impacts',
]
function enoughAutoTextFields(res) {
    for(s of res) {
        for(p of autoTextRequired) {
            if (s.path.startsWith(p)) {
                return false;
            }
        }
    }
    return true;
}

async function autoText(event) {
    if (event) {
        event.preventDefault();
    }
    if (docEditor.validation_results
        && (docEditor.validation_results.length == 0 || enoughAutoTextFields(docEditor.validation_results)))
         {
        var doc = docEditor.getValue();
        var text = cveRender({
            ctemplate: 'autoText',
            con: doc.containers.cna
        });
        // remove extra spaces
        text = text.trim().replaceAll(/\s+/g, ' ');
        hE = await docEditor.getEditor('root.containers.cna.descriptions.0.supportingMedia.0.value');

        // Capitolize sentances.
        var rg = /(^\w{1}|\.\s*\w{1})/gi;
        text = text.replace(rg, function (toReplace) {
            return toReplace.toUpperCase();
        });
        hE.setValue(text, '', false);
    } else {
        showAlert('Please enter all the required fields first!');
    }
}

function addRichText(d) {
    var ht = '';
    if (d.value) {
        ht = cveRender({
            ctemplate: 'htext',
            t: d.value
        })
    }
    if (!d.supportingMedia) {
        d.supportingMedia = [
            {
                type: "text/html",
                base64: false,
                value: ht
            }
        ]
    }
    return d;
}

function addRichTextArray(j) {
    if (j && j.length > 0) {
        j.forEach(element => addRichText(element));
    }
}

function addRichTextCVE(j) {
    var htmlFields = [
        'descriptions',
        'solutions',
        'workarounds',
        'exploits',
        'configurations'
    ];

    if (j && j.containers && j.containers.cna) {
        var cna = j.containers.cna
        htmlFields.forEach(element => {
            addRichTextArray(cna[element])
        });
    }
    return j;
}

function cvssv3_0_to_cvss3_1(j) {
    if (j && j.containers && j.containers.cna && j.containers.cna.metrics) {
        j.containers.cna.metrics.forEach(m => {
            if (m.cvssV3_0) {
                m.cvssV3_1 = m.cvssV3_0;
                m.cvssV3_1.version = "3.1";
                if (m.cvssV3_1.vectorString) {
                    m.cvssV3_1.vectorString = m.cvssV3_1.vectorString.replace('CVSS:3.0', 'CVSS:3.1');
                }
                delete m.cvssV3_0;
            }
        });
    }
    return j
}

async function loadCVEFile(event, elem) {
    var file = elem.files[0];
    if (file) {
        try {
            var reader = new FileReader();
            reader.readAsText(file, "UTF-8");
            reader.onload = function (evt) {
                try {
                    res = JSON.parse(evt.target.result);
                    if (res && res.dataVersion == "5.0" || res.dataVersion == "5.1") {
                        res = cveFixForVulnogram(res);
                        //docEditor.setValue(res);
                        var edOpts = (res.cveMetadata.state == 'REJECTED') ? rejectEditorOption : publicEditorOption;
                        mainTabGroup.change(0);
                        loadJSON(res, null, "Imported file", edOpts);
                    } else {
                        showAlert("Not a CVE JSON 5.0 file!");
                    }
                } catch (e) {
                    showAlert(e);
                }
            };
            reader.onerror = function (evt) {
                errMsg.textContent = "Error reading file";
                showAlert('Error reading file!');
            };
        } catch (e) {
            showAlert(e);
        }
    }
}

function cveFixForVulnogram(j) {
    j = addRichTextCVE(j);
    j = cvssv3_0_to_cvss3_1(j);
    if (j.containers && j.containers.cna && j.containers.cna.problemTypes == undefined) {
        j.containers.cna.problemTypes = [];
    }
    if (j.containers && j.containers.cna && j.containers.cna.impacts == undefined) {
        j.containers.cna.impacts = [];
    }
    if (j.containers && j.containers.cna && j.containers.cna.metrics == undefined) {
        j.containers.cna.metrics = [];
    }
    return j;
}
</script><script>function pug_attr(t,e,n,r){if(!1===e||null==e||!e&&("class"===t||"style"===t))return"";if(!0===e)return" "+(r?t:t+'="'+t+'"');var f=typeof e;return"object"!==f&&"function"!==f||"function"!=typeof e.toJSON||(e=e.toJSON()),"string"==typeof e||(e=JSON.stringify(e),n||-1===e.indexOf('"'))?(n&&(e=pug_escape(e))," "+t+'="'+e+'"'):" "+t+"='"+e.replace(/'/g,"&#39;")+"'"}
function pug_classes(s,r){return Array.isArray(s)?pug_classes_array(s,r):s&&"object"==typeof s?pug_classes_object(s):s||""}
function pug_classes_array(r,a){for(var s,e="",u="",c=Array.isArray(a),g=0;g<r.length;g++)(s=pug_classes(r[g]))&&(c&&a[g]&&(s=pug_escape(s)),e=e+u+s,u=" ");return e}
function pug_classes_object(r){var a="",n="";for(var o in r)o&&r[o]&&pug_has_own_property.call(r,o)&&(a=a+n+o,n=" ");return a}
function pug_escape(e){var a=""+e,t=pug_match_html.exec(a);if(!t)return e;var r,c,n,s="";for(r=t.index,c=0;r<a.length;r++){switch(a.charCodeAt(r)){case 34:n="&quot;";break;case 38:n="&amp;";break;case 60:n="&lt;";break;case 62:n="&gt;";break;default:continue}c!==r&&(s+=a.substring(c,r)),c=r+1,s+=n}return c!==r?s+a.substring(c,r):s}
var pug_has_own_property=Object.prototype.hasOwnProperty;
var pug_match_html=/["&<>]/;function pugRender(locals) {var pug_html = "", pug_mixins = {}, pug_interp;;
    var locals_for_with = (locals || {});

    (function (Array, Date, JSON, Object, URL, cmap, doc, doc_id, encodeURIComponent, isNaN, renderTemplate, versionStatusTable5) {
      pug_mixins["spara"] = pug_interp = function(l, hypertext){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (l) {
// iterate l
;(function(){
  var $$obj = l;
  if ('number' == typeof $$obj.length) {
      for (var pug_index0 = 0, $$l = $$obj.length; pug_index0 < $$l; pug_index0++) {
        var d = $$obj[pug_index0];
if (d.supportingMedia && d.supportingMedia.length > 0 && d.supportingMedia[0].type == 'text/html') {
pug_html = pug_html + "\u003Cp\u003E" + (null == (pug_interp = d.supportingMedia[0].value) ? "" : pug_interp) + "\u003C\u002Fp\u003E";
}
else
if (d.value) {
pug_mixins["para"](d.value);
}
      }
  } else {
    var $$l = 0;
    for (var pug_index0 in $$obj) {
      $$l++;
      var d = $$obj[pug_index0];
if (d.supportingMedia && d.supportingMedia.length > 0 && d.supportingMedia[0].type == 'text/html') {
pug_html = pug_html + "\u003Cp\u003E" + (null == (pug_interp = d.supportingMedia[0].value) ? "" : pug_interp) + "\u003C\u002Fp\u003E";
}
else
if (d.value) {
pug_mixins["para"](d.value);
}
    }
  }
}).call(this);

}
};
pug_mixins["cvssList"] = pug_interp = function(cvssList){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (cvssList) {
var nonSpec = ['baseScore', 'version', 'vectorString', 'baseSeverity', 'scenarios']
// iterate cvssList
;(function(){
  var $$obj = cvssList;
  if ('number' == typeof $$obj.length) {
      for (var i = 0, $$l = $$obj.length; i < $$l; i++) {
        var cvss = $$obj[i];
pug_html = pug_html + "\u003Cdetails class=\"popup\"\u003E\u003Csummary" + (pug_attr("class", pug_classes(["lbl","rnd","sec","CVSS",cvss.baseSeverity ? cvss.baseSeverity : 'gray'], [false,false,false,false,true]), false, false)) + "\u003ECVSS · " + (pug_escape(null == (pug_interp = cvss.baseSeverity) ? "" : pug_interp)) + " · " + (pug_escape(null == (pug_interp = cvss.baseScore) ? "" : pug_interp)) + "\u003Csub\u003E⁄10\u003C\u002Fsub\u003E\u003Cspan style=\"font-size:0px;opacity:0\"\u003E · " + (pug_escape(null == (pug_interp = cvss.vectorString) ? "" : pug_interp)) + "\u003C\u002Fspan\u003E\u003C\u002Fsummary\u003E\u003Cdiv class=\"pop wht rnd shd pad bor\"\u003E";
if (cvss.scenarios) {
// iterate cvss.scenarios
;(function(){
  var $$obj = cvss.scenarios;
  if ('number' == typeof $$obj.length) {
      for (var i = 0, $$l = $$obj.length; i < $$l; i++) {
        var s = $$obj[i];
pug_html = pug_html + ("\u003Cspan\u003EScoring scenario: \u003C\u002Fspan\u003E" + (pug_escape(null == (pug_interp = s.value) ? "" : pug_interp)));
      }
  } else {
    var $$l = 0;
    for (var i in $$obj) {
      $$l++;
      var s = $$obj[i];
pug_html = pug_html + ("\u003Cspan\u003EScoring scenario: \u003C\u002Fspan\u003E" + (pug_escape(null == (pug_interp = s.value) ? "" : pug_interp)));
    }
  }
}).call(this);

}
// iterate cvss
;(function(){
  var $$obj = cvss;
  if ('number' == typeof $$obj.length) {
      for (var i = 0, $$l = $$obj.length; i < $$l; i++) {
        var x = $$obj[i];
if (!nonSpec.includes(i)) {
pug_html = pug_html + "\u003Cdiv\u003E" + (pug_escape(null == (pug_interp = i) ? "" : pug_interp)) + ":  \u003Cb\u003E" + (pug_escape(null == (pug_interp = x) ? "" : pug_interp)) + "\u003C\u002Fb\u003E\u003C\u002Fdiv\u003E";
}
      }
  } else {
    var $$l = 0;
    for (var i in $$obj) {
      $$l++;
      var x = $$obj[i];
if (!nonSpec.includes(i)) {
pug_html = pug_html + "\u003Cdiv\u003E" + (pug_escape(null == (pug_interp = i) ? "" : pug_interp)) + ":  \u003Cb\u003E" + (pug_escape(null == (pug_interp = x) ? "" : pug_interp)) + "\u003C\u002Fb\u003E\u003C\u002Fdiv\u003E";
}
    }
  }
}).call(this);

pug_html = pug_html + "\u003Cdiv\u003E";
if (cvss.version >= "3") {
pug_html = pug_html + "\u003Ca" + (" class=\"vgi-dial\""+pug_attr("href", "https://cvss.js.org/#" + cvss.vectorString, true, false)+" target=\"_blank\"") + "\u003EOpen CVSS Calc\u003C\u002Fa\u003E";
}
else {
pug_html = pug_html + "\u003Ca" + (" class=\"vgi-dial\""+pug_attr("href", 'https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?vector='+cvss.vectorString, true, false)+" target=\"_blank\"") + "\u003EOpen CVSS Calc\u003C\u002Fa\u003E";
}
pug_html = pug_html + "\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E";
      }
  } else {
    var $$l = 0;
    for (var i in $$obj) {
      $$l++;
      var cvss = $$obj[i];
pug_html = pug_html + "\u003Cdetails class=\"popup\"\u003E\u003Csummary" + (pug_attr("class", pug_classes(["lbl","rnd","sec","CVSS",cvss.baseSeverity ? cvss.baseSeverity : 'gray'], [false,false,false,false,true]), false, false)) + "\u003ECVSS · " + (pug_escape(null == (pug_interp = cvss.baseSeverity) ? "" : pug_interp)) + " · " + (pug_escape(null == (pug_interp = cvss.baseScore) ? "" : pug_interp)) + "\u003Csub\u003E⁄10\u003C\u002Fsub\u003E\u003Cspan style=\"font-size:0px;opacity:0\"\u003E · " + (pug_escape(null == (pug_interp = cvss.vectorString) ? "" : pug_interp)) + "\u003C\u002Fspan\u003E\u003C\u002Fsummary\u003E\u003Cdiv class=\"pop wht rnd shd pad bor\"\u003E";
if (cvss.scenarios) {
// iterate cvss.scenarios
;(function(){
  var $$obj = cvss.scenarios;
  if ('number' == typeof $$obj.length) {
      for (var i = 0, $$l = $$obj.length; i < $$l; i++) {
        var s = $$obj[i];
pug_html = pug_html + ("\u003Cspan\u003EScoring scenario: \u003C\u002Fspan\u003E" + (pug_escape(null == (pug_interp = s.value) ? "" : pug_interp)));
      }
  } else {
    var $$l = 0;
    for (var i in $$obj) {
      $$l++;
      var s = $$obj[i];
pug_html = pug_html + ("\u003Cspan\u003EScoring scenario: \u003C\u002Fspan\u003E" + (pug_escape(null == (pug_interp = s.value) ? "" : pug_interp)));
    }
  }
}).call(this);

}
// iterate cvss
;(function(){
  var $$obj = cvss;
  if ('number' == typeof $$obj.length) {
      for (var i = 0, $$l = $$obj.length; i < $$l; i++) {
        var x = $$obj[i];
if (!nonSpec.includes(i)) {
pug_html = pug_html + "\u003Cdiv\u003E" + (pug_escape(null == (pug_interp = i) ? "" : pug_interp)) + ":  \u003Cb\u003E" + (pug_escape(null == (pug_interp = x) ? "" : pug_interp)) + "\u003C\u002Fb\u003E\u003C\u002Fdiv\u003E";
}
      }
  } else {
    var $$l = 0;
    for (var i in $$obj) {
      $$l++;
      var x = $$obj[i];
if (!nonSpec.includes(i)) {
pug_html = pug_html + "\u003Cdiv\u003E" + (pug_escape(null == (pug_interp = i) ? "" : pug_interp)) + ":  \u003Cb\u003E" + (pug_escape(null == (pug_interp = x) ? "" : pug_interp)) + "\u003C\u002Fb\u003E\u003C\u002Fdiv\u003E";
}
    }
  }
}).call(this);

pug_html = pug_html + "\u003Cdiv\u003E";
if (cvss.version >= "3") {
pug_html = pug_html + "\u003Ca" + (" class=\"vgi-dial\""+pug_attr("href", "https://cvss.js.org/#" + cvss.vectorString, true, false)+" target=\"_blank\"") + "\u003EOpen CVSS Calc\u003C\u002Fa\u003E";
}
else {
pug_html = pug_html + "\u003Ca" + (" class=\"vgi-dial\""+pug_attr("href", 'https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?vector='+cvss.vectorString, true, false)+" target=\"_blank\"") + "\u003EOpen CVSS Calc\u003C\u002Fa\u003E";
}
pug_html = pug_html + "\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E";
    }
  }
}).call(this);

}
};
pug_mixins["prodDetails"] = pug_interp = function(p){
var block = (this && this.block), attributes = (this && this.attributes) || {};
pug_html = pug_html + "\u003Cb class=\"vgi-package\"\u003E" + (pug_escape(null == (pug_interp = p[0]) ? "" : pug_interp)) + "\u003C\u002Fb\u003E";
if (p[2]) {
pug_html = pug_html + "\u003Cspan\u003E » " + (pug_escape(null == (pug_interp = p[2]) ? "" : pug_interp)) + "\u003C\u002Fspan\u003E";
}
if (p[1]) {
pug_html = pug_html + "\u003Ci\u003E on \u003C\u002Fi\u003E \u003Cspan class=\"vgi-stack\"\u003E" + (pug_escape(null == (pug_interp = p[1]) ? "" : pug_interp)) + "\u003C\u002Fspan\u003E";
}
if (p[3]) {
pug_html = pug_html + "\u003Cbr\u002F\u003E";
if (p[3].collectionURL) {
pug_html = pug_html + "\u003Ca" + (" class=\"vgi-package\""+pug_attr("href", p[3].collectionURL, true, false)) + "\u003Epackage repo\u003C\u002Fa\u003E";
}
if (p[3].repo) {
pug_html = pug_html + "\u003Ca" + (" class=\"vgi-ext\""+pug_attr("href", p[3].repo, true, false)) + "\u003Esource repo\u003C\u002Fa\u003E";
}
if (p[3].programFiles) {
// iterate p[3].programFiles
;(function(){
  var $$obj = p[3].programFiles;
  if ('number' == typeof $$obj.length) {
      for (var i = 0, $$l = $$obj.length; i < $$l; i++) {
        var f = $$obj[i];
pug_html = pug_html + "\u003Cspan class=\"vgi-text\"\u003E" + (pug_escape(null == (pug_interp = f) ? "" : pug_interp)) + "\u003C\u002Fspan\u003E";
      }
  } else {
    var $$l = 0;
    for (var i in $$obj) {
      $$l++;
      var f = $$obj[i];
pug_html = pug_html + "\u003Cspan class=\"vgi-text\"\u003E" + (pug_escape(null == (pug_interp = f) ? "" : pug_interp)) + "\u003C\u002Fspan\u003E";
    }
  }
}).call(this);

}
if (p[3].programRoutines) {
// iterate p[3].programRoutines
;(function(){
  var $$obj = p[3].programRoutines;
  if ('number' == typeof $$obj.length) {
      for (var i = 0, $$l = $$obj.length; i < $$l; i++) {
        var f = $$obj[i];
pug_html = pug_html + "\u003Cspan class=\"vgi-edit\"\u003E" + (pug_escape(null == (pug_interp = f.name) ? "" : pug_interp)) + "\u003C\u002Fspan\u003E";
      }
  } else {
    var $$l = 0;
    for (var i in $$obj) {
      $$l++;
      var f = $$obj[i];
pug_html = pug_html + "\u003Cspan class=\"vgi-edit\"\u003E" + (pug_escape(null == (pug_interp = f.name) ? "" : pug_interp)) + "\u003C\u002Fspan\u003E";
    }
  }
}).call(this);

}
}
if (p[4]) {
pug_html = pug_html + "\u003Cbr\u002F\u003E\u003Cspan class=\"vgi-impact\"\u003EDefault status is " + (pug_escape(null == (pug_interp = p[4]) ? "" : pug_interp)) + "\u003C\u002Fspan\u003E";
}
};
pug_mixins["statusTable"] = pug_interp = function(st){
var block = (this && this.block), attributes = (this && this.attributes) || {};
pug_html = pug_html + "\u003Ctable class=\"striped\"\u003E\u003Ccolgroup\u003E\u003Ccol\u002F\u003E\u003Ccol class=\"affectedCol\"\u002F\u003E\u003C\u002Fcolgroup\u003E\u003Cthead\u003E\u003Ctr\u003E\u003Cth\u003EProduct\u003C\u002Fth\u003E\u003Cth\u003EAffected\u003C\u002Fth\u003E";
if (st.show.unaffected) {
pug_html = pug_html + "\u003Cth\u003EUnaffected\u003C\u002Fth\u003E";
}
if (st.show.unknown) {
pug_html = pug_html + "\u003Cth\u003EUnknown\u003C\u002Fth\u003E";
}
pug_html = pug_html + "\u003C\u002Ftr\u003E\u003Ctbody\u003E";
// iterate st.groups
;(function(){
  var $$obj = st.groups;
  if ('number' == typeof $$obj.length) {
      for (var i = 0, $$l = $$obj.length; i < $$l; i++) {
        var p = $$obj[i];
var showProd = st.vals[i].length
// iterate st.vals[i]
;(function(){
  var $$obj = st.vals[i];
  if ('number' == typeof $$obj.length) {
      for (var j = 0, $$l = $$obj.length; j < $$l; j++) {
        var x = $$obj[j];
pug_html = pug_html + "\u003Ctr\u003E";
if (showProd) {
pug_html = pug_html + "\u003Ctd" + (pug_attr("rowspan", showProd, true, false)) + "\u003E";
pug_mixins["prodDetails"](p);
pug_html = pug_html + "\u003C\u002Ftd\u003E";
showProd = false
}
pug_html = pug_html + "\u003Ctd\u003E";
pug_mixins["versionList"](x.affected);
pug_html = pug_html + "\u003C\u002Ftd\u003E";
if (st.show.unaffected) {
pug_html = pug_html + "\u003Ctd\u003E";
pug_mixins["versionList"](x.unaffected);
pug_html = pug_html + "\u003C\u002Ftd\u003E";
}
if (st.show.unknown) {
pug_html = pug_html + "\u003Ctd\u003E";
pug_mixins["versionList"](x.unknown);
pug_html = pug_html + "\u003C\u002Ftd\u003E";
}
pug_html = pug_html + "\u003C\u002Ftr\u003E";
      }
  } else {
    var $$l = 0;
    for (var j in $$obj) {
      $$l++;
      var x = $$obj[j];
pug_html = pug_html + "\u003Ctr\u003E";
if (showProd) {
pug_html = pug_html + "\u003Ctd" + (pug_attr("rowspan", showProd, true, false)) + "\u003E";
pug_mixins["prodDetails"](p);
pug_html = pug_html + "\u003C\u002Ftd\u003E";
showProd = false
}
pug_html = pug_html + "\u003Ctd\u003E";
pug_mixins["versionList"](x.affected);
pug_html = pug_html + "\u003C\u002Ftd\u003E";
if (st.show.unaffected) {
pug_html = pug_html + "\u003Ctd\u003E";
pug_mixins["versionList"](x.unaffected);
pug_html = pug_html + "\u003C\u002Ftd\u003E";
}
if (st.show.unknown) {
pug_html = pug_html + "\u003Ctd\u003E";
pug_mixins["versionList"](x.unknown);
pug_html = pug_html + "\u003C\u002Ftd\u003E";
}
pug_html = pug_html + "\u003C\u002Ftr\u003E";
    }
  }
}).call(this);

      }
  } else {
    var $$l = 0;
    for (var i in $$obj) {
      $$l++;
      var p = $$obj[i];
var showProd = st.vals[i].length
// iterate st.vals[i]
;(function(){
  var $$obj = st.vals[i];
  if ('number' == typeof $$obj.length) {
      for (var j = 0, $$l = $$obj.length; j < $$l; j++) {
        var x = $$obj[j];
pug_html = pug_html + "\u003Ctr\u003E";
if (showProd) {
pug_html = pug_html + "\u003Ctd" + (pug_attr("rowspan", showProd, true, false)) + "\u003E";
pug_mixins["prodDetails"](p);
pug_html = pug_html + "\u003C\u002Ftd\u003E";
showProd = false
}
pug_html = pug_html + "\u003Ctd\u003E";
pug_mixins["versionList"](x.affected);
pug_html = pug_html + "\u003C\u002Ftd\u003E";
if (st.show.unaffected) {
pug_html = pug_html + "\u003Ctd\u003E";
pug_mixins["versionList"](x.unaffected);
pug_html = pug_html + "\u003C\u002Ftd\u003E";
}
if (st.show.unknown) {
pug_html = pug_html + "\u003Ctd\u003E";
pug_mixins["versionList"](x.unknown);
pug_html = pug_html + "\u003C\u002Ftd\u003E";
}
pug_html = pug_html + "\u003C\u002Ftr\u003E";
      }
  } else {
    var $$l = 0;
    for (var j in $$obj) {
      $$l++;
      var x = $$obj[j];
pug_html = pug_html + "\u003Ctr\u003E";
if (showProd) {
pug_html = pug_html + "\u003Ctd" + (pug_attr("rowspan", showProd, true, false)) + "\u003E";
pug_mixins["prodDetails"](p);
pug_html = pug_html + "\u003C\u002Ftd\u003E";
showProd = false
}
pug_html = pug_html + "\u003Ctd\u003E";
pug_mixins["versionList"](x.affected);
pug_html = pug_html + "\u003C\u002Ftd\u003E";
if (st.show.unaffected) {
pug_html = pug_html + "\u003Ctd\u003E";
pug_mixins["versionList"](x.unaffected);
pug_html = pug_html + "\u003C\u002Ftd\u003E";
}
if (st.show.unknown) {
pug_html = pug_html + "\u003Ctd\u003E";
pug_mixins["versionList"](x.unknown);
pug_html = pug_html + "\u003C\u002Ftd\u003E";
}
pug_html = pug_html + "\u003C\u002Ftr\u003E";
    }
  }
}).call(this);

    }
  }
}).call(this);

pug_html = pug_html + "\u003C\u002Ftbody\u003E\u003C\u002Fthead\u003E\u003C\u002Ftable\u003E";
};
pug_mixins["creditList"] = pug_interp = function(credits){
var block = (this && this.block), attributes = (this && this.attributes) || {};
// iterate credits
;(function(){
  var $$obj = credits;
  if ('number' == typeof $$obj.length) {
      for (var pug_index11 = 0, $$l = $$obj.length; pug_index11 < $$l; pug_index11++) {
        var c = $$obj[pug_index11];
pug_html = pug_html + "\u003Cp\u003E" + (pug_escape(null == (pug_interp = c.value) ? "" : pug_interp)) + "\u003C\u002Fp\u003E";
      }
  } else {
    var $$l = 0;
    for (var pug_index11 in $$obj) {
      $$l++;
      var c = $$obj[pug_index11];
pug_html = pug_html + "\u003Cp\u003E" + (pug_escape(null == (pug_interp = c.value) ? "" : pug_interp)) + "\u003C\u002Fp\u003E";
    }
  }
}).call(this);

};
pug_mixins["tagList"] = pug_interp = function(tags){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (tags) {
// iterate tags
;(function(){
  var $$obj = tags;
  if ('number' == typeof $$obj.length) {
      for (var pug_index12 = 0, $$l = $$obj.length; pug_index12 < $$l; pug_index12++) {
        var t = $$obj[pug_index12];
pug_html = pug_html + "\u003Cb class=\"tag rnd CVSS MEDIUM\"\u003E" + (pug_escape(null == (pug_interp = t) ? "" : pug_interp)) + "\u003C\u002Fb\u003E  ";
      }
  } else {
    var $$l = 0;
    for (var pug_index12 in $$obj) {
      $$l++;
      var t = $$obj[pug_index12];
pug_html = pug_html + "\u003Cb class=\"tag rnd CVSS MEDIUM\"\u003E" + (pug_escape(null == (pug_interp = t) ? "" : pug_interp)) + "\u003C\u002Fb\u003E  ";
    }
  }
}).call(this);

}
};
pug_mixins["timeList"] = pug_interp = function(c){
var block = (this && this.block), attributes = (this && this.attributes) || {};
pug_html = pug_html + "\u003Cul\u003E";
// iterate c.timeline
;(function(){
  var $$obj = c.timeline;
  if ('number' == typeof $$obj.length) {
      for (var i = 0, $$l = $$obj.length; i < $$l; i++) {
        var x = $$obj[i];
pug_html = pug_html + "\u003Cli\u003E";
pug_mixins["renderDate"](x.time);
pug_html = pug_html + " - " + (pug_escape(null == (pug_interp = x.value) ? "" : pug_interp)) + "\u003C\u002Fli\u003E";
      }
  } else {
    var $$l = 0;
    for (var i in $$obj) {
      $$l++;
      var x = $$obj[i];
pug_html = pug_html + "\u003Cli\u003E";
pug_mixins["renderDate"](x.time);
pug_html = pug_html + " - " + (pug_escape(null == (pug_interp = x.value) ? "" : pug_interp)) + "\u003C\u002Fli\u003E";
    }
  }
}).call(this);

pug_html = pug_html + "\u003C\u002Ful\u003E";
};
pug_mixins["refList"] = pug_interp = function(references){
var block = (this && this.block), attributes = (this && this.attributes) || {};
// iterate references
;(function(){
  var $$obj = references;
  if ('number' == typeof $$obj.length) {
      for (var pug_index14 = 0, $$l = $$obj.length; pug_index14 < $$l; pug_index14++) {
        var r = $$obj[pug_index14];
if (r.url) {
pug_html = pug_html + "\u003Cdiv\u003E";
var u ; try { u = (new URL(r.url)) } catch(e){};
if (u) {
pug_html = pug_html + "\u003Cimg" + (" class=\"lbl\""+" width=\"16\" height=\"16\""+pug_attr("src", "https://www.google.com/s2/favicons?sz=32&domain_url="+u.protocol + '//'+ encodeURIComponent(u.hostname), true, false)) + "\u002F\u003E\u003Ca" + (pug_attr("href", r.url, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = (r.name && (r.name != r.url)) ?  u.hostname + " : " + r.name : u.hostname + u.pathname + u.search) ? "" : pug_interp)) + "\u003C\u002Fa\u003E";
}
else {
pug_html = pug_html + (pug_escape(null == (pug_interp = r.url) ? "" : pug_interp));
}
if (r.tags && r.tags.length > 0) {
pug_html = pug_html + (" " + (pug_escape(null == (pug_interp = r.tags.join(" ")) ? "" : pug_interp)));
}
pug_html = pug_html + "\u003C\u002Fdiv\u003E";
}
      }
  } else {
    var $$l = 0;
    for (var pug_index14 in $$obj) {
      $$l++;
      var r = $$obj[pug_index14];
if (r.url) {
pug_html = pug_html + "\u003Cdiv\u003E";
var u ; try { u = (new URL(r.url)) } catch(e){};
if (u) {
pug_html = pug_html + "\u003Cimg" + (" class=\"lbl\""+" width=\"16\" height=\"16\""+pug_attr("src", "https://www.google.com/s2/favicons?sz=32&domain_url="+u.protocol + '//'+ encodeURIComponent(u.hostname), true, false)) + "\u002F\u003E\u003Ca" + (pug_attr("href", r.url, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = (r.name && (r.name != r.url)) ?  u.hostname + " : " + r.name : u.hostname + u.pathname + u.search) ? "" : pug_interp)) + "\u003C\u002Fa\u003E";
}
else {
pug_html = pug_html + (pug_escape(null == (pug_interp = r.url) ? "" : pug_interp));
}
if (r.tags && r.tags.length > 0) {
pug_html = pug_html + (" " + (pug_escape(null == (pug_interp = r.tags.join(" ")) ? "" : pug_interp)));
}
pug_html = pug_html + "\u003C\u002Fdiv\u003E";
}
    }
  }
}).call(this);

};
pug_mixins["errors"] = pug_interp = function(con){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (con.x_ValidationErrors) {
// iterate con.x_ValidationErrors
;(function(){
  var $$obj = con.x_ValidationErrors;
  if ('number' == typeof $$obj.length) {
      for (var pug_index15 = 0, $$l = $$obj.length; pug_index15 < $$l; pug_index15++) {
        var x = $$obj[pug_index15];
pug_html = pug_html + "\u003Cp class=\"sec rnd pad\"\u003E\u003Cb class=\"vgi-alert\"\u003EValidation Error : \u003C\u002Fb\u003E  \u003Cspan\u003E" + (pug_escape(null == (pug_interp = x) ? "" : pug_interp)) + "\u003C\u002Fspan\u003E\u003C\u002Fp\u003E";
      }
  } else {
    var $$l = 0;
    for (var pug_index15 in $$obj) {
      $$l++;
      var x = $$obj[pug_index15];
pug_html = pug_html + "\u003Cp class=\"sec rnd pad\"\u003E\u003Cb class=\"vgi-alert\"\u003EValidation Error : \u003C\u002Fb\u003E  \u003Cspan\u003E" + (pug_escape(null == (pug_interp = x) ? "" : pug_interp)) + "\u003C\u002Fspan\u003E\u003C\u002Fp\u003E";
    }
  }
}).call(this);

}
};
pug_mixins["warnings"] = pug_interp = function(con){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (con.x_ConverterErrors) {
// iterate con.x_ConverterErrors
;(function(){
  var $$obj = con.x_ConverterErrors;
  if ('number' == typeof $$obj.length) {
      for (var i = 0, $$l = $$obj.length; i < $$l; i++) {
        var x = $$obj[i];
pug_html = pug_html + "\u003Cp class=\"sec rnd pad\"\u003E\u003Cb class=\"vgi-alert\"\u003EConversion Warning :  \u003C\u002Fb\u003E \u003Cb\u003E" + (pug_escape(null == (pug_interp = x.error) ? "" : pug_interp)) + "\u003C\u002Fb\u003E \u003Cspan\u003E" + (pug_escape(null == (pug_interp = x.message) ? "" : pug_interp)) + "\u003C\u002Fspan\u003E\u003C\u002Fp\u003E";
      }
  } else {
    var $$l = 0;
    for (var i in $$obj) {
      $$l++;
      var x = $$obj[i];
pug_html = pug_html + "\u003Cp class=\"sec rnd pad\"\u003E\u003Cb class=\"vgi-alert\"\u003EConversion Warning :  \u003C\u002Fb\u003E \u003Cb\u003E" + (pug_escape(null == (pug_interp = x.error) ? "" : pug_interp)) + "\u003C\u002Fb\u003E \u003Cspan\u003E" + (pug_escape(null == (pug_interp = x.message) ? "" : pug_interp)) + "\u003C\u002Fspan\u003E\u003C\u002Fp\u003E";
    }
  }
}).call(this);

}
};
pug_mixins["container"] = pug_interp = function(con){
var block = (this && this.block), attributes = (this && this.attributes) || {};
pug_html = pug_html + "\u003Ch1 id=\"cvetitle\"\u003E";
var cveShowId = con.cveId.match(/^CVE-[0-9-]+$/)? con.cveId : 'CVE-yyyy-nnnn';
if (con.source && con.source.advisory) {
pug_html = pug_html + (pug_escape(null == (pug_interp = con.source.advisory) ? "" : pug_interp)) + " ";
}
pug_html = pug_html + (pug_escape(null == (pug_interp = cveShowId + ' ' + (con.title ?  con.title : '')) ? "" : pug_interp)) + "\u003C\u002Fh1\u003E\u003Cp\u003E";
if (con.shortName || con.datePublic) {
pug_html = pug_html + "\u003Cspan\u003EPublished\u003C\u002Fspan\u003E";
}
if (con.shortName) {
pug_html = pug_html + "by \u003Cb\u003E" + (pug_escape(null == (pug_interp = con.shortName) ? "" : pug_interp)) + "\u003C\u002Fb\u003E  ";
}
if (con.datePublic) {
pug_html = pug_html + "on ";
pug_mixins["renderDate"](con.datePublic);
}
if (con.dateUpdated && con.dateUpdated != con.datePublic) {
pug_html = pug_html + " (updated ";
pug_mixins["renderDate"](con.dateUpdated);
pug_html = pug_html + ")";
}
pug_html = pug_html + "\u003C\u002Fp\u003E";
if (con.cvssList) {
pug_html = pug_html + "\u003Cp\u003E";
pug_mixins["cvssList"](con.cvssList);
pug_html = pug_html + "\u003C\u002Fp\u003E";
}
pug_html = pug_html + "\u003Cdiv id=\"description\"\u003E";
if (con.state == 'REJECTED') {
pug_html = pug_html + "\u003Cb class=\"tag red\"\u003EREJECTED\u003C\u002Fb\u003E ·  ";
}
pug_mixins["tagList"](con.tags);
pug_html = pug_html + " ";
pug_mixins["spara"](con.descriptions);
pug_mixins["spara"](con.rejectedReasons);
pug_html = pug_html + "\u003C\u002Fdiv\u003E";
if (con.configurations) {
pug_html = pug_html + "\u003Cdiv id=\"configs\"\u003E\u003Ch2\u003ERequired configuration for exposure: \u003C\u002Fh2\u003E";
pug_mixins["spara"](con.configurations);
pug_html = pug_html + "\u003C\u002Fdiv\u003E";
}
if (con.problemTypes) {
pug_html = pug_html + "\u003Cdiv id=\"problem\"\u003E\u003Ch2\u003EProblem: \u003C\u002Fh2\u003E\u003Cp\u003E";
// iterate con.problemTypes
;(function(){
  var $$obj = con.problemTypes;
  if ('number' == typeof $$obj.length) {
      for (var pug_index17 = 0, $$l = $$obj.length; pug_index17 < $$l; pug_index17++) {
        var t = $$obj[pug_index17];
if (t.description) {
// iterate t.description
;(function(){
  var $$obj = t.description;
  if ('number' == typeof $$obj.length) {
      for (var pug_index18 = 0, $$l = $$obj.length; pug_index18 < $$l; pug_index18++) {
        var d = $$obj[pug_index18];
pug_html = pug_html + (pug_escape(null == (pug_interp = d.value) ? "" : pug_interp)) + "\u003Cbr\u002F\u003E";
      }
  } else {
    var $$l = 0;
    for (var pug_index18 in $$obj) {
      $$l++;
      var d = $$obj[pug_index18];
pug_html = pug_html + (pug_escape(null == (pug_interp = d.value) ? "" : pug_interp)) + "\u003Cbr\u002F\u003E";
    }
  }
}).call(this);

}
if (t.descriptions) {
// iterate t.descriptions
;(function(){
  var $$obj = t.descriptions;
  if ('number' == typeof $$obj.length) {
      for (var pug_index19 = 0, $$l = $$obj.length; pug_index19 < $$l; pug_index19++) {
        var d = $$obj[pug_index19];
pug_html = pug_html + (pug_escape(null == (pug_interp = d.description) ? "" : pug_interp)) + "  ";
if (d.cweId) {
pug_html = pug_html + "\u003Ca" + (pug_attr("href", "https://cwe.mitre.org/data/definitions/"+d.cweId.substr(4), true, false)+" target=\"_blank\"") + "\u003E\u003Csmall\u003E" + (pug_escape(null == (pug_interp = d.cweId) ? "" : pug_interp)) + "\u003C\u002Fsmall\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E";
}
      }
  } else {
    var $$l = 0;
    for (var pug_index19 in $$obj) {
      $$l++;
      var d = $$obj[pug_index19];
pug_html = pug_html + (pug_escape(null == (pug_interp = d.description) ? "" : pug_interp)) + "  ";
if (d.cweId) {
pug_html = pug_html + "\u003Ca" + (pug_attr("href", "https://cwe.mitre.org/data/definitions/"+d.cweId.substr(4), true, false)+" target=\"_blank\"") + "\u003E\u003Csmall\u003E" + (pug_escape(null == (pug_interp = d.cweId) ? "" : pug_interp)) + "\u003C\u002Fsmall\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E";
}
    }
  }
}).call(this);

}
      }
  } else {
    var $$l = 0;
    for (var pug_index17 in $$obj) {
      $$l++;
      var t = $$obj[pug_index17];
if (t.description) {
// iterate t.description
;(function(){
  var $$obj = t.description;
  if ('number' == typeof $$obj.length) {
      for (var pug_index20 = 0, $$l = $$obj.length; pug_index20 < $$l; pug_index20++) {
        var d = $$obj[pug_index20];
pug_html = pug_html + (pug_escape(null == (pug_interp = d.value) ? "" : pug_interp)) + "\u003Cbr\u002F\u003E";
      }
  } else {
    var $$l = 0;
    for (var pug_index20 in $$obj) {
      $$l++;
      var d = $$obj[pug_index20];
pug_html = pug_html + (pug_escape(null == (pug_interp = d.value) ? "" : pug_interp)) + "\u003Cbr\u002F\u003E";
    }
  }
}).call(this);

}
if (t.descriptions) {
// iterate t.descriptions
;(function(){
  var $$obj = t.descriptions;
  if ('number' == typeof $$obj.length) {
      for (var pug_index21 = 0, $$l = $$obj.length; pug_index21 < $$l; pug_index21++) {
        var d = $$obj[pug_index21];
pug_html = pug_html + (pug_escape(null == (pug_interp = d.description) ? "" : pug_interp)) + "  ";
if (d.cweId) {
pug_html = pug_html + "\u003Ca" + (pug_attr("href", "https://cwe.mitre.org/data/definitions/"+d.cweId.substr(4), true, false)+" target=\"_blank\"") + "\u003E\u003Csmall\u003E" + (pug_escape(null == (pug_interp = d.cweId) ? "" : pug_interp)) + "\u003C\u002Fsmall\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E";
}
      }
  } else {
    var $$l = 0;
    for (var pug_index21 in $$obj) {
      $$l++;
      var d = $$obj[pug_index21];
pug_html = pug_html + (pug_escape(null == (pug_interp = d.description) ? "" : pug_interp)) + "  ";
if (d.cweId) {
pug_html = pug_html + "\u003Ca" + (pug_attr("href", "https://cwe.mitre.org/data/definitions/"+d.cweId.substr(4), true, false)+" target=\"_blank\"") + "\u003E\u003Csmall\u003E" + (pug_escape(null == (pug_interp = d.cweId) ? "" : pug_interp)) + "\u003C\u002Fsmall\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E";
}
    }
  }
}).call(this);

}
    }
  }
}).call(this);

pug_html = pug_html + "\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E";
}
if (con.impacts) {
pug_html = pug_html + "\u003Cdiv id=\"impact\"\u003E\u003Ch2\u003EImpact:  \u003C\u002Fh2\u003E\u003Cp\u003E";
// iterate con.impacts
;(function(){
  var $$obj = con.impacts;
  if ('number' == typeof $$obj.length) {
      for (var pug_index22 = 0, $$l = $$obj.length; pug_index22 < $$l; pug_index22++) {
        var t = $$obj[pug_index22];
if (t.descriptions) {
// iterate t.descriptions
;(function(){
  var $$obj = t.descriptions;
  if ('number' == typeof $$obj.length) {
      for (var pug_index23 = 0, $$l = $$obj.length; pug_index23 < $$l; pug_index23++) {
        var d = $$obj[pug_index23];
pug_html = pug_html + (pug_escape(null == (pug_interp = d.value) ? "" : pug_interp)) + "  ";
      }
  } else {
    var $$l = 0;
    for (var pug_index23 in $$obj) {
      $$l++;
      var d = $$obj[pug_index23];
pug_html = pug_html + (pug_escape(null == (pug_interp = d.value) ? "" : pug_interp)) + "  ";
    }
  }
}).call(this);

}
if (t.capecId) {
pug_html = pug_html + "\u003Ca" + (pug_attr("href", "https://capec.mitre.org/data/definitions/"+t.capecId.substr(6), true, false)+" target=\"_blank\"") + "\u003E\u003Csmall\u003E" + (pug_escape(null == (pug_interp = t.capecId) ? "" : pug_interp)) + "\u003C\u002Fsmall\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E";
}
      }
  } else {
    var $$l = 0;
    for (var pug_index22 in $$obj) {
      $$l++;
      var t = $$obj[pug_index22];
if (t.descriptions) {
// iterate t.descriptions
;(function(){
  var $$obj = t.descriptions;
  if ('number' == typeof $$obj.length) {
      for (var pug_index24 = 0, $$l = $$obj.length; pug_index24 < $$l; pug_index24++) {
        var d = $$obj[pug_index24];
pug_html = pug_html + (pug_escape(null == (pug_interp = d.value) ? "" : pug_interp)) + "  ";
      }
  } else {
    var $$l = 0;
    for (var pug_index24 in $$obj) {
      $$l++;
      var d = $$obj[pug_index24];
pug_html = pug_html + (pug_escape(null == (pug_interp = d.value) ? "" : pug_interp)) + "  ";
    }
  }
}).call(this);

}
if (t.capecId) {
pug_html = pug_html + "\u003Ca" + (pug_attr("href", "https://capec.mitre.org/data/definitions/"+t.capecId.substr(6), true, false)+" target=\"_blank\"") + "\u003E\u003Csmall\u003E" + (pug_escape(null == (pug_interp = t.capecId) ? "" : pug_interp)) + "\u003C\u002Fsmall\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E";
}
    }
  }
}).call(this);

pug_html = pug_html + "\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E";
}
if (con.exploits) {
pug_html = pug_html + "\u003Cdiv id=\"exploits\"\u003E\u003Ch2\u003EExploits:\u003C\u002Fh2\u003E";
pug_mixins["spara"](con.exploits);
pug_html = pug_html + "\u003C\u002Fdiv\u003E";
}
if (con.pvstatus) {
pug_html = pug_html + "\u003Cdiv id=\"status\"\u003E\u003Ch2\u003EProduct Status:\u003C\u002Fh2\u003E";
pug_mixins["statusTable"](con.pvstatus);
pug_html = pug_html + "\u003Cbr style=\"font-size:0;\"\u002F\u003E\u003C\u002Fdiv\u003E";
}
if (con.solutions) {
pug_html = pug_html + "\u003Cdiv id=\"solution\"\u003E\u003Ch2\u003ESolution:\u003C\u002Fh2\u003E";
pug_mixins["spara"](con.solutions);
pug_html = pug_html + "\u003C\u002Fdiv\u003E";
}
if (con.workarounds) {
pug_html = pug_html + "\u003Cdiv id=\"workaround\"\u003E\u003Ch2\u003EWorkaround:\u003C\u002Fh2\u003E";
pug_mixins["spara"](con.workarounds);
pug_html = pug_html + "\u003C\u002Fdiv\u003E";
}
if (con.credits) {
pug_html = pug_html + "\u003Cdiv class=\"rnd pad sec vgap\" id=\"credits\"\u003E\u003Ch2\u003ECredits:\u003C\u002Fh2\u003E";
pug_mixins["creditList"](con.credits);
pug_html = pug_html + "\u003C\u002Fdiv\u003E";
}
if (con.timeline) {
pug_html = pug_html + "\u003Cdiv id=\"timeline\"\u003E\u003Ch2\u003ETimeline:\u003C\u002Fh2\u003E\u003Cp\u003E";
pug_mixins["timeList"](con);
pug_html = pug_html + "\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E";
}
if (con.references) {
pug_html = pug_html + "\u003Cdiv id=\"references\"\u003E\u003Ch2\u003EReferences\u003C\u002Fh2\u003E\u003Cp\u003E";
pug_mixins["refList"](con.references);
pug_html = pug_html + "\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E";
}
if (con.json) {
pug_html = pug_html + "\u003Cpre\u003E" + (pug_escape(null == (pug_interp = JSON.stringify(con.json,1,1)) ? "" : pug_interp)) + "\u003C\u002Fpre\u003E";
}
};
pug_mixins["para"] = pug_interp = function(t, hypertext){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (t) {
if (hypertext) {
pug_html = pug_html + "\u003Cp\u003E" + (pug_escape(null == (pug_interp = t) ? "" : pug_interp)) + "\u003C\u002Fp\u003E";
}
else {
// iterate t.split(/\n/)
;(function(){
  var $$obj = t.split(/\n/);
  if ('number' == typeof $$obj.length) {
      for (var pug_index25 = 0, $$l = $$obj.length; pug_index25 < $$l; pug_index25++) {
        var line = $$obj[pug_index25];
if (line) {
if (line.startsWith('  ')) {
pug_html = pug_html + "\u003Ccode\u003E" + (pug_escape(null == (pug_interp = line) ? "" : pug_interp)) + "\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E";
}
else {
pug_html = pug_html + "\u003Cp\u003E" + (pug_escape(null == (pug_interp = line) ? "" : pug_interp)) + "\u003C\u002Fp\u003E";
}
}
      }
  } else {
    var $$l = 0;
    for (var pug_index25 in $$obj) {
      $$l++;
      var line = $$obj[pug_index25];
if (line) {
if (line.startsWith('  ')) {
pug_html = pug_html + "\u003Ccode\u003E" + (pug_escape(null == (pug_interp = line) ? "" : pug_interp)) + "\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E";
}
else {
pug_html = pug_html + "\u003Cp\u003E" + (pug_escape(null == (pug_interp = line) ? "" : pug_interp)) + "\u003C\u002Fp\u003E";
}
}
    }
  }
}).call(this);

}
}
};
pug_mixins["mpara"] = pug_interp = function(l, hypertext){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (l) {
// iterate l
;(function(){
  var $$obj = l;
  if ('number' == typeof $$obj.length) {
      for (var pug_index26 = 0, $$l = $$obj.length; pug_index26 < $$l; pug_index26++) {
        var d = $$obj[pug_index26];
if (d.value) {
pug_mixins["para"](d.value, hypertext);
}
      }
  } else {
    var $$l = 0;
    for (var pug_index26 in $$obj) {
      $$l++;
      var d = $$obj[pug_index26];
if (d.value) {
pug_mixins["para"](d.value, hypertext);
}
    }
  }
}).call(this);

}
};
pug_mixins["aggpara"] = pug_interp = function(l){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (l) {
pug_html = pug_html + "\u003Cul\u003E";
// iterate l
;(function(){
  var $$obj = l;
  if ('number' == typeof $$obj.length) {
      for (var v = 0, $$l = $$obj.length; v < $$l; v++) {
        var k = $$obj[v];
pug_html = pug_html + "\u003Cli\u003E\u003Cb\u003E" + (pug_escape(null == (pug_interp = k.join(', ')) ? "" : pug_interp)) + "\u003C\u002Fb\u003E\u003Cp\u003E";
pug_mixins["para"](v);
pug_html = pug_html + "\u003C\u002Fp\u003E\u003C\u002Fli\u003E";
      }
  } else {
    var $$l = 0;
    for (var v in $$obj) {
      $$l++;
      var k = $$obj[v];
pug_html = pug_html + "\u003Cli\u003E\u003Cb\u003E" + (pug_escape(null == (pug_interp = k.join(', ')) ? "" : pug_interp)) + "\u003C\u002Fb\u003E\u003Cp\u003E";
pug_mixins["para"](v);
pug_html = pug_html + "\u003C\u002Fp\u003E\u003C\u002Fli\u003E";
    }
  }
}).call(this);

pug_html = pug_html + "\u003C\u002Ful\u003E";
}
};
pug_mixins["spara"] = pug_interp = function(l, hypertext){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (l) {
// iterate l
;(function(){
  var $$obj = l;
  if ('number' == typeof $$obj.length) {
      for (var pug_index28 = 0, $$l = $$obj.length; pug_index28 < $$l; pug_index28++) {
        var d = $$obj[pug_index28];
if (d.supportingMedia && d.supportingMedia.length > 0 && d.supportingMedia[0].type == 'text/html') {
pug_html = pug_html + "\u003Cp\u003E" + (null == (pug_interp = d.supportingMedia[0].value) ? "" : pug_interp) + "\u003C\u002Fp\u003E";
}
else
if (d.value) {
pug_mixins["para"](d.value);
}
      }
  } else {
    var $$l = 0;
    for (var pug_index28 in $$obj) {
      $$l++;
      var d = $$obj[pug_index28];
if (d.supportingMedia && d.supportingMedia.length > 0 && d.supportingMedia[0].type == 'text/html') {
pug_html = pug_html + "\u003Cp\u003E" + (null == (pug_interp = d.supportingMedia[0].value) ? "" : pug_interp) + "\u003C\u002Fp\u003E";
}
else
if (d.value) {
pug_mixins["para"](d.value);
}
    }
  }
}).call(this);

}
};
pug_mixins["linklist"] = pug_interp = function(l, url){
var block = (this && this.block), attributes = (this && this.attributes) || {};
// iterate l
;(function(){
  var $$obj = l;
  if ('number' == typeof $$obj.length) {
      for (var i = 0, $$l = $$obj.length; i < $$l; i++) {
        var v = $$obj[i];
if ((i < l.length-2)) {
if ((url)) {
pug_html = pug_html + "\u003Ca" + (pug_attr("href", url+v, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = v) ? "" : pug_interp)) + "\u003C\u002Fa\u003E";
}
else {
pug_html = pug_html + (pug_escape(null == (pug_interp = v) ? "" : pug_interp));
}
pug_html = pug_html + ", ";
}
else {
if ((i == l.length - 1 && i > 0)) {
pug_html = pug_html + " and ";
}
if ((url)) {
pug_html = pug_html + "\u003Ca" + (pug_attr("href", url+v, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = v) ? "" : pug_interp)) + "\u003C\u002Fa\u003E";
}
else {
pug_html = pug_html + (pug_escape(null == (pug_interp = v) ? "" : pug_interp));
}
}
      }
  } else {
    var $$l = 0;
    for (var i in $$obj) {
      $$l++;
      var v = $$obj[i];
if ((i < l.length-2)) {
if ((url)) {
pug_html = pug_html + "\u003Ca" + (pug_attr("href", url+v, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = v) ? "" : pug_interp)) + "\u003C\u002Fa\u003E";
}
else {
pug_html = pug_html + (pug_escape(null == (pug_interp = v) ? "" : pug_interp));
}
pug_html = pug_html + ", ";
}
else {
if ((i == l.length - 1 && i > 0)) {
pug_html = pug_html + " and ";
}
if ((url)) {
pug_html = pug_html + "\u003Ca" + (pug_attr("href", url+v, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = v) ? "" : pug_interp)) + "\u003C\u002Fa\u003E";
}
else {
pug_html = pug_html + (pug_escape(null == (pug_interp = v) ? "" : pug_interp));
}
}
    }
  }
}).call(this);

};
pug_mixins["CVSS"] = pug_interp = function(value){
var block = (this && this.block), attributes = (this && this.attributes) || {};
pug_html = pug_html + (pug_escape(null == (pug_interp = value && value.baseScore >= 0 ? value.baseScore.toFixed(1) : 'n/a') ? "" : pug_interp)) + " ";
if (value.version >= "3") {
pug_html = pug_html + "(\u003Ca" + (" target=\"_blank\""+pug_attr("href", "https://cvss.js.org/#" + value.vectorString, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = value.vectorString) ? "" : pug_interp)) + "\u003C\u002Fa\u003E)";
}
else {
pug_html = pug_html + "\u003Ca" + (pug_attr("href", 'https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?vector='+value.vectorString, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = value.vectorString) ? "" : pug_interp)) + "\u003C\u002Fa\u003E";
}
};
pug_mixins["renderDate"] = pug_interp = function(value){
var block = (this && this.block), attributes = (this && this.attributes) || {};
var v = false;
if (value instanceof Date) { v = value;} else {
var timestamp = Date.parse(value);
v = isNaN(timestamp) ? false : new Date(timestamp)
}
if (v) {
pug_html = pug_html + (pug_escape(null == (pug_interp = v.toJSON().substr(0,10)) ? "" : pug_interp));
}
};
pug_mixins["JSON"] = pug_interp = function(d, par, comma){
var block = (this && this.block), attributes = (this && this.attributes) || {};
var k;
if (d instanceof Array) {
pug_html = pug_html + "\u003Cdetails" + (" class=\"arr\""+pug_attr("open", true, true, false)) + "\u003E\u003Csummary\u003E\u003Cb\u003E" + (pug_escape(null == (pug_interp = (par? par + ' : [' : '[')) ? "" : pug_interp)) + "\u003C\u002Fb\u003E\u003C\u002Fsummary\u003E\u003Cdiv class=\"in\"\u003E";
// iterate d
;(function(){
  var $$obj = d;
  if ('number' == typeof $$obj.length) {
      for (var i = 0, $$l = $$obj.length; i < $$l; i++) {
        var s = $$obj[i];
pug_mixins["JSON"](s, undefined, i < d.length-1);
      }
  } else {
    var $$l = 0;
    for (var i in $$obj) {
      $$l++;
      var s = $$obj[i];
pug_mixins["JSON"](s, undefined, i < d.length-1);
    }
  }
}).call(this);

pug_html = pug_html + "\u003Cb\u003E]\u003C\u002Fb\u003E";
if (comma) {
pug_html = pug_html + "\u003Ci\u003E,\u003C\u002Fi\u003E";
}
pug_html = pug_html + "\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E";
}
else
if (d instanceof Object) {
pug_html = pug_html + "\u003Cdetails" + (" class=\"obj\""+pug_attr("open", true, true, false)) + "\u003E\u003Csummary\u003E\u003Cb\u003E" + (pug_escape(null == (pug_interp = (par? par + ' : {' : '{')) ? "" : pug_interp)) + "\u003C\u002Fb\u003E\u003C\u002Fsummary\u003E\u003Cdiv class=\"in\"\u003E";
var keys = Object.keys(d)
// iterate keys
;(function(){
  var $$obj = keys;
  if ('number' == typeof $$obj.length) {
      for (var i = 0, $$l = $$obj.length; i < $$l; i++) {
        var k = $$obj[i];
if (d.hasOwnProperty(k)) {
pug_mixins["JSON"](d[k], k, i < keys.length-1);
}
      }
  } else {
    var $$l = 0;
    for (var i in $$obj) {
      $$l++;
      var k = $$obj[i];
if (d.hasOwnProperty(k)) {
pug_mixins["JSON"](d[k], k, i < keys.length-1);
}
    }
  }
}).call(this);

pug_html = pug_html + "\u003Cb\u003E}\u003C\u002Fb\u003E";
if (comma) {
pug_html = pug_html + "\u003Ci\u003E,\u003C\u002Fi\u003E";
}
pug_html = pug_html + "\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E";
}
else {
if (par) {
pug_html = pug_html + "\u003Cdiv" + (pug_attr("class", pug_classes(["i",(typeof d === 'number' ? 'n' : '')], [false,true]), false, false)) + "\u003E\u003Cb\u003E" + (pug_escape(null == (pug_interp = par + ' : ') ? "" : pug_interp)) + "\u003C\u002Fb\u003E";
pug_mixins["showVal"](d, comma);
pug_html = pug_html + "\u003C\u002Fdiv\u003E";
}
else {
pug_html = pug_html + "\u003Cdiv" + (pug_attr("class", pug_classes([(typeof d === 'number' ? 'n' : '')], [true]), false, false)) + "\u003E";
pug_mixins["showVal"](d, comma);
pug_html = pug_html + "\u003C\u002Fdiv\u003E";
}
}
};
pug_mixins["showVal"] = pug_interp = function(d, comma){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (typeof d === 'string') {
pug_html = pug_html + "\u003Ci\u003E\"\u003C\u002Fi\u003E" + (pug_escape(null == (pug_interp = d) ? "" : pug_interp)) + "\u003Ci\u003E\"\u003C\u002Fi\u003E";
}
else {
pug_html = pug_html + (pug_escape(null == (pug_interp = d) ? "" : pug_interp));
}
if (comma) {
pug_html = pug_html + "\u003Ci\u003E,\u003C\u002Fi\u003E";
}
};
pug_mixins["versionList"] = pug_interp = function(v){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (v) {
// iterate v
;(function(){
  var $$obj = v;
  if ('number' == typeof $$obj.length) {
      for (var i = 0, $$l = $$obj.length; i < $$l; i++) {
        var x = $$obj[i];
pug_html = pug_html + (pug_escape(null == (pug_interp = x) ? "" : pug_interp)) + "\u003Cbr\u002F\u003E";
      }
  } else {
    var $$l = 0;
    for (var i in $$obj) {
      $$l++;
      var x = $$obj[i];
pug_html = pug_html + (pug_escape(null == (pug_interp = x) ? "" : pug_interp)) + "\u003Cbr\u002F\u003E";
    }
  }
}).call(this);

}
};
pug_mixins["del_versionList"] = pug_interp = function(v){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (v) {
var n = v.shift();
while (n != undefined) {
pug_html = pug_html + (pug_escape(null == (pug_interp = n) ? "" : pug_interp));
if (v.length > 0) {
pug_html = pug_html + "\u003Chr\u002F\u003E";
}
n = v.shift();
}
}
};
pug_mixins["mitre"] = pug_interp = function(cve){
var block = (this && this.block), attributes = (this && this.attributes) || {};
pug_html = pug_html + "\u003Ch2\u003EMITRE CVE entry preview\u003C\u002Fh2\u003E";
var cna = cve.containers.cna;
pug_html = pug_html + "\u003Cdiv id=\"GeneratedTable\"\u003E\u003Ctable cellpadding=\"0\" cellspacing=\"0\" border=\"0\"\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Cth colspan=\"2\"\u003ECVE-ID\u003C\u002Fth\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd nowrap=\"nowrap\"\u003E\u003Ch2\u003E" + (pug_escape(null == (pug_interp = cve.cveMetadata.cveId) ? "" : pug_interp)) + "\u003C\u002Fh2\u003E\u003C\u002Ftd\u003E\u003Ctd class=\"ltgreybackground\"\u003E\u003Cdiv class=\"larger\"\u003E\u003Ca\u003ELearn more at National Vulnerability Database (NVD)\u003C\u002Fa\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"smaller\"\u003E• Severity Rating • Fix Information • Vulnerable Software Versions • SCAP Mappings\u003C\u002Fdiv\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Cth colspan=\"2\"\u003EDescription\u003C\u002Fth\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd colspan=\"2\"\u003E";
// iterate cna.descriptions
;(function(){
  var $$obj = cna.descriptions;
  if ('number' == typeof $$obj.length) {
      for (var pug_index33 = 0, $$l = $$obj.length; pug_index33 < $$l; pug_index33++) {
        var d = $$obj[pug_index33];
pug_html = pug_html + ((pug_escape(null == (pug_interp = d.value) ? "" : pug_interp)) + (pug_escape(null == (pug_interp = ' ') ? "" : pug_interp)));
      }
  } else {
    var $$l = 0;
    for (var pug_index33 in $$obj) {
      $$l++;
      var d = $$obj[pug_index33];
pug_html = pug_html + ((pug_escape(null == (pug_interp = d.value) ? "" : pug_interp)) + (pug_escape(null == (pug_interp = ' ') ? "" : pug_interp)));
    }
  }
}).call(this);

pug_html = pug_html + "\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Cth colspan=\"2\"\u003EReferences\u003C\u002Fth\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd class=\"note\" colspan=\"2\"\u003E\u003Cb\u003ENote: \u003C\u002Fb\u003E\u003Ca\u003EReferences\u003C\u002Fa\u003E are provided for the convenience of the reader to help distinguish between vulnerabilities. The list is not intended to be complete.\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd colspan=\"2\"\u003E\u003Cul\u003E";
// iterate cna.references
;(function(){
  var $$obj = cna.references;
  if ('number' == typeof $$obj.length) {
      for (var pug_index34 = 0, $$l = $$obj.length; pug_index34 < $$l; pug_index34++) {
        var r = $$obj[pug_index34];
pug_html = pug_html + "\u003Cli\u003E\u003Ca" + (" target=\"_blank\""+pug_attr("href", r.url, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = r.url) ? "" : pug_interp)) + "\u003C\u002Fa\u003E\u003C\u002Fli\u003E";
      }
  } else {
    var $$l = 0;
    for (var pug_index34 in $$obj) {
      $$l++;
      var r = $$obj[pug_index34];
pug_html = pug_html + "\u003Cli\u003E\u003Ca" + (" target=\"_blank\""+pug_attr("href", r.url, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = r.url) ? "" : pug_interp)) + "\u003C\u002Fa\u003E\u003C\u002Fli\u003E";
    }
  }
}).call(this);

pug_html = pug_html + "\u003C\u002Ful\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Cth colspan=\"2\"\u003EAssigning CNA\u003C\u002Fth\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd colspan=\"2\"\u003E" + (pug_escape(null == (pug_interp = cve.cveMetadata.assignerShortName) ? "" : pug_interp)) + "\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Cth colspan=\"2\"\u003EDate Entry Created\u003C\u002Fth\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cb\u003EYYYYMMDD\u003C\u002Fb\u003E\u003C\u002Ftd\u003E\u003Ctd class=\"ltgreybackground\"\u003EDisclaimer: The entry creation date may reflect when the CVE-ID was allocated or reserved, and does not necessarily indicate when this vulnerability was discovered, shared with the affected vendor, publicly disclosed, or updated in CVE.\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003C\u002Ftbody\u003E\u003C\u002Ftable\u003E\u003C\u002Fdiv\u003E";
};
pug_mixins["para"] = pug_interp = function(t, hypertext){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (t) {
if (hypertext) {
pug_html = pug_html + "\u003Cp\u003E" + (pug_escape(null == (pug_interp = t) ? "" : pug_interp)) + "\u003C\u002Fp\u003E";
}
else {
// iterate t.split(/\n/)
;(function(){
  var $$obj = t.split(/\n/);
  if ('number' == typeof $$obj.length) {
      for (var pug_index35 = 0, $$l = $$obj.length; pug_index35 < $$l; pug_index35++) {
        var line = $$obj[pug_index35];
if (line) {
if (line.startsWith('  ')) {
pug_html = pug_html + "\u003Ccode\u003E" + (pug_escape(null == (pug_interp = line) ? "" : pug_interp)) + "\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E";
}
else {
pug_html = pug_html + "\u003Cp\u003E" + (pug_escape(null == (pug_interp = line) ? "" : pug_interp)) + "\u003C\u002Fp\u003E";
}
}
      }
  } else {
    var $$l = 0;
    for (var pug_index35 in $$obj) {
      $$l++;
      var line = $$obj[pug_index35];
if (line) {
if (line.startsWith('  ')) {
pug_html = pug_html + "\u003Ccode\u003E" + (pug_escape(null == (pug_interp = line) ? "" : pug_interp)) + "\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E";
}
else {
pug_html = pug_html + "\u003Cp\u003E" + (pug_escape(null == (pug_interp = line) ? "" : pug_interp)) + "\u003C\u002Fp\u003E";
}
}
    }
  }
}).call(this);

}
}
};
pug_mixins["mpara"] = pug_interp = function(l, hypertext){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (l) {
// iterate l
;(function(){
  var $$obj = l;
  if ('number' == typeof $$obj.length) {
      for (var pug_index36 = 0, $$l = $$obj.length; pug_index36 < $$l; pug_index36++) {
        var d = $$obj[pug_index36];
if (d.value) {
pug_mixins["para"](d.value, hypertext);
}
      }
  } else {
    var $$l = 0;
    for (var pug_index36 in $$obj) {
      $$l++;
      var d = $$obj[pug_index36];
if (d.value) {
pug_mixins["para"](d.value, hypertext);
}
    }
  }
}).call(this);

}
};
pug_mixins["aggpara"] = pug_interp = function(l){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (l) {
pug_html = pug_html + "\u003Cul\u003E";
// iterate l
;(function(){
  var $$obj = l;
  if ('number' == typeof $$obj.length) {
      for (var v = 0, $$l = $$obj.length; v < $$l; v++) {
        var k = $$obj[v];
pug_html = pug_html + "\u003Cli\u003E\u003Cb\u003E" + (pug_escape(null == (pug_interp = k.join(', ')) ? "" : pug_interp)) + "\u003C\u002Fb\u003E\u003Cp\u003E";
pug_mixins["para"](v);
pug_html = pug_html + "\u003C\u002Fp\u003E\u003C\u002Fli\u003E";
      }
  } else {
    var $$l = 0;
    for (var v in $$obj) {
      $$l++;
      var k = $$obj[v];
pug_html = pug_html + "\u003Cli\u003E\u003Cb\u003E" + (pug_escape(null == (pug_interp = k.join(', ')) ? "" : pug_interp)) + "\u003C\u002Fb\u003E\u003Cp\u003E";
pug_mixins["para"](v);
pug_html = pug_html + "\u003C\u002Fp\u003E\u003C\u002Fli\u003E";
    }
  }
}).call(this);

pug_html = pug_html + "\u003C\u002Ful\u003E";
}
};
pug_mixins["linklist"] = pug_interp = function(l, url){
var block = (this && this.block), attributes = (this && this.attributes) || {};
// iterate l
;(function(){
  var $$obj = l;
  if ('number' == typeof $$obj.length) {
      for (var i = 0, $$l = $$obj.length; i < $$l; i++) {
        var v = $$obj[i];
if ((i < l.length-2)) {
if ((url)) {
pug_html = pug_html + "\u003Ca" + (pug_attr("href", url+v, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = v) ? "" : pug_interp)) + "\u003C\u002Fa\u003E";
}
else {
pug_html = pug_html + (pug_escape(null == (pug_interp = v) ? "" : pug_interp));
}
pug_html = pug_html + ", ";
}
else {
if ((i == l.length - 1 && i > 0)) {
pug_html = pug_html + " and ";
}
if ((url)) {
pug_html = pug_html + "\u003Ca" + (pug_attr("href", url+v, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = v) ? "" : pug_interp)) + "\u003C\u002Fa\u003E";
}
else {
pug_html = pug_html + (pug_escape(null == (pug_interp = v) ? "" : pug_interp));
}
}
      }
  } else {
    var $$l = 0;
    for (var i in $$obj) {
      $$l++;
      var v = $$obj[i];
if ((i < l.length-2)) {
if ((url)) {
pug_html = pug_html + "\u003Ca" + (pug_attr("href", url+v, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = v) ? "" : pug_interp)) + "\u003C\u002Fa\u003E";
}
else {
pug_html = pug_html + (pug_escape(null == (pug_interp = v) ? "" : pug_interp));
}
pug_html = pug_html + ", ";
}
else {
if ((i == l.length - 1 && i > 0)) {
pug_html = pug_html + " and ";
}
if ((url)) {
pug_html = pug_html + "\u003Ca" + (pug_attr("href", url+v, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = v) ? "" : pug_interp)) + "\u003C\u002Fa\u003E";
}
else {
pug_html = pug_html + (pug_escape(null == (pug_interp = v) ? "" : pug_interp));
}
}
    }
  }
}).call(this);

};
pug_mixins["CVSS"] = pug_interp = function(value){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (value.baseScore) {
pug_html = pug_html + (pug_escape(null == (pug_interp = value.baseScore.toFixed(1)) ? "" : pug_interp));
}
pug_html = pug_html + " ";
if (value.version >= "3") {
pug_html = pug_html + "(\u003Ca" + (pug_attr("href", "https://cvss.js.org/#" + value.vectorString, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = value.vectorString) ? "" : pug_interp)) + "\u003C\u002Fa\u003E)";
}
else {
pug_html = pug_html + "\u003Ca" + (pug_attr("href", 'https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?vector='+value.vectorString, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = value.vectorString) ? "" : pug_interp)) + "\u003C\u002Fa\u003E";
}
};
pug_mixins["renderDate"] = pug_interp = function(value){
var block = (this && this.block), attributes = (this && this.attributes) || {};
var v = false;
if (value instanceof Date) { v = value;} else {
var timestamp = Date.parse(value);
v = isNaN(timestamp) ? false : new Date(timestamp)
}
if (v) {
pug_html = pug_html + (pug_escape(null == (pug_interp = v.toJSON().substr(0,10)) ? "" : pug_interp));
}
};
pug_mixins["jsondump"] = pug_interp = function(obj){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (obj !== null) {
if (typeof obj === 'string') {
if (obj.length < 20) {
pug_html = pug_html + "\u003Cspan" + (pug_attr("class", pug_classes([obj], [true]), false, false)) + "\u003E" + (pug_escape(null == (pug_interp = obj) ? "" : pug_interp)) + "\u003C\u002Fspan\u003E";
}
else {
pug_html = pug_html + "\u003Cspan class=\"wrp\"\u003E" + (pug_escape(null == (pug_interp = obj) ? "" : pug_interp)) + "\u003C\u002Fspan\u003E";
}
}
else
if (obj instanceof Array) {
if (obj.length > 0) {
pug_html = pug_html + "\u003Col\u003E";
// iterate obj
;(function(){
  var $$obj = obj;
  if ('number' == typeof $$obj.length) {
      for (var k = 0, $$l = $$obj.length; k < $$l; k++) {
        var v = $$obj[k];
pug_html = pug_html + "\u003Cli\u003E";
pug_mixins["jsondump"](v);
pug_html = pug_html + "\u003C\u002Fli\u003E";
      }
  } else {
    var $$l = 0;
    for (var k in $$obj) {
      $$l++;
      var v = $$obj[k];
pug_html = pug_html + "\u003Cli\u003E";
pug_mixins["jsondump"](v);
pug_html = pug_html + "\u003C\u002Fli\u003E";
    }
  }
}).call(this);

pug_html = pug_html + "\u003C\u002Fol\u003E";
}
}
else
if (typeof obj === 'object') {
// iterate obj
;(function(){
  var $$obj = obj;
  if ('number' == typeof $$obj.length) {
      for (var k = 0, $$l = $$obj.length; k < $$l; k++) {
        var v = $$obj[k];
if (obj.hasOwnProperty(k)) {
pug_html = pug_html + "\u003Cdiv class=\"indent\"\u003E\u003Cb" + (pug_attr("class", pug_classes(["ico",k], [false,true]), false, false)) + "\u003E" + (pug_escape(null == (pug_interp = k) ? "" : pug_interp)) + ": \u003C\u002Fb\u003E ";
pug_mixins["jsondump"](v);
pug_html = pug_html + "\u003C\u002Fdiv\u003E";
}
      }
  } else {
    var $$l = 0;
    for (var k in $$obj) {
      $$l++;
      var v = $$obj[k];
if (obj.hasOwnProperty(k)) {
pug_html = pug_html + "\u003Cdiv class=\"indent\"\u003E\u003Cb" + (pug_attr("class", pug_classes(["ico",k], [false,true]), false, false)) + "\u003E" + (pug_escape(null == (pug_interp = k) ? "" : pug_interp)) + ": \u003C\u002Fb\u003E ";
pug_mixins["jsondump"](v);
pug_html = pug_html + "\u003C\u002Fdiv\u003E";
}
    }
  }
}).call(this);

}
else {
pug_html = pug_html + (pug_escape(null == (pug_interp = obj) ? "" : pug_interp));
}
}
};
pug_mixins["slide"] = pug_interp = function(cve){
var block = (this && this.block), attributes = (this && this.attributes) || {};
pug_html = pug_html + "\u003Cdiv class=\"page wht shd pad2 gap\"\u003E\u003Cb class=\"slidetitle\"\u003E";
if (cve.source && cve.source.advisory) {
pug_html = pug_html + (pug_escape(null == (pug_interp = cve.source.advisory) ? "" : pug_interp)) + "             ";
}
pug_html = pug_html + (pug_escape(null == (pug_interp = cve.cveMetadata.title + ' (' + cve.cveMetadata.cveId + ')') ? "" : pug_interp)) + "\u003C\u002Fb\u003E\u003Cul class=\"bullets\"\u003E\u003Cli\u003E\u003Cb class=\"term\"\u003ECVSS: \u003C\u002Fb\u003E\u003C!--span.textif cna.metrics && cna.metrics && cna.metrics.length \u003E 0\n    ol\n        each x, i in cna.metrics\n            - cvss = x.cvssV3_1 ? x.cvssV3_1 : x.cvssV3_0 ? x.cvssV3_0 : x.cvssV2_0 ? x.cvssV2_0 : null\n            if cvss\n                li \n                    =x.scenarios\n                    if cvss.baseSeverity\n                        =cvss.baseSeverity\n                    |  \n                    +CVSS(cvss)--\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cb class=\"term\"\u003EPR: \u003C\u002Fb\u003E\u003Cspan class=\"text\"\u003E" + (pug_escape(null == (pug_interp = cve.source.defect) ? "" : pug_interp)) + "\u003C\u002Fspan\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cb class=\"term\"\u003EAffects: \u003C\u002Fb\u003E\u003C!--span.text= getProductAffected(cna) --\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cb class=\"term\"\u003EProblem Type: \u003C\u002Fb\u003E\u003Cspan class=\"text\"\u003E";
pug_mixins["spara"](cve.description.description_data.slice(0,1));
if (cmap && Object.keys(cmap).length > 0 && cmap.constructor === Object) {
pug_mixins["spara"](cve.CNA_private.CVE_table_description);
// iterate cmap
;(function(){
  var $$obj = cmap;
  if ('number' == typeof $$obj.length) {
      for (var id = 0, $$l = $$obj.length; id < $$l; id++) {
        var x = $$obj[id];
pug_html = pug_html + (pug_escape(null == (pug_interp = id + " ") ? "" : pug_interp));
      }
  } else {
    var $$l = 0;
    for (var id in $$obj) {
      $$l++;
      var x = $$obj[id];
pug_html = pug_html + (pug_escape(null == (pug_interp = id + " ") ? "" : pug_interp));
    }
  }
}).call(this);

}
pug_html = pug_html + "\u003C\u002Fspan\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cb class=\"term\"\u003EWorkaround: \u003C\u002Fb\u003E\u003Cspan class=\"text\"\u003E";
pug_mixins["spara"](cve.work_around);
pug_html = pug_html + "\u003C\u002Fspan\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cb class=\"term\"\u003ESolution: \u003C\u002Fb\u003E\u003Cspan class=\"text\"\u003E";
pug_mixins["spara"](cve.solution);
pug_html = pug_html + "\u003C\u002Fspan\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003C\u002Fdiv\u003E";
};
pug_mixins["page"] = pug_interp = function(d){
var block = (this && this.block), attributes = (this && this.attributes) || {};
pug_html = pug_html + "\u003Cstyle\u003E .affectedCol {border: 4px solid #fa582d}\ntable.striped {border-spacing: 0; border: 1px solid #c1c1c1; border-collapse: collapse;}\ntable.striped th { text-align:center;background-color: #f0f0f0;}{}\ntable.striped td {padding:5px;border: 1px solid #aaa}\u003C\u002Fstyle\u003E\u003Cdiv class=\"pad\"\u003E";
var cve = {}, con = {};
Object.assign(cve, d);
var CDM = cve.cveMetadata;
if (cve.containers) {
    Object.assign(con, cve.containers.cna)
};
//var jsonClone = {};
//delete con.json;
//con.json = jsonClone;
//delete con.json.x_legacyV4Record;
//con.x_ValidationErrors = cve.x_ValidationErrors;
con.state = CDM.state;
con.cveId = CDM.cveId;
var PMD = cve.containers.cna.providerMetadata;
con.dateUpdated = PMD.dateUpdated;
con.shortName = PMD.shortName;
var title = con.title;
var sourceText = {"INTERNAL":"This issue was found during internal product security testing or research.", "EXTERNAL":"This issue was discovered during an external security research.", "USER":"This issue was seen during production usage.", "UNKNOWN":""};
var cveId = CDM.cveId.match("^CVE-[0-9-]+$") ? CDM.cveId : 'CVE-yyyy-nnnn';
con.cvssList = [];
con.pvstatus = con.affected ? versionStatusTable5(con.affected) : null;
if ((con.metrics && con.metrics.length > 0)) {
// iterate con.metrics
;(function(){
  var $$obj = con.metrics;
  if ('number' == typeof $$obj.length) {
      for (var i = 0, $$l = $$obj.length; i < $$l; i++) {
        var x = $$obj[i];
var cvss = x.cvssV3_1 ? x.cvssV3_1 : x.cvssV3_0 ? x.cvssV3_0 : x.cvssV2_0 ? x.cvssV2_0 : null;
if (cvss) {
var cvssdup = {};
Object.assign(cvssdup, cvss);
cvssdup.scenarios = x.scenarios;
con.cvssList.push(cvssdup);
}
      }
  } else {
    var $$l = 0;
    for (var i in $$obj) {
      $$l++;
      var x = $$obj[i];
var cvss = x.cvssV3_1 ? x.cvssV3_1 : x.cvssV3_0 ? x.cvssV3_0 : x.cvssV2_0 ? x.cvssV2_0 : null;
if (cvss) {
var cvssdup = {};
Object.assign(cvssdup, cvss);
cvssdup.scenarios = x.scenarios;
con.cvssList.push(cvssdup);
}
    }
  }
}).call(this);

}
pug_mixins["container"](con);
pug_html = pug_html + "\u003C\u002Fdiv\u003E";
};
pug_html = pug_html + "\u003Cdiv class=\"big\"\u003E" + (pug_escape(null == (pug_interp = doc_id) ? "" : pug_interp)) + "\u003C\u002Fdiv\u003E";
if (doc) {
if (renderTemplate == 'default') {
delete doc._id;
pug_mixins["page"](doc);
}
else
if (renderTemplate != undefined) {
try {
{
pug_mixins[renderTemplate](doc);
}
} catch(e) {
{
delete doc._id;
pug_mixins["page"](doc);
}
}
}
}
else {
pug_html = pug_html + "\u003Cdiv class=\"tred\"\u003EDocument not found\u003C\u002Fdiv\u003E";
}
    }.call(this, "Array" in locals_for_with ?
        locals_for_with.Array :
        typeof Array !== 'undefined' ? Array : undefined, "Date" in locals_for_with ?
        locals_for_with.Date :
        typeof Date !== 'undefined' ? Date : undefined, "JSON" in locals_for_with ?
        locals_for_with.JSON :
        typeof JSON !== 'undefined' ? JSON : undefined, "Object" in locals_for_with ?
        locals_for_with.Object :
        typeof Object !== 'undefined' ? Object : undefined, "URL" in locals_for_with ?
        locals_for_with.URL :
        typeof URL !== 'undefined' ? URL : undefined, "cmap" in locals_for_with ?
        locals_for_with.cmap :
        typeof cmap !== 'undefined' ? cmap : undefined, "doc" in locals_for_with ?
        locals_for_with.doc :
        typeof doc !== 'undefined' ? doc : undefined, "doc_id" in locals_for_with ?
        locals_for_with.doc_id :
        typeof doc_id !== 'undefined' ? doc_id : undefined, "encodeURIComponent" in locals_for_with ?
        locals_for_with.encodeURIComponent :
        typeof encodeURIComponent !== 'undefined' ? encodeURIComponent : undefined, "isNaN" in locals_for_with ?
        locals_for_with.isNaN :
        typeof isNaN !== 'undefined' ? isNaN : undefined, "renderTemplate" in locals_for_with ?
        locals_for_with.renderTemplate :
        typeof renderTemplate !== 'undefined' ? renderTemplate : undefined, "versionStatusTable5" in locals_for_with ?
        locals_for_with.versionStatusTable5 :
        typeof versionStatusTable5 !== 'undefined' ? versionStatusTable5 : undefined));
    ;;return pug_html;}</script><script>var custom_validators = [function (schema, value, path) {
            var errors = [];
            if (schema.id == "desc") {
                if((value.value == "")) {
                    value = {}
                } else if(value.value.match("^\s+$") || value.value.length < 10) {
                    errors.push({
                        path: path,
                        property: 'format',
                        message: 'Valid description required'
                    });
                }
            }
            if(schema.id == "pE") {
                if((value.vendor != undefined && value.product != undefined) || (value.collectionURL != undefined && value.packageName != undefined)) {
                    // it is valid
                } else {
                    if (value.vendor == undefined && value.product != undefined) {
                        errors.push({
                            path: path+'.vendor',
                            property: 'format',
                            message: 'Enter vendor name'
                        });
                    } else if (value.product == undefined && value.vendor != undefined) {
                        errors.push({
                            path: path+'.product',
                            property: 'format',
                            message: 'Enter product name'
                        });
                    } else if (value.collectionURL == undefined && value.packageName != undefined) {
                        errors.push({
                            path: path+'.collectionURL',
                            property: 'format',
                            message: 'Enter a URL for the package collection'
                        });
                    } else if (value.packageName == undefined && value.collectionURL != undefined) {
                        errors.push({
                            path: path+'.packageName',
                            property: 'format',
                            message: 'Enter package name'
                        });
                    } else {
                        errors.push({
                            path: path,
                            property: 'format',
                            message: 'Enter a vendor and product OR a package and a collection'
                        });
                    }
                }
                /*
                p v c pkg
                0 0 0 0 = vendor or pkg needed
                0 0 0 1 = c needed
                0 0 1 0 = pkg needed
                0 0 1 1 = ok
                0 1 0 0 = prod needed
                0 1 0 1 = p or c needed
                0 1 1 0 = product or pkg needed
                0 1 1 1 = ok
                1 0 0 0 = vendor needed
                1 0 0 1 = vendor or collection url needed
                1 0 1 0 = v or pkg needed
                1 0 1 1 = ok
                1 1 0 0 = ok
                1 1 0 1 = ok
                1 1 1 0 = ok
                1 1 1 1 = ok
                */
            }
            if(schema.id == "vE") {
                if(value.lessThan != undefined && value.lessThanOrEqual != undefined) {
                    /*errors.push({
                        path: path+'.lessThan',
                        property: 'format',
                        message: 'Enter either lessThan or lessThanOrEqual, but not both'
                    });*/
                    errors.push({
                        path: path+'.lessThanOrEqual',
                        property: 'format',
                        message: 'Enter either < v or <= v, but not both'
                    });
                }
                if(value.version != undefined && (value.version == value.lessThan)) {
                    errors.push({
                        path: path+'.lessThan',
                        property: 'format',
                        message: 'End is same as the start'
                    });
                }
                if(value.version != undefined && (value.version == value.lessThanOrEqual)) {
                    errors.push({
                        path: path+'.lessThanOrEqual',
                        property: 'format',
                        message: 'End is same as the start'
                    });
                }
                if((value.lessThan != undefined || value.lessThanOrEqual != undefined) && value.versionType == undefined) {
                    errors.push({
                        path: path+'.versionType',
                        property: 'format',
                        message: 'Version type is required for ranges'
                    });
                }
                /*if(value.lessThan == undefined && value.lessThanOrEqual == undefined && value.version != undefined && value.versionType != undefined) {
                    errors.push({
                        path: path+'.versionType',
                        property: 'format',
                        message: 'Version type is used only for ranges. Clear this or define a range'
                    });
                }*/
                if(value.version != undefined && (value.version == value.lessThan)) {
                    errors.push({
                        path: path+'.lessThan',
                        property: 'format',
                        message: 'Version can\'t be same as lessThan'
                    });
                }
                if(value.lessThan == undefined && value.lessThanOrEqual == undefined && value.version != undefined && value.changes != undefined) {
                    errors.push({
                        path: path+'.changes',
                        property: 'format',
                        message: 'Changes are used only for ranges. Clear this or define a range'
                    });
                }
            }
            if(schema.id == "xtag") {
                if(value && schema.items && schema.items.examples) {
                    for(i = 0; i < value.length; i++) {
                        if(value[i] && !schema.items.examples.includes(value[i]) && !value[i].match("^x_.*$")) {
                            errors.push({
                                path: path,
                                property: 'format',
                                message: 'Select from the suggested tags or enter custom tags starting with x_'
                            });
                            break;
                        }
                    }
                }
            }
            if(schema.id == "description") { // check for bad descriptions
                if(value && value[0]
                    && value[0].value.match(/\[(PROBLEMTYPE|COMPONENT|VENDOR|PRODUCT|VERSION|PLATFORMS|ATTACKER|IMPACT|VECTOR)\]/)) {
                    errors.push({
                        path: path,
                        property: 'format',
                        message: 'Replace the placeholders in the template.'
                    });
                };
            }
            if (schema.id == "datePublic") {
                if(value && (new Date(value) > new Date())) {
                    errors.push({
                        path: path,
                        property: 'format',
                        message: 'Date is in the future!'
                    });
                }
            }
            return errors;
        }];</script><script type="module">import {CVSS40} from '/static/vulnogram/static/cvss40.js';
window.CVSS40 = CVSS40;</script><script>//
// CVE.js
// Filename: cve.js
//
// Author: Ben Nott <pajexali@gmail.com>
//
// Description: Exposes MITRE CVE API through CveServices using Service Worker
// middleware for credential storage and request handling.
//
// Copyright 2022, Ben Nott <pajexali@gmail.com>.
// See LICENSE for a full copy of the license.
//

(function (root, factory) {
    if (typeof define === 'function' && define.amd) {
        // AMD. Register as an anonymous module.
        define([], factory);
    } else if (typeof module === 'object' && module.exports) {
        // Node. Does not work with strict CommonJS, but
        // only CommonJS-like environments that support module.exports,
        // like Node.
        module.exports = factory();
    } else {
        // Browser globals (root is window)
        root.returnExports = factory();
    }
}(typeof self !== 'undefined' ? self : this, function () {

    class NoCredentialsError extends Error {};

    class CredentialError extends Error {};

    class MiddlewareError extends Error {};

    class CveServices {
        constructor(serviceUri = 'https://cveawg.mitre.org/api', swPath = 'sw.js') {
            //console.log('called constructer');
            this._middleware = new CveServicesMiddleware(serviceUri, swPath);
            //this._request = null;
            //this._channels = [];
        }

        // Session mgmt

        login(user, org, key) {
            //console.log('called login');
            return this._middleware.setCredentials({ user, org, key });
        }

        logout() {
            //console.log("Called logout");
            return this._middleware.destroy();
        }

        active() {
            return this._middleware ? true : false;
        }

        // Inter-instance communication.

        on(chanName) {
            return new Promise(resolve => {
                let bc = new BroadcastChannel(chanName);
                bc.onmessage = msg => {
                    resolve(msg.data);
                };
            });
        }

        // API methods

        getCveIds(args) {
            return this._middleware.get('cve-id', args);
        };

        reserveCveIds(args) {
            return this._middleware.post('cve-id', args);
        }

        reserveCveId(year = new Date().getFullYear()) {
            return this._middleware.orgName
                       .then(orgName => {
                           let args = {
                               amount: 1,
                               cve_year: year,
                               short_name: orgName,
                           };

                           return this.reserveCveIds(args);
                       });
        }

        reserveSeqCveIds(n = 1, year = new Date().getFullYear()) {
            return this._middleware.orgName
                .then(orgName => {
                    let args = {
                        amount: n,
                        cve_year: year,
                        short_name: orgName,
                        batch_type: 'sequential',
                    };

                    return this.reserveCveIds(args);
                });
        }

        reserveNonSeqCveIds(n = 1, year = new Date().getFullYear()) {
            return this._middleware.orgName
                .then(orgName => {
                    let args = {
                        amount: n,
                        cve_year: year,
                        short_name: orgName,
                        batch_type: 'nonsequential',
                    };

                    return this.reserveCveIds(args);
                });
        }

        getCveId(id) {
            return this._middleware.get('cve-id/'.concat(id));
        }

        updateCveId(id, state, org = undefined) {
            let record = { state };

            if (org)
                record['org'] = org;

            return this._middleware.put('cve-id/'.concat(id), record);
        }

        getCves(opts) {
            let query;

            if (opts) {
                query = {};
                if (opts.hasOwnProperty('state'))
                    query['cveState'] = opts.state;
                if(opts.hasOwnProperty('modBefore'))
                    query['cveRecordFilteredTimeModifiedLt'] = opts.modBefore;
                if(opts.hasOwnProperty('modAfter'))
                    query['cveRecordFilteredTimeModifiedGt'] = opts.modAfter;
                if(opts.hasOwnProperty('count'))
                    query['countOnly'] = 1;
                if (opts.hasOwnProperty('assignerShort'))
                    query['assignerShortName'] = opts.assignerShort;
                if (opts.hasOwnProperty('assigner'))
                    query['assigner'] = opts.assigner;
            }

            return this._middleware.get('cve', query);
        }

        getCve(id) {
            return this._middleware.get('cve/'.concat(id));
        }

        createCve(id, schema) {
            return this._middleware.post('cve/'.concat(id, '/cna'), undefined, schema);
        }

        updateCve(id, schema) {
            return this._middleware.put('cve/'.concat(id, '/cna'), undefined, schema);
        }

        createRejectedCve(id, schema) {
            return this._middleware.post('cve/'.concat(id, '/reject'), undefined, schema);
        }

        updateRejectedCve(id, schema) {
            return this._middleware.put('cve/'.concat(id, '/reject'), undefined, schema);
        }

        getOrg() {
            return this._middleware.orgName.then(orgName => orgName);
        }

        getOrgInfo() {
            return this._middleware.orgName
                .then(orgName =>
                    this._middleware.get('org/'.concat(orgName)));
        }

        updateOrgInfo(orgInfo) {
            return this._middleware.orgName
                .then(orgName =>
                    this._middleware.get('org/'.concat(orgName), orgInfo));
        }

        createOrgUser(userInfo) {
            return this._middleware.orgName
                .then(orgName =>
                    this._middleware.post(`org/${orgName}/user`, undefined, userInfo));
        }

        updateOrgUser(username, userInfo) {
            return this._middleware.orgName
                .then(orgName =>
                    this._middleware.put(`org/${orgName}/user/${username}`, userInfo, undefined));
        }

        resetOrgUserApiKey(username) {
            return this._middleware.orgName
                .then(orgName =>
                    this._middleware.put(`org/${orgName}/user/${username}/reset_secret`));
        }

        getOrgUsers() {
            return this._middleware.orgName
                .then(orgName =>
                    this._middleware.get(`org/${orgName}/users`));
        }

        getOrgIdQuota() {
            return this._middleware.orgName
                .then(orgName =>
                    this._middleware.get(`org/${orgName}/id_quota`));
        }

        getOrgUser(username) {
            return this._middleware.orgName
                .then(orgName =>
                    this._middleware.get(`org/${orgName}/user/${username}`));
        }
    };

    class CveServicesMiddleware {
        constructor(serviceUri = 'https://cveawg.mitre.org/api', swPath = 'sw.js') {
            this.serviceUri = serviceUri;
            this.registration;
            this.swPath = swPath;

            if (!('serviceWorker' in navigator)) {
                throw MiddlewareError("Service Workers are not available in your browser.");
            }
        }

        get worker() {
            let serviceUri = this.serviceUri;

            let initWorker = (worker) => {
                let init_msg = { type: 'init',
                                serviceUri };

                this.simpleMessage(worker, init_msg);
            };

            if (this.registration) {
                initWorker(this.registration.active);
                return Promise.resolve(this.registration.active);
            }

            return navigator.serviceWorker.register(this.swPath)
                .then(reg => {
                    this.registration = reg;

                    if (reg.installing != undefined) {
                        return new Promise(resolve => {
                            let worker = reg.installing;

                            worker.addEventListener('statechange', (e) => {
                                if (e.target.state == 'activated') {
                                    initWorker(e.target);
                                    resolve(e.target);
                                }
                            });
                        });
                    } else {
                        initWorker(reg.active);
                        return reg.active;
                    }
                });
        }

        simpleMessage(worker, msg) {
            return new Promise(resolve => {
                let channel = new MessageChannel();

                channel.port1.onmessage = (msg) => {
    		    if('debug' in msg)
                        console.log(msg);
                    resolve(msg.data);
                };

                worker.postMessage(msg, [channel.port2]);
            }, reject => {
                worker.onmessageerror = reject;
            });
        }

        send(msg) {
            return this.worker.then(worker => {
                return this.simpleMessage(worker, msg).then(res => {
                    if(typeof res === 'object' && 'error' in res) {
                        return Promise.reject(res);
                    } else {
                        return res;
                    }
                });
            });
        }

        serviceRequest(request) {
            let msg = {
                type: 'request',
                ...request,
            };

            return this.send(msg);
        }

        echo() {
            return this.send({type: 'echo'});
        }

        setCredentials(creds) {
            let msg = {
                type: 'login',
                creds,
            };

            return this.send(msg);
        }

        get(path, query) {
            let req = {
                method: 'GET',
                path, query
            };

            return this.serviceRequest(req);
        }

        post(path, query, body) {
            let req = {
                method: 'POST',
                path, query, body
            };

            return this.serviceRequest(req);
        }

        put(path, query, body) {
            let req = {
                method: 'PUT',
                path, query, body
            };

            return this.serviceRequest(req);
        }

        get orgName() {
            let msg = {
                type: 'getOrg',
            };
            var o = this.send(msg);
            return o;
        }

        destroy() {
            // Broadcast logout event
            let bc = new BroadcastChannel('logout');
            bc.postMessage({'error': 'LOGOUT', message: 'The user has logged out'});
            if (this.registration) {
                //this.send({type: 'destroy'});
                this.registration.unregister();
                this.registration = undefined;

                return Promise.resolve(true);
            } else {
                return Promise.resolve(false);
            }
        }
    }

    if (window != undefined) {
        window.CveServices = CveServices;
        window.CveServicesMiddleware = CveServicesMiddleware;
    }

    return CveServices;
}));
<!--include csaf.js-->//CVE Services Client and Portal GUI

var csClient = undefined;

var csCache = {
    portalType: 'production',
    url: 'https://cveawg.mitre.org/api',
    org: null,
    user: null,
    orgInfo: null
}

async function initCsClient() {
    if ('serviceWorker' in navigator) {
        try {
            if (window.localStorage.getItem('cveApi')) {
                csCache = JSON.parse(window.localStorage.getItem('cveApi'));
            }
            if (!csCache.url) {
                csCache.url = 'https://cveawg.mitre.org/api';
            }
            csClient = new CveServices(csCache.url, "/static/vulnogram/static/cve5sw.js");
            listenforLogins();
            listenforLogouts();
            if (!csCache.user) {
                showPortalLogin();
                return;
            }
            await showPortalView();
        } catch (e) {
            portalErrorHandler(e);
        }
    } else {
        document.getElementById('port').innerHTML = '<h2 class="pad2 tred">Browser does not support Service Workers feature required for this tab.</h2><i class="indent pad2">Are you using Firefox in Private mode? Try normal mode.</i>';
//        console.log("Browser does not support Service Workers. Are you using Firefox in Private mode?")
        //cveShowError('Browser not supported!');
    }
}

function showPortalLogin(message) {
    let prevPortalType = window.localStorage.getItem('portalType');
    let prevPortalUrl = window.localStorage.getItem('portalUrl');
    if (!prevPortalType || !prevPortalUrl) {
      // ensure consistency if either value is missing from localStorage by setting both to default
      prevPortalType = 'production';
      prevPortalUrl = 'https://cveawg.mitre.org/api';
    }
    csCache = {
        portalType: prevPortalType,
        url: prevPortalUrl,
        org: null,
        user: null,
        orgInfo: null
    }
    window.localStorage.removeItem('cveApi');

    document.getElementById('port').innerHTML = cveRender({
        ctemplate: 'cveLoginBox',
        message: message,
        prevPortal: prevPortalType,
        prevOrg: window.localStorage.getItem('shortName')
    })
}

async function portalLogout(message) {
    if (csClient != null) {
        await csClient.logout();
    }
    showPortalLogin(message);
}

async function showPortalView(orgInfo, userInfo) {
    try {
        if (!orgInfo) {
            orgInfo = await csClient.getOrgInfo();
        }
        if (!userInfo) {
            userInfo = await csClient.getOrgUser(csCache.user);
        }
        document.getElementById('port').innerHTML = cveRender({
            portalType: csCache.portalType,
            portalURL: csCache.url,
            ctemplate: 'portal',
            userInfo: userInfo,
            org: orgInfo
        });
        var button1 = document.getElementById('post1');
        if(button1) {
            if(csCache.portalType == 'test') {
                button1.innerText = 'Post to Test Portal'
            } else {
                button1.innerText = 'Post to CVE.org'
            }
        }
        var button2 = document.getElementById("post2")
        if(button2) {
            if(csCache.portalType == 'test') {
                button2.innerText = 'Post to Test Portal'
            } else {
                button2.innerText = 'Post to CVE.org';
            }
        }
        return await cveGetList();
    } catch (e) {
        portalErrorHandler(e);
    }
}

var loginChannel = new BroadcastChannel("login");
var logoutChannel = new BroadcastChannel("logout");

function listenforLogins() {
    loginChannel.onmessage = function (a) {
        initCsClient();
    }
}
function listenforLogouts() {
    logoutChannel.onmessage = function (a) {
        showPortalLogin(a.message);
    }
}

async function portalLogin(elem, credForm) {
    try {
        if (!'serviceWorker' in navigator) {
            cveShowError('Browser is missing required features. Try a different browser or the normal mode.')
            return (false);
        }
        if (!credForm.checkValidity()) {
            return (false);
        }
        elem.preventDefault();
        var url = credForm.portal.value;
        var portalType = credForm.portal.options[credForm.portal.selectedIndex].text;
        if (csClient && csCache.url != url) {
            csClient = new CveServices(url, "/static/vulnogram/static/cve5sw.js");
        }
        var ret = await csClient.login(
            credForm.user.value,
            credForm.org.value,
            credForm.key.value);


        var orgInfo = await csClient.getOrgInfo();
        var userInfo = await csClient.getOrgUser(credForm.user.value);

        csCache.user = credForm.user.value;
        csCache.org = credForm.org.value;
        csCache.url = url;
        csCache.portalType = portalType;
        csCache.orgInfo = orgInfo;

        window.localStorage.setItem('cveApi', JSON.stringify(csCache));
        window.localStorage.setItem('portalType', portalType);
        window.localStorage.setItem('portalUrl', url);
        window.localStorage.setItem('shortName', credForm.org.value);

        if (ret == 'ok' || ret.data == "ok") {
            csCache.keyUrl = ret.keyUrl;
            await showPortalView(orgInfo, userInfo);
            /* Add one hour session timeout in addition to timeout in serviceWorker */
            setTimeout(portalLogout, defaultTimeout);
            //announce to others that a login happened.
            loginChannel.postMessage({ message: 'The user has logged in' });

        } else {
            document.getElementById("loginErr").innerText = 'Failed to login: Possibly invalid credentials!';
        }
    } catch (e) {
        portalErrorHandler(e);
    }
}

function resetPortalLoginErr() {
    //console.log('changed form');
    document.getElementById("loginErr").innerText = '';
}


function portalErrorHandler(e) {
    if (e.error && (e.error == 'NO_SESSION' || e.error == 'UNAUTHORIZED' || e.error.message == 'Failed to fetch')) {
        if (e.error == 'UNAUTHORIZED') {
            e.message = "Valid credentials required",
            mainTabGroup.focus(3);
        }
        if (e.error.message == 'Failed to fetch') {
            e.message = "Error connecting to service";
        }
        if (document.getElementById("loginErr")) {
            // Login screen exists
            document.getElementById("loginErr").innerText = e && e.message ? e.message : 'Valid credentials required!';
        } else {
            showPortalLogin(e.message);
        }
    } else {
        cveShowError(e);
    }
}

async function userlistUpdate(elem, event) {
    if (elem.open) {
        document.getElementById("userStatsPopup").open = false;
        try {
            var ret = await csClient.getOrgUsers();
            var userlist = document.getElementById('userlist');
            if (userlist) {
                userlist.innerHTML = cveRender({
                    ctemplate: 'listUsers',
                    users: ret.users
                })
            }
        } catch (e) {
            portalErrorHandler(e);
        }
    }
}

async function cveUserKeyReset(elem, confirm) {
    var u = elem.form.u.value;
    var temp1 = document.getElementById("alertOk");
    if (confirm) {
        temp1.setAttribute("onclick", "document.getElementById('alertDialog').close();");
        elem.removeAttribute('id');
        document.getElementById('alertDialog').close();
    } else {
        showAlert("Are you sure?", "A new API key will be generated for user " + u + "! The old API key will no longer work!", undefined, true);
        let randid = Math.random().toString(32).substring(2);
        elem.setAttribute('id', randid);
        temp1.setAttribute('u', u);
        temp1.setAttribute('onclick', 'cveUserKeyReset(document.getElementById("' + randid + '"),true)');
        return;
    }
    try {
        var ret = await csClient.resetOrgUserApiKey(u);
        if (ret["API-secret"]) {
            var msg = "API Key was reset for " + u + "!";
            if (csCache.user == u) {
                msg += " You will need to login again with the new key!";
                portalLogout();
            }
            document.getElementById("userMessage").innerText = msg;
            document.getElementById("secretDialogForm").pass.value = ret["API-secret"];
            document.getElementById("secretDialogForm").pass.type = "password";
            document.getElementById("secretDialog").showModal();
        }
    } catch (e) {
        portalErrorHandler(e);
    }
}

async function cveUpdateUser(f) {
    try {
        params = {
            "name.first": f.first.value,
            "name.last": f.last.value
        };
        if (f.u.value != f.new_username.value) {
            params.new_username = f.new_username.value
        }
        if (csCache.user != f.u.value) {
            params.active = f.active.checked;
            if (f.admin.checked) {
                params["active_roles.add"] = 'ADMIN'
            } else {
                params["active_roles.remove"] = 'ADMIN'
            }
        }

        var ret = await csClient.updateOrgUser(f.u.value, params);
        if (ret.updated) {
            document.getElementById("userEditDialog").close();
            if (document.getElementById("userListPopup")) {
                userlistUpdate(document.getElementById("userListPopup"));
            }
            //the current user is updating self
            if ((csCache.user == f.u.value) && document.getElementById("cveUser")) {
                if (csCache.user != ret.updated.username) {
                    cveShowError({ error: 'Username changed!', message: 'Username successfully changed to ' + ret.updated.username + '! You will need to login again!' });
                    portalLogout();
                    return;
                }
                document.getElementById("cveUser").innerHTML =
                    cveRender({
                        ctemplate: 'userstats',
                        userInfo: ret.updated,
                        org: await csClient.getOrgInfo()
                    })
            }
        }
    } catch (e) {
        cveShowError(e);
    }
}

function removeErrors() {
    Array.from(document.getElementsByClassName('formError')).forEach(x => x.remove());
}

function addError(el) {
    var div = document.createElement('div');
    div.classList.add('formError');
    div.innerHTML = "Please provide a valid data";
    div.setAttribute('onclick', 'this.remove(); return false;');
    el.setAttribute('onfocus', 'removeErrors()');
    el.after(div);
}

function validateForm(f) {
    let isvalid = true;
    f.elements.forEach(x => {
        if (!isvalid)
            return;
        /* Needed is an alias for required to avoid showing
           red boxes unless a submit event is initiated. */
        if (x.getAttribute("needed"))
            x.setAttribute("required", "required");
        if ('validity' in x) {
            if ('valid' in x.validity) {
                isvalid = x.validity.valid;
                if (!isvalid)
                    addError(x);
            }
        }
    });
    return isvalid;
}

async function cveUserEdit(elem) {
    f = document.getElementById('userEditForm');
    f.u.value = elem.getAttribute('u');
    f.new_username.value = elem.getAttribute('u');
    f.first.value = elem.getAttribute('f');
    f.last.value = elem.getAttribute('l');
    f.admin.checked = elem.getAttribute('ad') ? true : false;
    f.active.checked = elem.getAttribute('ac') ? true : false;
    if (csCache.user == f.u.value) {
        if (!elem.getAttribute('ad')) {
            f.new_username.disabled = true;
        }
        f.admin.parentElement.setAttribute('class', 'hid');
        f.admin.setAttribute('disabled', true);
        f.active.setAttribute('disabled', true);
    } else {
        f.admin.parentElement.removeAttribute('class');
        f.admin.removeAttribute('disabled');
        f.active.removeAttribute('disabled');
    }
    document.getElementById('userEditDialog').showModal();
}

async function cveAddUser(f) {
    if (validateForm(f)) {
        try {
            const userFields = {
                "username": f.new_username.value,
                "name": {
                    "first": f.first.value,
                    "last": f.last.value
                },
                "authority": {
                    "active_roles": []
                }
            }
            if (f.admin.checked) {
              userFields.authority.active_roles.push("ADMIN")
            }
            var ret = await csClient.createOrgUser(userFields);
            if (ret.created && ret.created.secret) {
                document.getElementById('userAddDialog').close();
                document.getElementById("secretDialogForm").pass.value = ret.created.secret;
                document.getElementById("secretDialogForm").pass.type = "password";
                document.getElementById("secretDialog").showModal();
                document.getElementById("userMessage").innerText = ret.message;
                f.reset()
                userlistUpdate({ open: true });
            }
        } catch (e) {
            portalErrorHandler(e);
        }

    } else {
        cveShowError('Please provide valid information!');
    }
}

async function cveOrgUpdate() {
    cveShowError('To be done');
}

async function cveRenderList(l, refreshEditor) {
    if (l && document.getElementById('cveList')) {
        document.getElementById('cveList').innerHTML = cveRender({
            ctemplate: 'listIds',
            cveIds: l,
            editable: true//(csCache.portalType == 'test')
        })
        if (l.length > 0) {
            new Tablesort(document.getElementById('cveListTable'));
        }
        if (refreshEditor) {
            docSchema.definitions.cveId.examples = l.map(i => i.cve_id);
            editorSetCveDatalist(l);
        }
        var editableList = document.getElementById('editablelist');
        if (editableList) {
            editableList.innerHTML = cveRender({
                ctemplate: 'editables',
                cveIds: l
            })
        }
    }
}

async function editorSetCveDatalist(l) {
    document.getElementById('root.cveMetadata.cveId-datalist').innerHTML = cveRender({
        ctemplate: 'reserveds',
        cveIds: l
    })
}

function paginate(a) {
    let el = document.getElementById('cvePage');
    if (!el) {
        //console.log("Error cannot find template ");
        //console.log(a);
        return false;
    }
    let cp = parseInt(el.getAttribute('data-page'));
    if (isNaN(cp)) {
        //console.log("The data-page element is not pareable ");
        //console.log(cp);
        return galse;
    }
    let np = cp + parseInt(a);
    var cveForm = document.getElementById("cvePortalFilter");
    cveForm.page = np;
    cveGetList();
    return false;
}

//var collator = new Intl.Collator(undefined, {numeric: true});
async function pageShow(ret) {
    let el = document.getElementById('cvePage');
    if (!el) {
        //console.log("Error cannot find template ");
        //console.log(ret);
        return;
    }
    el.style.display = 'block';
    el.setAttribute('data-page', ret.currentPage);
    let start = (ret.currentPage - 1) * ret.itemsPerPage + 1;
    let end = start + ret.itemsPerPage - 1;
    let total = ret.totalCount;
    if (end > total)
        end = total;
    document.getElementById('cvePageInfo').innerHTML = "Showing " +
        String(start) + " to " + String(end) + " of " +
        String(total) + " records "
    document.getElementById('currentPage').innerHTML = ret.currentPage
    if (ret.prevPage)
        document.getElementById('prevPage').style.display = 'block';
    else
        document.getElementById('prevPage').style.display = 'none';
    if (ret.nextPage)
        document.getElementById('nextPage').style.display = 'block';
    else
        document.getElementById('nextPage').style.display = 'none';
}

async function cveShowError(err) {
    if ((err.error == 'UNAUTHORIZED' || err.error == 'NO_SESSION' || csClient == null || await csClient._middleware.worker == null)) {
        err.message = 'Login required';
        showPortalLogin();
        mainTabGroup.focus(3);
    }
    document.getElementById('cveErrors').innerHTML = cveRender({
        ctemplate: 'cveErrors',
        err: err
    })
    document.getElementById('cveErrorsModal').showModal();
}

async function cveGetList() {
    var currentReserved = true;
    var filter = {
        state: 'RESERVED',
        cve_id_year: currentYear
    }
    var cveForm = document.getElementById("cvePortalFilter");
    if (cveForm) {
        if (cveForm.fstate) {
            if (cveForm.fstate.value) {
                filter.state = cveForm.fstate.value + '';
                if (filter.state != 'RESERVED') {
                    currentReserved = false;
                }
            } else {
                delete filter.state;
            }
        }
        if (cveForm.y) {
            filter.cve_id_year = cveForm.y.value + '';
            if (filter.cve_id_year != currentYear) {
                currentReserved = false;
            }
        }
        if (cveForm.page) {
            filter.page = cveForm.page;
        }
    }
    if (document.getElementById('cveList')) {
        document.getElementById('cveList').innerHTML = '<center><div class="spinner"></div></center>';
    }
    try {
        var ret = await csClient.getCveIds(filter);
        if (ret.error) {
            cveShowError(ret);
        } else {
            var idList = [];
            var idState = {};
            if (ret && ret.cve_ids) {
                idList = ret.cve_ids;
                idList = idList.sort((b, a) => (a.reserved > b.reserved) ? 1 : ((b.reserved > a.reserved) ? -1 : 0));
                for (var i = 0; i < idList.length; i++) {
                    idState[idList[i].cve_id] = idList[i].state;
                }
            }
            cveRenderList(idList, currentReserved);
            if (ret && (ret.nextPage || ret.prevPage)) {
                pageShow(ret);
            } else {
                let el = document.getElementById('cvePage');
                if (el) {
                    el.removeAttribute('data-page');
                    el.style.display = 'none';
                }
                if (cveForm)
                    cveForm.page = 0;
            }
            return idList;
        }
    } catch (e) {
        cveShowError(e);
        cveRenderList([]);
        return ([]);
    }
}

async function cveReserve(yearOffset, number) {
    var year = currentYear + (yearOffset ? yearOffset : 0);
    try {
        var args = {
            amount: number > 0 && number <= 50 ? number : 1,
            // Request only one at this time to get four digits! Requesting more at time gives the 5 digit ids.
            // batch_type: 'nonsequential',
            cve_year: year,
            short_name: csCache.org
        };
        if (number > 1) {
            args.batch_type = 'sequential';
        }
        var json = await csClient.reserveCveIds(args);
        return json.cve_ids;
    } catch (e) {
        cveShowError(e.message);
    }
}

async function cveSelectLoad(event) {
    event.preventDefault();
    try {
        cveLoad(event.target.elements.id.value)
    } catch (e) {
        portalErrorHandler(e);
        cveShowError('Please login to CVE Portal. Your session may have expired!');
    }
    return false;
}


async function cveLoad(cveId) {
    try {
        var res = await csClient.getCve(cveId);
        if (res.cveMetadata) {
            if (res.containers) {
                res = cveFixForVulnogram(res);
            } else {
                console.log('no containers');
            }
            var edOpts = (res.cveMetadata.state == 'REJECTED') ? rejectEditorOption : publicEditorOption;
            loadJSON(res, cveId, "Loaded " + cveId + " from CVE.org!", edOpts);

            mainTabGroup.change(0);
            return res;
        } else {
            errMsg.textContent = "Failed to load valid CVE Record";
            infoMsg.textContent = "";
        }
    } catch (e) {
        if (e == '404' || e.error == 'CVE_RECORD_DNE') {
            var skeleton = {
                "cveMetadata": {
                    "cveId": cveId,
                    "assigner": csCache.orgInfo ? csCache.orgInfo.UUID : "",
                }
            };
            try {
                var res = await csClient.getCveId(cveId);
                var edOpts = publicEditorOption;
                if (res.state == 'RESERVED') {
                    skeleton.cveMetadata.state = "PUBLISHED";
                } else if (res.state == 'REJECTED') {
                    skeleton.cveMetadata.state = "REJECTED";
                    edOpts = rejectEditorOption;
                } else {
                    return {};
                }

                loadJSON(skeleton, cveId, "Loaded " + cveId, edOpts);
                mainTabGroup.change(0);
                return skeleton;
            } catch (e2) {
                if (e2 == '404') {
                    showAlert('CVE Not found!');
                }
            }
        } else {
            //console.log(e);
            portalErrorHandler(e);
        }
    }
}

async function cveReject(elem, event) {
    var id = elem.getAttribute('data');
    if (window.confirm('Do you want to reject ' + id + '? It cannot be undone!')) {
        try {
            var ret = await csClient.updateCveId(id, 'REJECTED', csCache.org);
            if (ret.updated && ret.updated.state == 'REJECTED') {
                var m = document.getElementById("cveStatusMessage");
                m.innerText = "Rejected " + id;
                await cveGetList();
            }
        } catch (e) {
            portalErrorHandler(e);
        }
    }
}
function transatePath(p) {
    if(p) {
        p = p.replace("/cnaContainer", "root.containers.cna");
        p = p.replaceAll('/', '.');
    }
    return p;
}
async function cvePost() {
    if (docEditor.validation_results && docEditor.validation_results.length == 0) {
        /*if (save != undefined) {
            await save();
        }*/
        try {
            //if (csCache.portalType === 'test') {
                //console.log('uploading...');
                var j = await mainTabGroup.getValue();
                var j = textUtil.reduceJSON(j);
                /*var pts = j.containers.cna.problemTypes;
                if(pts && pts.length == 1 && pts[0].descriptions && pts[0].descriptions[0].description == undefined) {
                    delete j.containers.cna.problemTypes;
                }
                var ims = j.containers.cna.impacts;
                if(ims && ims.length == 1 && ims[0].descriptions && ims[0].descriptions[0].value == undefined) {
                    delete j.containers.cna.impacts;
                }*/
                var ret = null;
                try {
                    var latestId = await csClient.getCveId(j.cveMetadata.cveId);
                    if (latestId.state == 'RESERVED') {
                        //console.log('Creating');
                        if (j.cveMetadata.state == 'PUBLISHED') {
                            ret = await csClient.createCve(j.cveMetadata.cveId, { cnaContainer: j.containers.cna });
                        } else if (j.cveMetadata.state == 'REJECTED') {
                            ret = await csClient.createRejectedCve(j.cveMetadata.cveId, { cnaContainer: j.containers.cna });
                        }
                    } else {
                        //console.log('uploading');
                        if (j.cveMetadata.state == 'PUBLISHED') {
                            ret = await csClient.updateCve(j.cveMetadata.cveId, { cnaContainer: j.containers.cna });
                        } else if (j.cveMetadata.state == 'REJECTED') {
                            ret = await csClient.updateRejectedCve(j.cveMetadata.cveId, { cnaContainer: j.containers.cna });
                        }
                    }
                } catch (e) {
                    //console.log('Got error');
                    //console.log(e);
                    if (e.error) {
                        infoMsg.innerText = "";
                        var alertMessage = "";
                        if (e.details && e.details.errors) {
                            showJSONerrors(e.details.errors.map(
                                a => {
                                    alertMessage = alertMessage + ', ' + a.message;
                                    return ({
                                        path: transatePath(a.instancePath),
                                        message: a.message
                                    });
                                }
                            ));
                        } else if (e.error == 'UNAUTHORIZED') {
                            cveShowError(e);
                        }
                    } else {
                        showAlert('Error publishing! Got error ' + e)
                    }
                }
                //console.log(ret);
                if (ret != null && ret.message) {
                    showAlert("CVE Record is Published", ret.message, 10000);
                    var a = document.createElement('a');
                    a.setAttribute('href', (csCache.portalType == 'test'? 'https://test.cve.org/cverecord?id=' :  'https://www.cve.org/cverecord?id=')+j.cveMetadata.cveId);
                    a.setAttribute('target', '_blank');
                    a.innerText = ret.message;
                    infoMsg.innerText = '';
                    infoMsg.appendChild(a);
                    hideJSONerrors();
                }
            //} else {
            //    showAlert('CVE posting is not currently supported by production CVE services! Try Logging to Test Portal instance');
            //}
        } catch (e) {
            portalErrorHandler(e);
        }
    } else {
        showAlert('Please fix errors before posting');
    }
}

async function cveReserveAndRender(yearOffset, number) {
    try {
        var r = await cveReserve(yearOffset, number);
        var m = document.getElementById("cveStatusMessage");
        if (m && r && r.length > 0) {
            m.innerText = "Got " + r.map(x => x.cve_id).join(', ');
        } else {
            m.innerText = "Failed to get a CVE ID";
        }
        cvePortalFilter.reset();
        await cveGetList();
        return r;
    } catch (e) {
        portalErrorHandler(e);
    }
}
</script><script>function pug_attr(t,e,n,r){if(!1===e||null==e||!e&&("class"===t||"style"===t))return"";if(!0===e)return" "+(r?t:t+'="'+t+'"');var f=typeof e;return"object"!==f&&"function"!==f||"function"!=typeof e.toJSON||(e=e.toJSON()),"string"==typeof e||(e=JSON.stringify(e),n||-1===e.indexOf('"'))?(n&&(e=pug_escape(e))," "+t+'="'+e+'"'):" "+t+"='"+e.replace(/'/g,"&#39;")+"'"}
function pug_classes(s,r){return Array.isArray(s)?pug_classes_array(s,r):s&&"object"==typeof s?pug_classes_object(s):s||""}
function pug_classes_array(r,a){for(var s,e="",u="",c=Array.isArray(a),g=0;g<r.length;g++)(s=pug_classes(r[g]))&&(c&&a[g]&&(s=pug_escape(s)),e=e+u+s,u=" ");return e}
function pug_classes_object(r){var a="",n="";for(var o in r)o&&r[o]&&pug_has_own_property.call(r,o)&&(a=a+n+o,n=" ");return a}
function pug_escape(e){var a=""+e,t=pug_match_html.exec(a);if(!t)return e;var r,c,n,s="";for(r=t.index,c=0;r<a.length;r++){switch(a.charCodeAt(r)){case 34:n="&quot;";break;case 38:n="&amp;";break;case 60:n="&lt;";break;case 62:n="&gt;";break;default:continue}c!==r&&(s+=a.substring(c,r)),c=r+1,s+=n}return c!==r?s+a.substring(c,r):s}
var pug_has_own_property=Object.prototype.hasOwnProperty;
var pug_match_html=/["&<>]/;function cveRender(locals) {var pug_html = "", pug_mixins = {}, pug_interp;;
    var locals_for_with = (locals || {});

    (function (Date, Math, Object, cl, con, ctemplate, cveIds, editable, err, isNaN, message, name, obj, org, portalType, prevOrg, prevPortal, t, userInfo, users) {
      pug_mixins["cveLoginBox"] = pug_interp = function(){
var block = (this && this.block), attributes = (this && this.attributes) || {};
pug_html = pug_html + "\u003Cdiv class=\"sec shd rnd pad\" id=\"cpBox\"\u003E\u003Cdiv id=\"cpLogo\"\u003E\u003Cimg width=\"100%\" src=\"\u002Fstatic\u002Fvulnogram\u002Fstatic\u002FCVE.svg\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cdiv id=\"cpTitle\"\u003E\u003Cb\u003ECVE Services Portal \u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003Ci\u003EInstantly providing you CVE IDs since 2022\u003C\u002Fi\u003E\u003C\u002Fdiv\u003E\u003Cdiv id=\"cpPrompt\"\u003E\u003Cdiv id=\"loginErr\"\u003E" + (pug_escape(null == (pug_interp = message) ? "" : pug_interp)) + "\u003C\u002Fdiv\u003E\u003Cform id=\"cveLoginForm\" method=\"POST\" onclick=\"resetPortalLoginErr();\" onkeypress=\"resetPortalLoginErr();\" onchange=\"resetPortalLoginErr();\" onsubmit=\"portalLogin(event, this); return false;\"\u003E\u003Clabel class=\"lbl vgi-globe\" for=\"cpPortal\"\u003EPortal\u003C\u002Flabel\u003E\u003Cselect class=\"bor txt\" id=\"cpPortal\" name=\"portal\"\u003E\u003Coption" + (" value=\"https:\u002F\u002Fcveawg.mitre.org\u002Fapi\""+pug_attr("selected", (prevPortal == 'production'), true, false)) + "\u003Eproduction\u003C\u002Foption\u003E\u003Coption" + (" value=\"https:\u002F\u002Fcveawg-test.mitre.org\u002Fapi\""+pug_attr("selected", (prevPortal == 'test'), true, false)) + "\u003Etest\u003C\u002Foption\u003E\u003Coption" + (" value=\"https:\u002F\u002Fcveawg-adp-test.mitre.org\u002Fapi\""+pug_attr("selected", (prevPortal == 'adp-test'), true, false)) + "\u003Eadp-test\u003C\u002Foption\u003E\u003Coption" + (" value=\"http:\u002F\u002F127.0.0.1:3000\u002Fapi\""+pug_attr("selected", (prevPortal == 'local'), true, false)) + "\u003Elocal\u003C\u002Foption\u003E\u003C\u002Fselect\u003E\u003Clabel class=\"lbl vgi-org\" for=\"cpOrg\"\u003ECNA Short Name\u003C\u002Flabel\u003E\u003Cinput" + (" class=\"bor txt\""+" id=\"cpOrg\" name=\"org\" type=\"text\" autocomplete=\"on\" pattern=\".{2,64}\" required=\"required\""+pug_attr("value", prevOrg?prevOrg:'', true, false)) + "\u002F\u003E\u003Clabel class=\"lbl vgi-user\" for=\"cpUser\"\u003ECVE User\u003C\u002Flabel\u003E\u003Cinput class=\"bor txt\" id=\"cpUser\" name=\"user\" type=\"text\" autocomplete=\"on\" pattern=\".+\" required=\"required\"\u002F\u003E\u003Clabel class=\"lbl vgi-key\" for=\"cpKey\"\u003ECNA API Key\u003C\u002Flabel\u003E\u003Cinput class=\"bor txt\" id=\"cpKey\" name=\"key\" type=\"password\" autocomplete=\"off\" required=\"required\"\u002F\u003E\u003Cinput class=\"bor fbn sfe vgi-export\" id=\"cpSubmit\" type=\"submit\" value=\"Login\"\u002F\u003E\u003C\u002Fform\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E";
};
pug_mixins["dlgHeader"] = pug_interp = function(icon, msg){
var block = (this && this.block), attributes = (this && this.attributes) || {};
pug_html = pug_html + "\u003Cheader class=\"ban sec pad\" style=\"min-width:20em;\"\u003E\u003Cb" + (pug_attr("class", pug_classes(["lbl",icon], [false,true]), false, false)) + "\u003E" + (pug_escape(null == (pug_interp = msg) ? "" : pug_interp)) + "\u003C\u002Fb\u003E \u003Ca class=\"sbn right vgi-fail\" onclick=\"this.closest('dialog').close()\"\u003E\u003C\u002Fa\u003E\u003C\u002Fheader\u003E";
};
pug_mixins["cveErrors"] = pug_interp = function(){
var block = (this && this.block), attributes = (this && this.attributes) || {};
pug_mixins["dlgHeader"]('vgi-alert', typeof err == 'string' ? 'Error' : err.error);
pug_html = pug_html + "\u003Ccenter class=\"pad2\"\u003E";
if (typeof err == 'string') {
pug_html = pug_html + "\u003Cb class=\"gap\"\u003E" + (pug_escape(null == (pug_interp = err) ? "" : pug_interp)) + "\u003C\u002Fb\u003E";
}
else {
pug_html = pug_html + "\u003Ch3\u003E" + (pug_escape(null == (pug_interp = err.message) ? "" : pug_interp)) + "\u003C\u002Fh3\u003E";
if (err.details) {
pug_html = pug_html + "\u003Col class=\"gap\"\u003E";
// iterate err.details
;(function(){
  var $$obj = err.details;
  if ('number' == typeof $$obj.length) {
      for (var i = 0, $$l = $$obj.length; i < $$l; i++) {
        var d = $$obj[i];
pug_html = pug_html + "\u003Cli\u003E" + (pug_escape(null == (pug_interp = d.location) ? "" : pug_interp)) + "\u002F   " + (pug_escape(null == (pug_interp = d.param) ? "" : pug_interp)) + ":  " + (pug_escape(null == (pug_interp = d.msg) ? "" : pug_interp)) + "\u003C\u002Fli\u003E";
      }
  } else {
    var $$l = 0;
    for (var i in $$obj) {
      $$l++;
      var d = $$obj[i];
pug_html = pug_html + "\u003Cli\u003E" + (pug_escape(null == (pug_interp = d.location) ? "" : pug_interp)) + "\u002F   " + (pug_escape(null == (pug_interp = d.param) ? "" : pug_interp)) + ":  " + (pug_escape(null == (pug_interp = d.msg) ? "" : pug_interp)) + "\u003C\u002Fli\u003E";
    }
  }
}).call(this);

pug_html = pug_html + "\u003C\u002Fol\u003E";
}
}
pug_html = pug_html + "\u003C\u002Fcenter\u003E";
};
pug_mixins["portal"] = pug_interp = function(){
var block = (this && this.block), attributes = (this && this.attributes) || {};
var y = new Date().getFullYear()
var nextY = y+1
pug_html = pug_html + "\u003Cheader class=\"pad ban sec\"\u003E\u003Cdiv class=\"left\"\u003E\u003Clabel class=\"vgi-globe lbl\"\u003EPortal: " + (pug_escape(null == (pug_interp = portalType) ? "" : pug_interp)) + "\u003C\u002Flabel\u003E\u003Cspan class=\"btg rnd\"\u003E\u003Cbutton class=\"btn vgi-magic\" onclick=\"cveReserveAndRender(0)\"\u003EReserve One CVE\u003C\u002Fbutton\u003E\u003Cdetails class=\"popup\"\u003E\u003Csummary class=\"btn t9\"\u003E▼\u003C\u002Fsummary\u003E\u003Cdl class=\"pop wht bor rnd shd rows\"\u003E\u003Cdiv class=\"gap\"\u003E\u003Cdt class=\"flx\"\u003E\u003Cbutton class=\"btn vgi-magic\" onclick=\"cveReserveAndRender(0, 5)\" style=\"min-width:6em\"\u003EReserve  5\u003C\u002Fbutton\u003E\u003Cbutton class=\"right sbn vgi-fail\" onclick=\"this.closest('details').removeAttribute('open')\"\u003E    \u003C\u002Fbutton\u003E\u003C\u002Fdt\u003E\u003Cdt\u003E\u003Cbutton class=\"btn vgi-magic\" onclick=\"cveReserveAndRender(0, 10)\" style=\"min-width:6em\"\u003EReserve 10\u003C\u002Fbutton\u003E\u003C\u002Fdt\u003E\u003Cdt\u003E \u003Cbutton class=\"btn vgi-magic\" onclick=\"cveReserveAndRender(1)\"\u003EReserve one for the year " + (pug_escape(null == (pug_interp = y+1) ? "" : pug_interp)) + "\u003C\u002Fbutton\u003E\u003C\u002Fdt\u003E\u003Cdt\u003E\u003Cbutton class=\"btn vgi-magic\" onclick=\"cveReserveAndRender(-1)\"\u003EReserve one for the year " + (pug_escape(null == (pug_interp = y-1) ? "" : pug_interp)) + "\u003C\u002Fbutton\u003E\u003C\u002Fdt\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdl\u003E\u003C\u002Fdetails\u003E\u003C\u002Fspan\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"flx\"\u003E\u003Clabel id=\"cveUser\"\u003E";
pug_mixins["userstats"]();
pug_html = pug_html + "\u003C\u002Flabel\u003E";
if (userInfo && userInfo.authority && userInfo.authority.active_roles && userInfo.authority.active_roles.includes("ADMIN")) {
pug_html = pug_html + "\u003Clabel id=\"userMgmt\"\u003E";
pug_mixins["usermgmt"]();
pug_html = pug_html + "\u003C\u002Flabel\u003E";
}
pug_html = pug_html + "\u003C\u002Fdiv\u003E\u003C\u002Fheader\u003E\u003Cdiv class=\"pad\" id=\"cveStatusMessage\"\u003E\u003C\u002Fdiv\u003E\u003Cform class=\"gap\" id=\"cvePortalFilter\" onchange=\"cveGetList();\"\u003E\u003Cdiv class=\"lbl\"\u003EShow\u003C\u002Fdiv\u003E\u003Cdiv class=\"rdg\"\u003E\u003Cdiv class=\"form-control\"\u003E\u003Cinput class=\"hid\" id=\"chkall\" type=\"radio\" name=\"fstate\" value=\"\"\u002F\u003E\u003Clabel class=\"lbl vgi-misc\" for=\"chkall\"\u003EAll\u003C\u002Flabel\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"form-control\"\u003E\u003Cinput class=\"hid\" id=\"chkres\" type=\"radio\" name=\"fstate\" value=\"RESERVED\" checked=\"checked\"\u002F\u003E\u003Clabel class=\"lbl vgi-tag\" for=\"chkres\"\u003EReserved\u003C\u002Flabel\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"form-control\"\u003E\u003Cinput class=\"hid\" id=\"chkpub\" type=\"radio\" name=\"fstate\" value=\"PUBLISHED\"\u002F\u003E\u003Clabel class=\"lbl vgi-globe\" for=\"chkpub\"\u003EPublished\u003C\u002Flabel\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"form-control\"\u003E\u003Cinput class=\"hid\" id=\"chkrej\" type=\"radio\" name=\"fstate\" value=\"REJECTED\"\u002F\u003E\u003Clabel class=\"lbl vgi-no\" for=\"chkrej\"\u003ERejected\u003C\u002Flabel\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"lbl\"\u003EYear\u003C\u002Fdiv\u003E\u003Cselect class=\"lbl txt\" name=\"y\"\u003E\u003Coption" + (pug_attr("value", nextY, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = nextY) ? "" : pug_interp)) + "\u003C\u002Foption\u003E\u003Coption" + (pug_attr("value", y, true, false)+pug_attr("selected", true, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = y) ? "" : pug_interp)) + "\u003C\u002Foption\u003E";
var i = y-1
while (i > 1998) {
pug_html = pug_html + "\u003Coption" + (pug_attr("value", i, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = i) ? "" : pug_interp)) + "\u003C\u002Foption\u003E";
i--;
}
pug_html = pug_html + "\u003C\u002Fselect\u003E \u003Cbutton class=\"btn vgi-reuse\" onclick=\"event.preventDefault();cveGetList();return false;\"\u003EGo\u003C\u002Fbutton\u003E\u003C\u002Fform\u003E\u003Cdiv class=\"gap\" id=\"cvePage\"\u003E\u003Cdiv class=\"rdg\"\u003E\u003Cdiv class=\"lbl\" id=\"cvePageInfo\"\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"form-control\"\u003E\u003Cbutton class=\"lbl\" id=\"prevPage\" onclick=\"paginate(-1)\"\u003E&#8249;\u003C\u002Fbutton\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"form-control\"\u003E\u003Cdiv class=\"lbl\" id=\"currentPage\"\u003E1\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"form-control\"\u003E\u003Cbutton class=\"lbl\" id=\"nextPage\" onclick=\"paginate(1)\"\u003E&#8250;\u003C\u002Fbutton\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"gap\" id=\"cveList\"\u003E\u003C\u002Fdiv\u003E";
};
pug_mixins["userstats"] = pug_interp = function(){
var block = (this && this.block), attributes = (this && this.attributes) || {};
pug_html = pug_html + "\u003Cdetails class=\"popup popup\" id=\"userStatsPopup\" ontoggle=\"if(this.open &amp;&amp; (u = document.getElementById('userListPopup'))) u.open = false;\"\u003E\u003Csummary class=\"fbn vgi-user\"\u003E" + (pug_escape(null == (pug_interp = ((userInfo && userInfo.name && userInfo.name.first) ? userInfo.name.first : userInfo.username)) ? "" : pug_interp)) + " ▼ \u003C\u002Fsummary\u003E\u003Cdl class=\"pop wht bor rnd shd pad\"\u003E\u003Cdiv class=\"gap row\"\u003E\u003Cbutton class=\"right sbn vgi-fail\" onclick=\"this.closest('details').removeAttribute('open')\"\u003E    \u003C\u002Fbutton\u003E\u003C\u002Fdiv\u003E";
pug_mixins["userDetail"](userInfo);
pug_html = pug_html + "\u003Chr class=\"bort\"\u002F\u003E\u003Cspan" + (" class=\"vgi-edit fbn\""+" onclick=\"cveUserEdit(this)\""+pug_attr("u", userInfo.username, true, false)+pug_attr("f", userInfo.name?userInfo.name.first:'', true, false)+pug_attr("l", userInfo.name?userInfo.name.last:'', true, false)+pug_attr("ac", userInfo.active, true, false)+pug_attr("ad", userInfo.authority.active_roles.includes('ADMIN'), true, false)+" title=\"Edit Info\"") + "\u003EUpdate my details\u003C\u002Fspan\u003E\u003Chr class=\"bort\"\u002F\u003E\u003Cdt\u003EOrg:  \u003Cb\u003E" + (pug_escape(null == (pug_interp = org ? org.name : 'undefined') ? "" : pug_interp)) + "\u003C\u002Fb\u003E\u003C\u002Fdt\u003E\u003Cdt\u003EShortName:  \u003Cb\u003E" + (pug_escape(null == (pug_interp = org ? org.short_name : 'undefined') ? "" : pug_interp)) + "\u003C\u002Fb\u003E\u003C\u002Fdt\u003E\u003Cdt\u003ERole:  \u003Cb\u003E" + (pug_escape(null == (pug_interp = org && org.authority ? org.authority.active_roles : 'undefined') ? "" : pug_interp)) + "\u003C\u002Fb\u003E\u003C\u002Fdt\u003E\u003Chr class=\"bort\"\u002F\u003E\u003Cspan class=\"vgi-exit fbn\" onclick=\"portalLogout()\"\u003ELogout!\u003C\u002Fspan\u003E\u003C\u002Fdl\u003E\u003C\u002Fdetails\u003E";
};
pug_mixins["userDetail"] = pug_interp = function(u){
var block = (this && this.block), attributes = (this && this.attributes) || {};
pug_html = pug_html + "\u003Ca" + (" class=\"td\""+" onclick=\"cveUserEdit(this)\""+pug_attr("u", u.username, true, false)+pug_attr("f", u.name?u.name.first:'', true, false)+pug_attr("l", u.name?u.name.last:'', true, false)+pug_attr("ac", u.active, true, false)+pug_attr("ad", u.authority.active_roles.includes('ADMIN'), true, false)+" title=\"Edit Info\"") + "\u003E\u003Cb\u003E" + (pug_escape(null == (pug_interp = u.name?u.name.first:'') ? "" : pug_interp)) + " " + (pug_escape(null == (pug_interp = u.name?u.name.last:'') ? "" : pug_interp)) + "\u003C\u002Fb\u003E\u003Ci" + (pug_attr("class", pug_classes(["sicn",u.authority.active_roles.includes('ADMIN')? 'vgi-king' : 'vgi-cap'], [false,true]), false, false)+pug_attr("title", u.authority.active_roles.includes('ADMIN')?'Admin':'Regular User', true, false)) + "\u003E\u003C\u002Fi\u003E\u003Ci" + (pug_attr("class", pug_classes(["sicn",u.active?'vgi-ok':'vgi-no'], [false,true]), false, false)+pug_attr("title", u.active? 'active': 'inactive', true, false)) + "\u003E\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\u003Csmall\u003E" + (pug_escape(null == (pug_interp = u.username) ? "" : pug_interp)) + "\u003C\u002Fsmall\u003E\u003C\u002Fa\u003E";
};
pug_mixins["listUsers"] = pug_interp = function(){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (users) {
// iterate users
;(function(){
  var $$obj = users;
  if ('number' == typeof $$obj.length) {
      for (var i = 0, $$l = $$obj.length; i < $$l; i++) {
        var u = $$obj[i];
pug_html = pug_html + "\u003Cdiv class=\"tr\"\u003E";
pug_mixins["userDetail"](u);
pug_html = pug_html + "\u003C\u002Fdiv\u003E";
      }
  } else {
    var $$l = 0;
    for (var i in $$obj) {
      $$l++;
      var u = $$obj[i];
pug_html = pug_html + "\u003Cdiv class=\"tr\"\u003E";
pug_mixins["userDetail"](u);
pug_html = pug_html + "\u003C\u002Fdiv\u003E";
    }
  }
}).call(this);

}
};
pug_mixins["usermgmt"] = pug_interp = function(){
var block = (this && this.block), attributes = (this && this.attributes) || {};
pug_html = pug_html + "\u003Cdetails class=\"popup\" id=\"userListPopup\" ontoggle=\"userlistUpdate(this, event)\"\u003E\u003Csummary class=\"fbn vgi-cog\"\u003EUsers ▼ \u003C\u002Fsummary\u003E\u003Cdiv class=\"pop wht bor rnd shd usermgmt\"\u003E\u003Cdiv class=\"gap row\"\u003E\u003Cbutton class=\"sfe btn vgi-magic\" onclick=\"document.getElementById('userAddDialog').showModal()\"\u003EAdd a user  \u003C\u002Fbutton\u003E\u003Cbutton class=\"right sbn vgi-fail\" onclick=\"this.closest('details').removeAttribute('open')\"\u003E    \u003C\u002Fbutton\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"tbl gap\"\u003E\u003Cdiv class=\"tbody\" id=\"userlist\"\u003E\u003Cdiv class=\"tr\"\u003E\u003Cdiv class=\"td\" colspan=\"6\"\u003E\u003Ccenter\u003E\u003Cdiv class=\"spinner\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fcenter\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E";
};
pug_mixins["htext"] = pug_interp = function(){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (t) {
// iterate t.split(/\n/)
;(function(){
  var $$obj = t.split(/\n/);
  if ('number' == typeof $$obj.length) {
      for (var pug_index2 = 0, $$l = $$obj.length; pug_index2 < $$l; pug_index2++) {
        var line = $$obj[pug_index2];
if (line) {
if (line.startsWith('  ')) {
pug_html = pug_html + "\u003Ccode\u003E" + (pug_escape(null == (pug_interp = line) ? "" : pug_interp)) + "\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E";
}
else {
pug_html = pug_html + "\u003Cp\u003E" + (pug_escape(null == (pug_interp = line) ? "" : pug_interp)) + "\u003C\u002Fp\u003E";
}
}
      }
  } else {
    var $$l = 0;
    for (var pug_index2 in $$obj) {
      $$l++;
      var line = $$obj[pug_index2];
if (line) {
if (line.startsWith('  ')) {
pug_html = pug_html + "\u003Ccode\u003E" + (pug_escape(null == (pug_interp = line) ? "" : pug_interp)) + "\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E";
}
else {
pug_html = pug_html + "\u003Cp\u003E" + (pug_escape(null == (pug_interp = line) ? "" : pug_interp)) + "\u003C\u002Fp\u003E";
}
}
    }
  }
}).call(this);

}
else {
pug_html = pug_html + "\u003Cp\u003E" + (pug_escape(null == (pug_interp = t) ? "" : pug_interp)) + "\u003C\u002Fp\u003E";
}
};
pug_mixins["date"] = pug_interp = function(value){
var block = (this && this.block), attributes = (this && this.attributes) || {};
var v = false;
if (value instanceof Date) { v = value;} else {
var timestamp = Date.parse(value);
v = isNaN(timestamp) ? false : new Date(timestamp)
}
if (v) {
var nowt = Date.now();
var vtime = v.getTime();
var delta = nowt-vtime;
var hidet = '';
if (Math.abs(delta) > 43000000) { hidet = 'hid';}
pug_html = pug_html + "\u003Cspan" + (pug_attr("class", pug_classes(["nobr","date",cl], [false,false,true]), false, false)+pug_attr("title", v.toString(), true, false)) + "\u003E" + (pug_escape(null == (pug_interp = v.toISOString().slice(0,10)) ? "" : pug_interp)) + "\u003Cspan" + (pug_attr("class", pug_classes(["nobr",hidet], [false,true]), false, false)) + "\u003E " + (pug_escape(null == (pug_interp = v.toLocaleTimeString("de-US", {hour:"2-digit", minute:"2-digit"})) ? "" : pug_interp)) + "\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E";
}
else {
pug_html = pug_html + (pug_escape(null == (pug_interp = obj[name]) ? "" : pug_interp));
}
};
pug_mixins["editables"] = pug_interp = function(){
var block = (this && this.block), attributes = (this && this.attributes) || {};
// iterate cveIds
;(function(){
  var $$obj = cveIds;
  if ('number' == typeof $$obj.length) {
      for (var pug_index3 = 0, $$l = $$obj.length; pug_index3 < $$l; pug_index3++) {
        var c = $$obj[pug_index3];
if (c.state == 'PUBLISHED') {
pug_html = pug_html + ("\u003Coption" + (pug_attr("value", c.cve_id, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = '🌐 Published on ') ? "" : pug_interp)));
pug_mixins["date"](c.time.modified);
pug_html = pug_html + "\u003C\u002Foption\u003E";
}
if (c.state == 'REJECTED') {
pug_html = pug_html + ("\u003Coption" + (pug_attr("value", c.cve_id, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = '⛔ Rejected on ') ? "" : pug_interp)));
pug_mixins["date"](c.time.modified);
pug_html = pug_html + "\u003C\u002Foption\u003E";
}
      }
  } else {
    var $$l = 0;
    for (var pug_index3 in $$obj) {
      $$l++;
      var c = $$obj[pug_index3];
if (c.state == 'PUBLISHED') {
pug_html = pug_html + ("\u003Coption" + (pug_attr("value", c.cve_id, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = '🌐 Published on ') ? "" : pug_interp)));
pug_mixins["date"](c.time.modified);
pug_html = pug_html + "\u003C\u002Foption\u003E";
}
if (c.state == 'REJECTED') {
pug_html = pug_html + ("\u003Coption" + (pug_attr("value", c.cve_id, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = '⛔ Rejected on ') ? "" : pug_interp)));
pug_mixins["date"](c.time.modified);
pug_html = pug_html + "\u003C\u002Foption\u003E";
}
    }
  }
}).call(this);

};
pug_mixins["reserveds"] = pug_interp = function(){
var block = (this && this.block), attributes = (this && this.attributes) || {};
// iterate cveIds
;(function(){
  var $$obj = cveIds;
  if ('number' == typeof $$obj.length) {
      for (var pug_index4 = 0, $$l = $$obj.length; pug_index4 < $$l; pug_index4++) {
        var c = $$obj[pug_index4];
if (c.state == 'RESERVED') {
pug_html = pug_html + "\u003Coption" + (pug_attr("value", c.cve_id, true, false)) + "\u003E\u003Ci\u003E" + (pug_escape(null == (pug_interp = '🏷️ Reserved by ' + c.requested_by.user) ? "" : pug_interp)) + "\u003C\u002Fi\u003E\u003C\u002Foption\u003E";
}
      }
  } else {
    var $$l = 0;
    for (var pug_index4 in $$obj) {
      $$l++;
      var c = $$obj[pug_index4];
if (c.state == 'RESERVED') {
pug_html = pug_html + "\u003Coption" + (pug_attr("value", c.cve_id, true, false)) + "\u003E\u003Ci\u003E" + (pug_escape(null == (pug_interp = '🏷️ Reserved by ' + c.requested_by.user) ? "" : pug_interp)) + "\u003C\u002Fi\u003E\u003C\u002Foption\u003E";
}
    }
  }
}).call(this);

};
pug_mixins["listIds"] = pug_interp = function(){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (cveIds && cveIds.length > 0) {
var stateIcons = {'RESERVED':'vgi-tag', 'PUBLISHED':'vgi-globe', 'REJECTED':'vgi-no', 'PUBLIC':'vgi-globe'}
pug_html = pug_html + "\u003Ctable class=\"tbl sortable\" id=\"cveListTable\"\u003E\u003Cthead\u003E\u003Ctr\u003E\u003Cth\u003EID\u003C\u002Fth\u003E\u003Cth\u003ERequester\u003C\u002Fth\u003E\u003Cth aria-sort=\"ascending\"\u003ECreated\u003C\u002Fth\u003E\u003Cth\u003EModified\u003C\u002Fth\u003E\u003Cth\u003EActions\u003C\u002Fth\u003E\u003C\u002Ftr\u003E\u003C\u002Fthead\u003E\u003Ctbody\u003E";
// iterate cveIds
;(function(){
  var $$obj = cveIds;
  if ('number' == typeof $$obj.length) {
      for (var pug_index5 = 0, $$l = $$obj.length; pug_index5 < $$l; pug_index5++) {
        var c = $$obj[pug_index5];
pug_html = pug_html + "\u003Ctr" + (pug_attr("data", c.state, true, false)) + "\u003E\u003Ctd\u003E";
if (editable) {
pug_html = pug_html + "\u003Ca" + (pug_attr("class", pug_classes([stateIcons[c.state]?stateIcons[c.state]:''], [true]), false, false)+pug_attr("href", "javascript:cveLoad('"+c.cve_id+"')", true, false)+pug_attr("title", 'Load ' + c.state + ' ' + c.cve_id + ' to edit', true, false)) + "\u003E" + (pug_escape(null == (pug_interp = c.cve_id) ? "" : pug_interp)) + "\u003C\u002Fa\u003E";
}
else {
pug_html = pug_html + "\u003Cspan" + (pug_attr("class", pug_classes([stateIcons[c.state]?stateIcons[c.state]:''], [true]), false, false)+pug_attr("title", c.state, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = c.cve_id) ? "" : pug_interp)) + "\u003C\u002Fspan\u003E";
}
if (c.state != 'RESERVED') {
pug_html = pug_html + "\u003Ca" + (" class=\"vgi-ext\""+pug_attr("href", "https://www.cve.org/CVERecord?id="+c.cve_id, true, false)+" target=\"_blank\"") + "\u003E\u003C\u002Fa\u003E";
}
pug_html = pug_html + "\u003C\u002Ftd\u003E\u003Ctd\u003E" + (pug_escape(null == (pug_interp = c.requested_by.user) ? "" : pug_interp)) + "\u003C\u002Ftd\u003E\u003Ctd\u003E";
pug_mixins["date"](c.time.created);
pug_html = pug_html + "\u003C\u002Ftd\u003E\u003Ctd\u003E";
if (c.time.modified != c.time.created) {
pug_mixins["date"](c.time.modified);
}
pug_html = pug_html + "\u003C\u002Ftd\u003E\u003Ctd\u003E";
if (editable) {
if (c.state == 'RESERVED') {
pug_html = pug_html + "\u003Ca" + (" class=\"vgi-cancel\""+pug_attr("data", c.cve_id, true, false)+" onclick=\"cveReject(this, event)\" title=\"Reject this CVE ID\"") + "\u003E&nbsp;\u003C\u002Fa\u003E";
}
else
if (c.state == 'PUBLISHED') {
pug_html = pug_html + "\u003Ca" + (" class=\"vgi-cancel\""+pug_attr("data", c.cve_id, true, false)+" onclick=\"showAlert('Rejecting published record', 'To reject this published record, open this in the editor, click the Reject ID button at the bottom')\" title=\"Reject this CVE ID!\"") + "\u003E&nbsp;\u003C\u002Fa\u003E";
}
else {
pug_html = pug_html + "\u003Ci class=\"vgi-no tgrey\" title=\"This ID is already rejected!\"\u003E&nbsp;\u003C\u002Fi\u003E";
}
}
pug_html = pug_html + "\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E";
      }
  } else {
    var $$l = 0;
    for (var pug_index5 in $$obj) {
      $$l++;
      var c = $$obj[pug_index5];
pug_html = pug_html + "\u003Ctr" + (pug_attr("data", c.state, true, false)) + "\u003E\u003Ctd\u003E";
if (editable) {
pug_html = pug_html + "\u003Ca" + (pug_attr("class", pug_classes([stateIcons[c.state]?stateIcons[c.state]:''], [true]), false, false)+pug_attr("href", "javascript:cveLoad('"+c.cve_id+"')", true, false)+pug_attr("title", 'Load ' + c.state + ' ' + c.cve_id + ' to edit', true, false)) + "\u003E" + (pug_escape(null == (pug_interp = c.cve_id) ? "" : pug_interp)) + "\u003C\u002Fa\u003E";
}
else {
pug_html = pug_html + "\u003Cspan" + (pug_attr("class", pug_classes([stateIcons[c.state]?stateIcons[c.state]:''], [true]), false, false)+pug_attr("title", c.state, true, false)) + "\u003E" + (pug_escape(null == (pug_interp = c.cve_id) ? "" : pug_interp)) + "\u003C\u002Fspan\u003E";
}
if (c.state != 'RESERVED') {
pug_html = pug_html + "\u003Ca" + (" class=\"vgi-ext\""+pug_attr("href", "https://www.cve.org/CVERecord?id="+c.cve_id, true, false)+" target=\"_blank\"") + "\u003E\u003C\u002Fa\u003E";
}
pug_html = pug_html + "\u003C\u002Ftd\u003E\u003Ctd\u003E" + (pug_escape(null == (pug_interp = c.requested_by.user) ? "" : pug_interp)) + "\u003C\u002Ftd\u003E\u003Ctd\u003E";
pug_mixins["date"](c.time.created);
pug_html = pug_html + "\u003C\u002Ftd\u003E\u003Ctd\u003E";
if (c.time.modified != c.time.created) {
pug_mixins["date"](c.time.modified);
}
pug_html = pug_html + "\u003C\u002Ftd\u003E\u003Ctd\u003E";
if (editable) {
if (c.state == 'RESERVED') {
pug_html = pug_html + "\u003Ca" + (" class=\"vgi-cancel\""+pug_attr("data", c.cve_id, true, false)+" onclick=\"cveReject(this, event)\" title=\"Reject this CVE ID\"") + "\u003E&nbsp;\u003C\u002Fa\u003E";
}
else
if (c.state == 'PUBLISHED') {
pug_html = pug_html + "\u003Ca" + (" class=\"vgi-cancel\""+pug_attr("data", c.cve_id, true, false)+" onclick=\"showAlert('Rejecting published record', 'To reject this published record, open this in the editor, click the Reject ID button at the bottom')\" title=\"Reject this CVE ID!\"") + "\u003E&nbsp;\u003C\u002Fa\u003E";
}
else {
pug_html = pug_html + "\u003Ci class=\"vgi-no tgrey\" title=\"This ID is already rejected!\"\u003E&nbsp;\u003C\u002Fi\u003E";
}
}
pug_html = pug_html + "\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E";
    }
  }
}).call(this);

pug_html = pug_html + "\u003C\u002Ftbody\u003E\u003C\u002Ftable\u003E";
}
else {
pug_html = pug_html + "\u003Ci class=\"gap2\"\u003ENo CVE IDs found! \u003C\u002Fi\u003E";
}
};
pug_mixins["autoText"] = pug_interp = function(){
var block = (this && this.block), attributes = (this && this.attributes) || {};
if (con) {
if (con.problemTypes) {
var pts = [];
// iterate con.problemTypes
;(function(){
  var $$obj = con.problemTypes;
  if ('number' == typeof $$obj.length) {
      for (var pug_index6 = 0, $$l = $$obj.length; pug_index6 < $$l; pug_index6++) {
        var t = $$obj[pug_index6];
if (t.descriptions) {
var prob = t.descriptions.map(x=>x.description).join(', ').replaceAll(/CWE-\d+/g,"").trim().replaceAll(/\s+/g, ' ');
if (prob) {
pts.push(prob);
}
}
      }
  } else {
    var $$l = 0;
    for (var pug_index6 in $$obj) {
      $$l++;
      var t = $$obj[pug_index6];
if (t.descriptions) {
var prob = t.descriptions.map(x=>x.description).join(', ').replaceAll(/CWE-\d+/g,"").trim().replaceAll(/\s+/g, ' ');
if (prob) {
pts.push(prob);
}
}
    }
  }
}).call(this);

if (pts.length > 0) {
pug_html = pug_html + (pug_escape(null == (pug_interp = pts.join(', ')) ? "" : pug_interp));
}
else {
pug_html = pug_html + "A";
}
}
pug_html = pug_html + " vulnerability";
var codelist = [];
var relevantList = [];
if (con.affected) {
var plist = [];
// iterate con.affected
;(function(){
  var $$obj = con.affected;
  if ('number' == typeof $$obj.length) {
      for (var pug_index7 = 0, $$l = $$obj.length; pug_index7 < $$l; pug_index7++) {
        var p = $$obj[pug_index7];
var pd = [p.vendor, p.vendor != p.product ? p.product : '', p.packageName != p.product ? p.packageName : '', (p.platforms ? 'on ' + p.platforms.join(', ') : ''), p.modules ? '(' + p.modules.join(', ') + ' modules)':''].join(' ').trim().replaceAll(/\s+/g, ' ')
var pn = p.product ? p.product : p.packageName;
if (pd) {
plist.push(pd);
}
if (p.versions) {
var vlist = [];
// iterate p.versions
;(function(){
  var $$obj = p.versions;
  if ('number' == typeof $$obj.length) {
      for (var pug_index8 = 0, $$l = $$obj.length; pug_index8 < $$l; pug_index8++) {
        var v = $$obj[pug_index8];
if (v.status == 'affected') {
if (v.lessThan) {
vlist.push ( (v.version != '0' ? ' from ' + v.version: '') + (v.lessThan != '*' ? ' before ' + v.lessThan:''));
}
else
if (v.lessThanOrEqual) {
vlist.push ( (v.version != '0' ? ' from ' + v.version: '') + (v.lessThanOrEqual != '*' ? ' through ' + v.lessThanOrEqual:''));
}
else
if (v.version != '0') {
vlist.push (' ' + v.version)
}
}
      }
  } else {
    var $$l = 0;
    for (var pug_index8 in $$obj) {
      $$l++;
      var v = $$obj[pug_index8];
if (v.status == 'affected') {
if (v.lessThan) {
vlist.push ( (v.version != '0' ? ' from ' + v.version: '') + (v.lessThan != '*' ? ' before ' + v.lessThan:''));
}
else
if (v.lessThanOrEqual) {
vlist.push ( (v.version != '0' ? ' from ' + v.version: '') + (v.lessThanOrEqual != '*' ? ' through ' + v.lessThanOrEqual:''));
}
else
if (v.version != '0') {
vlist.push (' ' + v.version)
}
}
    }
  }
}).call(this);

if ((vlist && vlist.length > 0)) {
relevantList.push(pn + ':' + vlist.join(','));
}
else
if (p.defaultStatus == 'affected') {
relevantList.push(pn);
}
}
      }
  } else {
    var $$l = 0;
    for (var pug_index7 in $$obj) {
      $$l++;
      var p = $$obj[pug_index7];
var pd = [p.vendor, p.vendor != p.product ? p.product : '', p.packageName != p.product ? p.packageName : '', (p.platforms ? 'on ' + p.platforms.join(', ') : ''), p.modules ? '(' + p.modules.join(', ') + ' modules)':''].join(' ').trim().replaceAll(/\s+/g, ' ')
var pn = p.product ? p.product : p.packageName;
if (pd) {
plist.push(pd);
}
if (p.versions) {
var vlist = [];
// iterate p.versions
;(function(){
  var $$obj = p.versions;
  if ('number' == typeof $$obj.length) {
      for (var pug_index9 = 0, $$l = $$obj.length; pug_index9 < $$l; pug_index9++) {
        var v = $$obj[pug_index9];
if (v.status == 'affected') {
if (v.lessThan) {
vlist.push ( (v.version != '0' ? ' from ' + v.version: '') + (v.lessThan != '*' ? ' before ' + v.lessThan:''));
}
else
if (v.lessThanOrEqual) {
vlist.push ( (v.version != '0' ? ' from ' + v.version: '') + (v.lessThanOrEqual != '*' ? ' through ' + v.lessThanOrEqual:''));
}
else
if (v.version != '0') {
vlist.push (' ' + v.version)
}
}
      }
  } else {
    var $$l = 0;
    for (var pug_index9 in $$obj) {
      $$l++;
      var v = $$obj[pug_index9];
if (v.status == 'affected') {
if (v.lessThan) {
vlist.push ( (v.version != '0' ? ' from ' + v.version: '') + (v.lessThan != '*' ? ' before ' + v.lessThan:''));
}
else
if (v.lessThanOrEqual) {
vlist.push ( (v.version != '0' ? ' from ' + v.version: '') + (v.lessThanOrEqual != '*' ? ' through ' + v.lessThanOrEqual:''));
}
else
if (v.version != '0') {
vlist.push (' ' + v.version)
}
}
    }
  }
}).call(this);

if ((vlist && vlist.length > 0)) {
relevantList.push(pn + ':' + vlist.join(','));
}
else
if (p.defaultStatus == 'affected') {
relevantList.push(pn);
}
}
    }
  }
}).call(this);

var ptext = plist.join(', ');
if (ptext) {
pug_html = pug_html + (" in " + (pug_escape(null == (pug_interp = ptext) ? "" : pug_interp)));
}
}
if (con.impacts) {
var ips = [];
// iterate con.impacts
;(function(){
  var $$obj = con.impacts;
  if ('number' == typeof $$obj.length) {
      for (var pug_index10 = 0, $$l = $$obj.length; pug_index10 < $$l; pug_index10++) {
        var t = $$obj[pug_index10];
if (t.descriptions) {
var impact = t.descriptions.map(x=>x.value).join(', ').replaceAll(/CAPEC-\d+/g, "").trim().replaceAll(/\s+/g, ' ')
if (impact) {
ips.push(impact);
}
}
      }
  } else {
    var $$l = 0;
    for (var pug_index10 in $$obj) {
      $$l++;
      var t = $$obj[pug_index10];
if (t.descriptions) {
var impact = t.descriptions.map(x=>x.value).join(', ').replaceAll(/CAPEC-\d+/g, "").trim().replaceAll(/\s+/g, ' ')
if (impact) {
ips.push(impact);
}
}
    }
  }
}).call(this);

if (ips.length > 0) {
pug_html = pug_html + (" allows " + (pug_escape(null == (pug_interp = ips.join(', ')) ? "" : pug_interp)));
}
}
pug_html = pug_html + ".";
if (con.affected) {
var fileSet = {};
var funcSet = {};
// iterate con.affected
;(function(){
  var $$obj = con.affected;
  if ('number' == typeof $$obj.length) {
      for (var pug_index11 = 0, $$l = $$obj.length; pug_index11 < $$l; pug_index11++) {
        var p = $$obj[pug_index11];
if (p.programFiles) {
// iterate p.programFiles
;(function(){
  var $$obj = p.programFiles;
  if ('number' == typeof $$obj.length) {
      for (var pug_index12 = 0, $$l = $$obj.length; pug_index12 < $$l; pug_index12++) {
        var pf = $$obj[pug_index12];
fileSet[pf] = 1
      }
  } else {
    var $$l = 0;
    for (var pug_index12 in $$obj) {
      $$l++;
      var pf = $$obj[pug_index12];
fileSet[pf] = 1
    }
  }
}).call(this);

}
if (p.programRoutines) {
// iterate p.programRoutines
;(function(){
  var $$obj = p.programRoutines;
  if ('number' == typeof $$obj.length) {
      for (var pug_index13 = 0, $$l = $$obj.length; pug_index13 < $$l; pug_index13++) {
        var fn = $$obj[pug_index13];
funcSet[fn.name] = 1
      }
  } else {
    var $$l = 0;
    for (var pug_index13 in $$obj) {
      $$l++;
      var fn = $$obj[pug_index13];
funcSet[fn.name] = 1
    }
  }
}).call(this);

}
      }
  } else {
    var $$l = 0;
    for (var pug_index11 in $$obj) {
      $$l++;
      var p = $$obj[pug_index11];
if (p.programFiles) {
// iterate p.programFiles
;(function(){
  var $$obj = p.programFiles;
  if ('number' == typeof $$obj.length) {
      for (var pug_index14 = 0, $$l = $$obj.length; pug_index14 < $$l; pug_index14++) {
        var pf = $$obj[pug_index14];
fileSet[pf] = 1
      }
  } else {
    var $$l = 0;
    for (var pug_index14 in $$obj) {
      $$l++;
      var pf = $$obj[pug_index14];
fileSet[pf] = 1
    }
  }
}).call(this);

}
if (p.programRoutines) {
// iterate p.programRoutines
;(function(){
  var $$obj = p.programRoutines;
  if ('number' == typeof $$obj.length) {
      for (var pug_index15 = 0, $$l = $$obj.length; pug_index15 < $$l; pug_index15++) {
        var fn = $$obj[pug_index15];
funcSet[fn.name] = 1
      }
  } else {
    var $$l = 0;
    for (var pug_index15 in $$obj) {
      $$l++;
      var fn = $$obj[pug_index15];
funcSet[fn.name] = 1
    }
  }
}).call(this);

}
    }
  }
}).call(this);

var files = Object.keys(fileSet);
var funcs = Object.keys(funcSet);
if (files.length > 0 || funcs.length > 0) {
pug_html = pug_html + "\u003Cp\u003E This vulnerability is associated with";
if (files.length > 0) {
pug_html = pug_html + " program files ";
var counter = 0
// iterate files
;(function(){
  var $$obj = files;
  if ('number' == typeof $$obj.length) {
      for (var pug_index16 = 0, $$l = $$obj.length; pug_index16 < $$l; pug_index16++) {
        var fn = $$obj[pug_index16];
counter ++
pug_html = pug_html + "\u003Ctt\u003E" + (pug_escape(null == (pug_interp = fn) ? "" : pug_interp)) + "\u003C\u002Ftt\u003E";
if (counter < files.length) {
pug_html = pug_html + ", ";
}
      }
  } else {
    var $$l = 0;
    for (var pug_index16 in $$obj) {
      $$l++;
      var fn = $$obj[pug_index16];
counter ++
pug_html = pug_html + "\u003Ctt\u003E" + (pug_escape(null == (pug_interp = fn) ? "" : pug_interp)) + "\u003C\u002Ftt\u003E";
if (counter < files.length) {
pug_html = pug_html + ", ";
}
    }
  }
}).call(this);

}
if (funcs.length > 0) {
if (files.length > 0) {
pug_html = pug_html + " and";
}
pug_html = pug_html + " program routines ";
var counter = 0
// iterate funcs
;(function(){
  var $$obj = funcs;
  if ('number' == typeof $$obj.length) {
      for (var pug_index17 = 0, $$l = $$obj.length; pug_index17 < $$l; pug_index17++) {
        var fn = $$obj[pug_index17];
counter ++
pug_html = pug_html + "\u003Ctt\u003E" + (pug_escape(null == (pug_interp = fn) ? "" : pug_interp)) + "\u003C\u002Ftt\u003E";
if (counter < funcs.length) {
pug_html = pug_html + ", ";
}
      }
  } else {
    var $$l = 0;
    for (var pug_index17 in $$obj) {
      $$l++;
      var fn = $$obj[pug_index17];
counter ++
pug_html = pug_html + "\u003Ctt\u003E" + (pug_escape(null == (pug_interp = fn) ? "" : pug_interp)) + "\u003C\u002Ftt\u003E";
if (counter < funcs.length) {
pug_html = pug_html + ", ";
}
    }
  }
}).call(this);

}
pug_html = pug_html + ".\u003C\u002Fp\u003E";
}
if (relevantList) {
pug_html = pug_html + "\u003Cp\u003EThis issue affects " + (pug_escape(null == (pug_interp = relevantList.join('; ')) ? "" : pug_interp)) + ".\u003C\u002Fp\u003E";
}
}
}
};
if (ctemplate != undefined) {
pug_mixins[ctemplate]();
}
    }.call(this, "Date" in locals_for_with ?
        locals_for_with.Date :
        typeof Date !== 'undefined' ? Date : undefined, "Math" in locals_for_with ?
        locals_for_with.Math :
        typeof Math !== 'undefined' ? Math : undefined, "Object" in locals_for_with ?
        locals_for_with.Object :
        typeof Object !== 'undefined' ? Object : undefined, "cl" in locals_for_with ?
        locals_for_with.cl :
        typeof cl !== 'undefined' ? cl : undefined, "con" in locals_for_with ?
        locals_for_with.con :
        typeof con !== 'undefined' ? con : undefined, "ctemplate" in locals_for_with ?
        locals_for_with.ctemplate :
        typeof ctemplate !== 'undefined' ? ctemplate : undefined, "cveIds" in locals_for_with ?
        locals_for_with.cveIds :
        typeof cveIds !== 'undefined' ? cveIds : undefined, "editable" in locals_for_with ?
        locals_for_with.editable :
        typeof editable !== 'undefined' ? editable : undefined, "err" in locals_for_with ?
        locals_for_with.err :
        typeof err !== 'undefined' ? err : undefined, "isNaN" in locals_for_with ?
        locals_for_with.isNaN :
        typeof isNaN !== 'undefined' ? isNaN : undefined, "message" in locals_for_with ?
        locals_for_with.message :
        typeof message !== 'undefined' ? message : undefined, "name" in locals_for_with ?
        locals_for_with.name :
        typeof name !== 'undefined' ? name : undefined, "obj" in locals_for_with ?
        locals_for_with.obj :
        typeof obj !== 'undefined' ? obj : undefined, "org" in locals_for_with ?
        locals_for_with.org :
        typeof org !== 'undefined' ? org : undefined, "portalType" in locals_for_with ?
        locals_for_with.portalType :
        typeof portalType !== 'undefined' ? portalType : undefined, "prevOrg" in locals_for_with ?
        locals_for_with.prevOrg :
        typeof prevOrg !== 'undefined' ? prevOrg : undefined, "prevPortal" in locals_for_with ?
        locals_for_with.prevPortal :
        typeof prevPortal !== 'undefined' ? prevPortal : undefined, "t" in locals_for_with ?
        locals_for_with.t :
        typeof t !== 'undefined' ? t : undefined, "userInfo" in locals_for_with ?
        locals_for_with.userInfo :
        typeof userInfo !== 'undefined' ? userInfo : undefined, "users" in locals_for_with ?
        locals_for_with.users :
        typeof users !== 'undefined' ? users : undefined));
    ;;return pug_html;}</script><dialog class="dlg bor rnd shd" id="cveErrorsModal"><div id="cveErrors"></div><center class="pad2"><input class="btn sfe" type="reset" onclick="document.getElementById('cveErrorsModal').close()" value="OK"></center></dialog><dialog class="dlg bor rnd shd" id="secretDialog"><header class="ban sec pad"><b class="lbl vgi-lock">IMPORTANT! New API Secret Key generated!</b> <a class="sbn right vgi-fail" onclick="this.closest('dialog').close()"></a></header><center class="gap"><form id="secretDialogForm" onsubmit="event.preventDefault();this.reset();this.closest('dialog').close();return false"><h3 class="vgi-alert" id="userMessage"></h3><p>Please securely store this API key.<br/> This key will not be shown again!</p><b class="lbl">API Secret Key</b><br/><input class="txt bor" type="password" size="39" name="pass" readonly="readonly"/><input id="showpass" name="showpass" type="checkbox" onclick="this.form.pass.type = (this.form.pass.type === 'password'? 'text' : 'password')"/><label class="vgi-eye lbl sbn" for="showpass"></label><center class="gap"><input class="btn sfe" type="reset" onclick="this.closest('dialog').close()" value="OK"/></center></form></center></dialog><dialog class="dlg bor rnd shd" id="userAddDialog"><header class="ban sec pad"><b class="lbl vgi-user">Add a new user</b> <a class="sbn right vgi-fail" onclick="this.closest('dialog').close()"></a></header><form class="gap" onsubmit="event.preventDefault();cveAddUser(this)"><input class="txt" type="hidden" name="u"/><input class="txt" name="new_username" pattern="[a-zA-Z0-9-_@.]{3,50}" required="required" placeholder="username/email" size="43" title="username - only alpha-numeric and . _ - @ are allowed (min 3 characters)"/><br/><input class="txt" name="first" pattern=".{1,64}" required="required" placeholder="First name" title="First Name"/><input class="txt" name="last" pattern=".{1,64}" required="required" placeholder="Last name" title="Last Name"/><div><br/><input id="cveUserAdminA" type="checkbox" name="admin"/><label class="vgi-king lbl" for="cveUserAdminA" title="Is this an admin?">Admin</label><input class="lbl" id="cveUserAdminAActive" type="checkbox" name="active" checked="checked"/><label class="lbl" for="cveUserAdminAActive" title="Is the account active?">Active</label></div><br/><input class="gap sfe btn vgi-magic" type="submit" value="Add user"/> <button class="gap btn vgi-reuse" onclick="cveUserKeyReset(this)">Reset API Key</button></form></dialog><dialog class="dlg bor rnd shd" id="userEditDialog"><header class="ban sec pad"><b class="lbl vgi-user">Update user details</b> <a class="sbn right vgi-fail" onclick="this.closest('dialog').close()"></a></header><form class="gap" id="userEditForm" onsubmit="event.preventDefault();cveUpdateUser(this)"><input class="txt" type="hidden" name="u"/><input class="txt" name="new_username" pattern="[a-zA-Z0-9-_@.]{3,50}" required="required" placeholder="username/email" size="43" title="username - only alpha-numeric and . _ - @ are allowed (min 3 characters)"/><br/><input class="txt" name="first" pattern=".{1,64}" required="required" placeholder="First name" title="First Name"/><input class="txt" name="last" pattern=".{1,64}" required="required" placeholder="Last name" title="Last Name"/><div><br/><input id="cveUserAdminU" type="checkbox" name="admin"/><label class="vgi-king lbl" for="cveUserAdminU" title="Is this an admin?">Admin</label><input class="lbl" id="cveUserAdminUActive" type="checkbox" name="active" checked="checked"/><label class="lbl" for="cveUserAdminUActive" title="Is the account active?">Active</label></div><br/><input class="gap sfe btn vgi-magic" type="submit" value="Update"/> <button class="gap btn vgi-reuse" onclick="cveUserKeyReset(this)">Reset API Key</button></form></dialog><div id="mainTabGroup"><span class="lbl">&nbsp;</span><input class="tab" name="tabs" type="radio" id="editorTab" value="1" checked><label class="lbl" id="editorLabel" for="editorTab"><span class="flx">Editor<details class="popup" id="errPop"><summary class="sml hid" id="errCount"></summary><div class="wht pop pad bor shd" id="errList"></div></details></span></label><div class="wht fil bor pad"><iframe name="x" style="display:none" src="about:blank"></iframe><form class="editor" target="x" action="" id="docEditor"></form></div><input class="tab" name="tabs" type="radio" id="sourceTab" value="2"><label class="lbl" for="sourceTab">Source</label><div class="wht fil bor pad"><div id="output" rows="40" cols="100%"><p></p></div></div><input class="tab" name="tabs" type="radio" id="advisoryTab" value="4"><label class="lbl" for="advisoryTab">Preview</label><div class="wht fil bor pad"><div style="float:right"><a class="vgi-download btn right" type="button" oncontextmenu="downloadHtml(document.getElementById(&quot;cvetitle&quot;).innerText, render, this);" onclick="downloadHtml(document.getElementById(&quot;cvetitle&quot;).innerText, render, this);" value="Download">Download</a><a class="vgi-mail btn right" type="button" oncontextmenu="draftEmail(event, this, &quot;render&quot;);" onclick="draftEmail(event, this,&quot;render&quot;);" value="Email">Email</a></div><div class="render" id="render"></div></div><input class="tab" name="tabs" type="radio" id="cvePortalTab" value="6"><label class="lbl" for="cvePortalTab">CVE Portal</label><div class="wht fil rnd bor" id="port"></div></div><script>var idpath = "cveMetadata.cveId";
var allowAjax = "false";
var schemaName = "cve";
var postUrl = "";
var csrfToken = "";

{{ super() }}


{% endblock %}
