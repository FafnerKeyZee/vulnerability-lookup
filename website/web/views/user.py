#!/usr/bin/env python3

from flask import Blueprint
from flask import render_template
from flask_login import current_user
from flask_login import login_required

from website.models import User
from website.web.forms import ProfileForm

user_bp = Blueprint("user_bp", __name__, url_prefix="/user")


@user_bp.route("/profile", methods=["GET"])
@login_required
def form():
    """Returns the form to edit the current user."""
    user = User.query.filter(User.id == current_user.id).first()
    form = ProfileForm(obj=user)
    form.populate_obj(current_user)
    action = "Edit user"
    head_titles = [action]
    head_titles.append(user.login)
    return render_template(
        "edit_user.html", action=action, head_titles=head_titles, form=form, user=user
    )
