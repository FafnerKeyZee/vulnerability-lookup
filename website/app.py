#!/usr/bin/env python3

from __future__ import annotations

import logging
import logging.config

from vulnerabilitylookup.default import get_config
from website.web import commands
from website.web.api.v1 import apiv1_blueprint

logging.config.dictConfig(get_config('logging'))


from website.web.bootstrap import application  # type: ignore[import-untyped]


# ##### Registering blueprints
with application.app_context():

    from website.web import views

    application.register_blueprint(views.home_bp)
    if True: # later it will be 'if NotReadOnlyInstance:' for example
        application.register_blueprint(views.admin_bp)
        application.register_blueprint(views.user_bp)

    # API v1
    application.register_blueprint(apiv1_blueprint)



# ##### Registering commands

application.cli.add_command(commands.db_init)
application.cli.add_command(commands.create_admin)
application.cli.add_command(commands.create_user)
