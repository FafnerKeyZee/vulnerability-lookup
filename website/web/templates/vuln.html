{% extends "main.html" %}
{% import 'vulnerability_templates.html' as vuln_templates %}

{% block title %}{{source}} - {{vulnerability_id}}{% endblock %}

{% block content %}

{% if source ==  'nvd' %}
{{vuln_templates.nvd_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
{% elif source ==  'cvelistv5' %}
{{vuln_templates.cvelistv5_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
{% elif source ==  'circl' %}
{{vuln_templates.circl_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
{% elif source ==  'github' %}
{{vuln_templates.github_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
{% elif source ==  'gsd' %}
{{vuln_templates.gsd_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
{% elif source ==  'pysec' %}
{{vuln_templates.pysec_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
{% elif source ==  'ossf_malicious_packages' %}
{{vuln_templates.ossf_malicious_packages_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
{% elif source ==  'csaf_certbund' %}
{{vuln_templates.csaf_certbund_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
{% elif source ==  'csaf_siemens' %}
{{vuln_templates.csaf_siemens_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
{% elif source ==  'csaf_redhat' %}
{{vuln_templates.csaf_redhat_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
{% elif source ==  'csaf_cisa' %}
{{vuln_templates.csaf_cisa_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
{% elif source ==  'csaf_cisco' %}
{{vuln_templates.csaf_cisco_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
{% elif source ==  'csaf_sick' %}
{{vuln_templates.csaf_sick_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
{% elif source ==  'csaf_ox' %}
{{vuln_templates.csaf_ox_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
{% elif source ==  'csaf_nozominetworks' %}
{{vuln_templates.csaf_nozominetworks_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
{% elif source ==  'variot' %}
{{vuln_templates.variot_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
{%elif source %}
Other source: {{source}}.
<pre>{{vulnerability_data|tojson(indent=2)}}</pre>
{% endif %}

{% if linked_vulns %}
  <h5>Vulnerabilites related to the one you searched</h5>
  {% for source, vulnerabilities in linked_vulns.items() %}
    {% for vuln_id, vulnerability_data in vulnerabilities %}
      {% if source ==  'nvd' %}
      {{vuln_templates.nvd_view(source=source, vulnerability_id=vuln_id, vulnerability_data=vulnerability_data)}}
      {% elif source ==  'cvelistv5' %}
      {{vuln_templates.cvelistv5_view(source=source, vulnerability_id=vuln_id, vulnerability_data=vulnerability_data)}}
      {% elif source ==  'circl' %}
      {{vuln_templates.circl_view(source=source, vulnerability_id=vuln_id, vulnerability_data=vulnerability_data)}}
      {% elif source ==  'github' %}
      {{vuln_templates.github_view(source=source, vulnerability_id=vuln_id, vulnerability_data=vulnerability_data)}}
      {% elif source ==  'gsd' %}
      {{vuln_templates.gsd_view(source=source, vulnerability_id=vuln_id, vulnerability_data=vulnerability_data)}}
      {% elif source ==  'ossf_malicious_packages' %}
      {{vuln_templates.ossf_malicious_packages_view(source=source, vulnerability_id=vuln_id, vulnerability_data=vulnerability_data)}}
      {% elif source ==  'csaf_certbund' %}
      {{vuln_templates.csaf_certbund_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
      {% elif source ==  'csaf_siemens' %}
      {{vuln_templates.csaf_siemens_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
      {% elif source ==  'csaf_redhat' %}
      {{vuln_templates.csaf_redhat_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
      {% elif source ==  'csaf_cisa' %}
      {{vuln_templates.csaf_cisa_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
      {% elif source ==  'csaf_cisco' %}
      {{vuln_templates.csaf_cisco_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
      {% elif source ==  'csaf_sick' %}
      {{vuln_templates.csaf_sick_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
      {% elif source ==  'csaf_ox' %}
      {{vuln_templates.csaf_ox_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
      {% elif source ==  'csaf_nozominetworks' %}
      {{vuln_templates.csaf_nozominetworks_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
      {% elif source ==  'variot' %}
      {{vuln_templates.variot_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
      {%elif source %}
      Other source: {{source}}.
      <pre>{{vulnerability_data|tojson(indent=2)}}</pre>
      {% endif %}
    {% endfor%}
  {% endfor%}
{% endif %}
<script>
  document.getElementById("deleteVulnerability").onclick = function(event) {
    if (!confirm('You are going to delete the vulnerability. Are you sure?')) {
        return;
    }
    fetch("{{ url_for('apiv1.default_vulnerability', vulnerability_id=vulnerability_id) }}", {
      method: "DELETE",
          headers: {
            'Content-Type': 'application/json',
          }
    })
    .then(response => {
      if (!response.ok) {
        console.log(response);
      } else {
        window.location="{{ url_for('home_bp.recent') }}";
      }
    })
    .catch((error) => {
      console.log(error);
      // alert(error);
    });
  };
</script>
{% endblock %}
