{% macro cisa_known_exploited_view(data) -%}
<div class="card">
  <div class="card-body">
    <h5 class="card-title">CISA Known exploited vulnerability</h5>
    <h6 class="card-subtitle mb-2 text-body-secondary">
      Data from the <a href="https://www.cisa.gov/known-exploited-vulnerabilities-catalog">Known Exploited Vulnerabilities Catalog</a>
    </h6>
    <p class="card-text">Date added: {{data['dateAdded']}}</p>
    <p class="card-text">Due date: {{data['dueDate']}}</p>
    <p class="card-text">Required action: {{data['requiredAction']}}</p>
    <p class="card-text">Used in ransomware: {{data['knownRansomwareCampaignUse']}}</p>
    {%if data['notes'] %}
    <p class="card-text">Notes: {{data['notes']}}</p>
    {%endif%}
  </div>
</div>
{%- endmacro %}

{% macro nvd_view(source, vulnerability_id, vulnerability_data) -%}
  <div class="card">
  <div class="card-body">
    <h5 class="card-title">{{vulnerability_id}}</h5>
    <h6 class="card-subtitle mb-2 text-body-secondary">
      Vulnerability from <a href="https://nvd.nist.gov/vuln">{{source}}</a>
    </h6>
    <p class="card-text">{{vulnerability_data['cve']['descriptions'][0]['value']}}</p>
    {%if 'cisa_known_exploited' in vulnerability_data['meta']%}
    {{ cisa_known_exploited_view(vulnerability_data['meta']['cisa_known_exploited']) }}
    {%endif%}
    <a href="https://nvd.nist.gov/vuln/detail/{{vulnerability_id}}" class="card-link">Show details on source website</a>
    <pre>{{vulnerability_data|tojson(indent=2)}}</pre>
  </div>
</div>
{%- endmacro %}

{% macro cvelistv5_view(source, vulnerability_id, vulnerability_data) -%}
  <div class="card">
  <div class="card-body">
    <h5 class="card-title">{{vulnerability_id}}</h5>
    <h6 class="card-subtitle mb-2 text-body-secondary">
      Vulnerability from <a href="https://github.com/CVEProject/cvelistV5">{{source}}</a>
    </h6>
    {% if vulnerability_data['containers']['cna']['title'] %}
      <p class="card-text">{{vulnerability_data['containers']['cna']['title']}}</p>
    {% else %}
    <p class="card-text">{{vulnerability_data['containers']['cna']['descriptions'][0]['value']}}</p>
    {%endif%}
    {%if 'cisa_known_exploited' in vulnerability_data['meta']%}
    {{ cisa_known_exploited_view(vulnerability_data['meta']['cisa_known_exploited']) }}
    {%endif%}
    <a href="https://nvd.nist.gov/vuln/detail/{{vulnerability_id}}" class="card-link">Show details on NVD website</a>
    <pre>{{vulnerability_data|tojson(indent=2)}}</pre>
  </div>
</div>
{%- endmacro %}

{% macro github_view(source, vulnerability_id, vulnerability_data) -%}
  <div class="card">
  <div class="card-body">
    <h5 class="card-title">{{vulnerability_id}}</h5>
    <h6 class="card-subtitle mb-2 text-body-secondary">
      Vulnerability from <a href="https://github.com/advisories">{{source}}</a>
    </h6>
    <p class="card-text">{{vulnerability_data['summary']}}</p>
    <p class="card-text">{{vulnerability_data['details']}}</p>
    <a href="https://github.com/advisories/{{vulnerability_id}}" class="card-link">Show details on source website</a>
    <pre>{{vulnerability_data|tojson(indent=2)}}</pre>
  </div>
</div>
{%- endmacro %}

{% macro gsd_view(source, vulnerability_id, vulnerability_data) -%}
  <div class="card">
  <div class="card-body">
    <h5 class="card-title">{{vulnerability_id}}</h5>
    <h6 class="card-subtitle mb-2 text-body-secondary">
      Vulnerability from <a href="https://gsd.id/">{{source}}</a>
    </h6>
    <pre>{{vulnerability_data|tojson(indent=2)}}</pre>
  </div>
</div>
{%- endmacro %}

{% macro pysec_view(source, vulnerability_id, vulnerability_data) -%}
  <div class="card">
  <div class="card-body">
    <h5 class="card-title">{{vulnerability_id}}</h5>
    <h6 class="card-subtitle mb-2 text-body-secondary">
      Vulnerability from <a href="https://github.com/pypa/advisory-database">{{source}}</a>
    </h6>
    <p class="card-text">{{vulnerability_data['details']}}</p>
    <a href="https://github.com/pypa/advisory-database/blob/main/vulns/accesscontrol/{{vulnerability_id}}.yaml" class="card-link">Show details on source website</a>
    <pre>{{vulnerability_data|tojson(indent=2)}}</pre>
  </div>
</div>
{%- endmacro %}
