{% extends "main.html" %}
{% import 'vulnerability_templates.html' as vuln_templates %}

{% block title %}Search a vulnerability{% endblock %}

{% block content %}

{% if not source %}
<div class="position-absolute top-50 start-50 translate-middle">
{%else%}
<div class="position-relative top-0 start-50 translate-middle-x">
{%endif%}
<form class="row g-3" role="form" method=post action="search" enctype=multipart/form-data>
  <div class="col-auto">
    <input type="text" class="form-control" id="freetext_search" placeholder="What are you looking for?" name="freetext_search">
  </div>
  <div class="col-auto">
    <button type="submit" class="btn btn-primary mb-3">Search</button>
  </div>
</form>
</div>

{% if source ==  'nvd' %}
{{vuln_templates.nvd_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
{% elif source ==  'gad' %}
{{vuln_templates.github_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
{% elif source ==  'gsd' %}
{{vuln_templates.gsd_view(source=source, vulnerability_id=vulnerability_id, vulnerability_data=vulnerability_data)}}
{%elif source %}
Other source: {{source}}.
<pre>{{vulnerability_data|tojson(indent=2)}}</pre>
{% endif %}

{% endblock %}
