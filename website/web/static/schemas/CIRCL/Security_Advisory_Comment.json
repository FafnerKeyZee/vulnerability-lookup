
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "http://127.0.0.1:5000/static/schemas/CIRCL/CVE_Record_Format.json",
    "type": "object",
    "title": "Security Advisory comment format.",
    "description": "This schema specifies the format of a comment related to a security advisory.",
    "required": [
      "uuid",
      "vulnerability-lookup-origin",
      "creation_timestamp",
      "timestamp",
      "title",
      "vulnerability"
    ],
    "properties": {
      "uuid": {
        "type": "string",
        "pattern": "[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}",
        "description": "UUIDv4 of the message",
        "readOnly": false
      },
      "vulnerability-lookup-origin": {
        "type": "string",
        "pattern": "[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}",
        "description": "UUIDv4 of the vulnerability lookup instance",
        "default": "1a89b78e-f703-45f3-bb86-59eb712668bd",
        "readOnly": true
      },
      "creation_timestamp": {
        "type": "string",
        "format": "date-time",
        "description": "When the message was created originally"
      },
      "timestamp": {
        "type": "string",
        "format": "date-time",
        "description": "When the message was last updated"
      },
      "title": {
        "type": "string",
        "description": "Title of the message",
        "maxLength": 65535
      },
      "description": {
        "type": "string",
        "description": "Description of the message"
      },
      "description-format": {
        "type": "string",
        "enum": ["markdown", "text"],
        "description": "Format of the description"
      },
      "vulnerability": {
        "type": "array",
        "items": {
          "type": "string",
          "pattern": "[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}",
          "description": "Vulnerability reference"
        },
        "description": "One or more vulnerability references for this message"
      },
      "meta": {
        "type": "array",
        "items": {
          "type": "object",
          "description": "Meta fields"
        },
        "description": "Zero or more meta-fields"
      }
    }
  }
